import y from"process";var b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var A={};var C=y;(function(){}).call(A),function(){null==window.Set&&(window.Set=function(){function t(){this.clear()}return t.prototype.clear=function(){return(this||b).values=[]},t.prototype.has=function(y){return-1!==(this||b).values.indexOf(y)},t.prototype.add=function(y){return this.has(y)||(this||b).values.push(y),this||b},t.prototype.delete=function(y){var A;return-1!==(A=(this||b).values.indexOf(y))&&((this||b).values.splice(A,1),!0)},t.prototype.forEach=function(){var y;return(y=(this||b).values).forEach.apply(y,arguments)},t}())}.call(A),function(y){function e(){}function n(y,b){return function(){y.apply(b,arguments)}}function i(y){if("object"!=typeof(this||b))throw new TypeError("Promises must be constructed via new");if("function"!=typeof y)throw new TypeError("not a function");(this||b)._state=0,(this||b)._handled=!1,(this||b)._value=void 0,(this||b)._deferreds=[],c(y,this||b)}function o(y,b){for(;3===y._state;)y=y._value;return 0===y._state?void y._deferreds.push(b):(y._handled=!0,void w((function(){var A=1===y._state?b.onFulfilled:b.onRejected;if(null!==A){var C;try{C=A(y._value)}catch(y){return void s(b.promise,y)}r(b.promise,C)}else(1===y._state?r:s)(b.promise,y._value)})))}function r(y,b){try{if(b===y)throw new TypeError("A promise cannot be resolved with itself.");if(b&&("object"==typeof b||"function"==typeof b)){var A=b.then;if(b instanceof i)return y._state=3,y._value=b,void a(y);if("function"==typeof A)return void c(n(A,b),y)}y._state=1,y._value=b,a(y)}catch(b){s(y,b)}}function s(y,b){y._state=2,y._value=b,a(y)}function a(y){2===y._state&&0===y._deferreds.length&&setTimeout((function(){y._handled||p(y._value)}),1);for(var b=0,A=y._deferreds.length;A>b;b++)o(y,y._deferreds[b]);y._deferreds=null}function u(y,A,C){(this||b).onFulfilled="function"==typeof y?y:null,(this||b).onRejected="function"==typeof A?A:null,(this||b).promise=C}function c(y,b){var A=!1;try{y((function(y){A||(A=!0,r(b,y))}),(function(y){A||(A=!0,s(b,y))}))}catch(y){if(A)return;A=!0,s(b,y)}}var x=setTimeout,w="function"==typeof C.nextTick&&C.nextTick||function(y){x(y,1)},p=function(y){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",y)};i.prototype.catch=function(y){return this.then(null,y)},i.prototype.then=function(y,A){var C=new i(e);return o(this||b,new u(y,A,C)),C},i.all=function(y){var b=Array.prototype.slice.call(y);return new i((function(y,A){function i(x,w){try{if(w&&("object"==typeof w||"function"==typeof w)){var E=w.then;if("function"==typeof E)return void E.call(w,(function(y){i(x,y)}),A)}b[x]=w,0===--C&&y(b)}catch(y){A(y)}}if(0===b.length)return y([]);for(var C=b.length,x=0;x<b.length;x++)i(x,b[x])}))},i.resolve=function(y){return y&&"object"==typeof y&&y.constructor===i?y:new i((function(b){b(y)}))},i.reject=function(y){return new i((function(b,A){A(y)}))},i.race=function(y){return new i((function(b,A){for(var C=0,x=y.length;x>C;C++)y[C].then(b,A)}))},i._setImmediateFn=function(y){w=y},i._setUnhandledRejectionFn=function(y){p=y},A?A=i:y.Promise||(y.Promise=i)}(A),function(){var y="object"==typeof window.customElements,A="function"==typeof document.registerElement,C=y||A;C||(
/**
  * @license
  * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
  * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
  * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
  * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
  * Code distributed by Google as part of the polymer project is also
  * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
  */
"undefined"==typeof WeakMap&&!function(){var y=Object.defineProperty,A=Date.now()%1e9,n=function(){(this||b).name="__st"+(1e9*Math.random()>>>0)+A+++"__"};n.prototype={set:function(A,C){var x=A[(this||b).name];return x&&x[0]===A?x[1]=C:y(A,(this||b).name,{value:[A,C],writable:!0}),this||b},get:function(y){var A;return(A=y[(this||b).name])&&A[0]===y?A[1]:void 0},delete:function(y){var A=y[(this||b).name];return!(!A||A[0]!==y)&&(A[0]=A[1]=void 0,!0)},has:function(y){var A=y[(this||b).name];return!!A&&A[0]===y}},window.WeakMap=n}(),function(y){function e(y){S.push(y),E||(E=!0,A(i))}function n(y){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(y)||y}function i(){E=!1;var y=S;S=[],y.sort((function(y,b){return y.uid_-b.uid_}));var b=!1;y.forEach((function(y){var A=y.takeRecords();o(y),A.length&&(y.callback_(A,y),b=!0)})),b&&i()}function o(y){y.nodes_.forEach((function(b){var A=C.get(b);A&&A.forEach((function(b){b.observer===y&&b.removeTransientObservers()}))}))}function r(y,b){for(var A=y;A;A=A.parentNode){var x=C.get(A);if(x)for(var w=0;w<x.length;w++){var E=x[w],S=E.options;if(A===y||S.subtree){var R=b(S);R&&E.enqueue(R)}}}}function s(y){(this||b).callback_=y,(this||b).nodes_=[],(this||b).records_=[],(this||b).uid_=++R}function a(y,A){(this||b).type=y,(this||b).target=A,(this||b).addedNodes=[],(this||b).removedNodes=[],(this||b).previousSibling=null,(this||b).nextSibling=null,(this||b).attributeName=null,(this||b).attributeNamespace=null,(this||b).oldValue=null}function u(y){var b=new a(y.type,y.target);return b.addedNodes=y.addedNodes.slice(),b.removedNodes=y.removedNodes.slice(),b.previousSibling=y.previousSibling,b.nextSibling=y.nextSibling,b.attributeName=y.attributeName,b.attributeNamespace=y.attributeNamespace,b.oldValue=y.oldValue,b}function c(y,b){return k=new a(y,b)}function l(y){return D||(D=u(k),D.oldValue=y,D)}function h(){k=D=void 0}function p(y){return y===D||y===k}function d(y,b){return y===b?y:D&&p(y)?D:null}function f(y,A,C){(this||b).observer=y,(this||b).target=A,(this||b).options=C,(this||b).transientObservedNodes=[]}if(!y.JsMutationObserver){var A,C=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))A=setTimeout;else if(window.setImmediate)A=window.setImmediate;else{var x=[],w=String(Math.random());window.addEventListener("message",(function(y){if(y.data===w){var b=x;x=[],b.forEach((function(y){y()}))}})),A=function(y){x.push(y),window.postMessage(w,"*")}}var E=!1,S=[],R=0;s.prototype={observe:function(y,A){if(y=n(y),!A.childList&&!A.attributes&&!A.characterData||A.attributeOldValue&&!A.attributes||A.attributeFilter&&A.attributeFilter.length&&!A.attributes||A.characterDataOldValue&&!A.characterData)throw new SyntaxError;var x=C.get(y);x||C.set(y,x=[]);for(var w,E=0;E<x.length;E++)if(x[E].observer===(this||b)){w=x[E],w.removeListeners(),w.options=A;break}w||(w=new f(this||b,y,A),x.push(w),(this||b).nodes_.push(y)),w.addListeners()},disconnect:function(){(this||b).nodes_.forEach((function(y){for(var A=C.get(y),x=0;x<A.length;x++){var w=A[x];if(w.observer===(this||b)){w.removeListeners(),A.splice(x,1);break}}}),this||b),(this||b).records_=[]},takeRecords:function(){var y=(this||b).records_;return(this||b).records_=[],y}};var k,D;f.prototype={enqueue:function(y){var A=(this||b).observer.records_,C=A.length;if(A.length>0){var x=A[C-1],w=d(x,y);if(w)return void(A[C-1]=w)}else e((this||b).observer);A[C]=y},addListeners:function(){this.addListeners_((this||b).target)},addListeners_:function(y){var A=(this||b).options;A.attributes&&y.addEventListener("DOMAttrModified",this||b,!0),A.characterData&&y.addEventListener("DOMCharacterDataModified",this||b,!0),A.childList&&y.addEventListener("DOMNodeInserted",this||b,!0),(A.childList||A.subtree)&&y.addEventListener("DOMNodeRemoved",this||b,!0)},removeListeners:function(){this.removeListeners_((this||b).target)},removeListeners_:function(y){var A=(this||b).options;A.attributes&&y.removeEventListener("DOMAttrModified",this||b,!0),A.characterData&&y.removeEventListener("DOMCharacterDataModified",this||b,!0),A.childList&&y.removeEventListener("DOMNodeInserted",this||b,!0),(A.childList||A.subtree)&&y.removeEventListener("DOMNodeRemoved",this||b,!0)},addTransientObserver:function(y){if(y!==(this||b).target){this.addListeners_(y),(this||b).transientObservedNodes.push(y);var A=C.get(y);A||C.set(y,A=[]),A.push(this||b)}},removeTransientObservers:function(){var y=(this||b).transientObservedNodes;(this||b).transientObservedNodes=[],y.forEach((function(y){this.removeListeners_(y);for(var A=C.get(y),x=0;x<A.length;x++)if(A[x]===(this||b)){A.splice(x,1);break}}),this||b)},handleEvent:function(y){switch(y.stopImmediatePropagation(),y.type){case"DOMAttrModified":var b=y.attrName,A=y.relatedNode.namespaceURI,C=y.target,x=new c("attributes",C);x.attributeName=b,x.attributeNamespace=A;var w=y.attrChange===MutationEvent.ADDITION?null:y.prevValue;r(C,(function(y){return!y.attributes||y.attributeFilter&&y.attributeFilter.length&&-1===y.attributeFilter.indexOf(b)&&-1===y.attributeFilter.indexOf(A)?void 0:y.attributeOldValue?l(w):x}));break;case"DOMCharacterDataModified":C=y.target,x=c("characterData",C),w=y.prevValue;r(C,(function(y){return y.characterData?y.characterDataOldValue?l(w):x:void 0}));break;case"DOMNodeRemoved":this.addTransientObserver(y.target);case"DOMNodeInserted":var E,S,R=y.target;"DOMNodeInserted"===y.type?(E=[R],S=[]):(E=[],S=[R]);var k=R.previousSibling,D=R.nextSibling;x=c("childList",y.target.parentNode);x.addedNodes=E,x.removedNodes=S,x.previousSibling=k,x.nextSibling=D,r(y.relatedNode,(function(y){return y.childList?x:void 0}))}h()}},y.JsMutationObserver=s,y.MutationObserver||(y.MutationObserver=s,s._isPolyfilled=!0)}}(self),function(){if(!window.performance||!window.performance.now){var y=Date.now();window.performance={now:function(){return Date.now()-y}}}window.requestAnimationFrame||(window.requestAnimationFrame=function(){var y=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return y?function(b){return y((function(){b(performance.now())}))}:function(y){return window.setTimeout(y,1e3/60)}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(){return window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(y){clearTimeout(y)}}());var A=function(){var y=document.createEvent("Event");return y.initEvent("foo",!0,!0),y.preventDefault(),y.defaultPrevented}();if(!A){var C=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){(this||b).cancelable&&(C.call(this||b),Object.defineProperty(this||b,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var x=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||x&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(y,b){b=b||{};var A=document.createEvent("CustomEvent");return A.initCustomEvent(y,Boolean(b.bubbles),Boolean(b.cancelable),b.detail),A},window.CustomEvent.prototype=window.Event.prototype),!window.Event||x&&"function"!=typeof window.Event){var w=window.Event;window.Event=function(y,b){b=b||{};var A=document.createEvent("Event");return A.initEvent(y,Boolean(b.bubbles),Boolean(b.cancelable)),A},window.Event.prototype=w.prototype}}(window.WebComponents),window.CustomElements=window.CustomElements||{flags:{}},function(y){var b=y.flags,A=[],i=function(y){A.push(y)},o=function(){A.forEach((function(b){b(y)}))};y.addModule=i,y.initializeModules=o,y.hasNative=Boolean(document.registerElement),y.isIE=/Trident/.test(navigator.userAgent),y.useNative=!b.register&&y.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative)}(window.CustomElements),window.CustomElements.addModule((function(y){function e(y,b){n(y,(function(y){return!!b(y)||void i(y,b)})),i(y,b)}function n(y,b,A){var C=y.firstElementChild;if(!C)for(C=y.firstChild;C&&C.nodeType!==Node.ELEMENT_NODE;)C=C.nextSibling;for(;C;)!0!==b(C,A)&&n(C,b,A),C=C.nextElementSibling;return null}function i(y,b){for(var A=y.shadowRoot;A;)e(A,b),A=A.olderShadowRoot}function o(y,b){r(y,b,[])}function r(y,A,C){if(y=window.wrap(y),!(C.indexOf(y)>=0)){C.push(y);for(var x,w=y.querySelectorAll("link[rel="+b+"]"),E=0,S=w.length;S>E&&(x=w[E]);E++)x.import&&r(x.import,A,C);A(y)}}var b=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:"none";y.forDocumentTree=o,y.forSubtree=e})),window.CustomElements.addModule((function(y){function e(y,b){return n(y,b)||i(y,b)}function n(b,A){return!!y.upgrade(b,A)||void(A&&s(b))}function i(y,b){C(y,(function(y){return!!n(y,b)||void 0}))}function o(y){S.push(y),E||(E=!0,setTimeout(r))}function r(){E=!1;for(var y,b=S,A=0,C=b.length;C>A&&(y=b[A]);A++)y();S=[]}function s(y){w?o((function(){a(y)})):a(y)}function a(y){y.__upgraded__&&!y.__attached&&(y.__attached=!0,y.attachedCallback&&y.attachedCallback())}function u(y){c(y),C(y,(function(y){c(y)}))}function c(y){w?o((function(){l(y)})):l(y)}function l(y){y.__upgraded__&&y.__attached&&(y.__attached=!1,y.detachedCallback&&y.detachedCallback())}function h(y){for(var b=y,A=window.wrap(document);b;){if(b==A)return!0;b=b.parentNode||b.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&b.host}}function p(y){if(y.shadowRoot&&!y.shadowRoot.__watched){A.dom&&console.log("watching shadow-root for: ",y.localName);for(var b=y.shadowRoot;b;)g(b),b=b.olderShadowRoot}}function d(y,b){if(A.dom){var C=b[0];if(C&&"childList"===C.type&&C.addedNodes&&C.addedNodes){for(var x=C.addedNodes[0];x&&x!==document&&!x.host;)x=x.parentNode;var w=x&&(x.URL||x._URL||x.host&&x.host.localName)||"";w=w.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",b.length,w||"")}var E=h(y);b.forEach((function(y){"childList"===y.type&&(R(y.addedNodes,(function(y){y.localName&&e(y,E)})),R(y.removedNodes,(function(y){y.localName&&u(y)})))})),A.dom&&console.groupEnd()}function f(y){for(y=window.wrap(y),y||(y=window.wrap(document));y.parentNode;)y=y.parentNode;var b=y.__observer;b&&(d(y,b.takeRecords()),r())}function g(y){if(!y.__observer){var A=new MutationObserver(d.bind(this||b,y));A.observe(y,{childList:!0,subtree:!0}),y.__observer=A}}function m(y){y=window.wrap(y),A.dom&&console.group("upgradeDocument: ",y.baseURI.split("/").pop());var b=y===window.wrap(document);e(y,b),g(y),A.dom&&console.groupEnd()}function v(y){x(y,m)}var A=y.flags,C=y.forSubtree,x=y.forDocumentTree,w=window.MutationObserver._isPolyfilled&&A["throttle-attached"];y.hasPolyfillMutations=w,y.hasThrottledAttached=w;var E=!1,S=[],R=Array.prototype.forEach.call.bind(Array.prototype.forEach),k=Element.prototype.createShadowRoot;k&&(Element.prototype.createShadowRoot=function(){var y=k.call(this||b);return window.CustomElements.watchShadow(this||b),y}),y.watchShadow=p,y.upgradeDocumentTree=v,y.upgradeDocument=m,y.upgradeSubtree=i,y.upgradeAll=e,y.attached=s,y.takeRecords=f})),window.CustomElements.addModule((function(y){function e(b,A){if("template"===b.localName&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(b),!b.__upgraded__&&b.nodeType===Node.ELEMENT_NODE){var C=b.getAttribute("is"),x=y.getRegisteredDefinition(b.localName)||y.getRegisteredDefinition(C);if(x&&(C&&x.tag==b.localName||!C&&!x.extends))return n(b,x,A)}}function n(A,C,x){return b.upgrade&&console.group("upgrade:",A.localName),C.is&&A.setAttribute("is",C.is),i(A,C),A.__upgraded__=!0,r(A),x&&y.attached(A),y.upgradeSubtree(A,x),b.upgrade&&console.groupEnd(),A}function i(y,b){Object.__proto__||o(y,b.prototype,b.native),y.__proto__=b.prototype}function o(y,b,A){for(var C={},x=b;x!==A&&x!==HTMLElement.prototype;){for(var w,E=Object.getOwnPropertyNames(x),S=0;w=E[S];S++)C[w]||(Object.defineProperty(y,w,Object.getOwnPropertyDescriptor(x,w)),C[w]=1);x=Object.getPrototypeOf(x)}}function r(y){y.createdCallback&&y.createdCallback()}var b=y.flags;y.upgrade=e,y.upgradeWithDefinition=n,y.implementPrototype=i})),window.CustomElements.addModule((function(y){function e(b,A){var x=A||{};if(!b)throw new Error("document.registerElement: first argument `name` must not be empty");if(b.indexOf("-")<0)throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+String(b)+"'.");if(o(b))throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+String(b)+"'. The type name is invalid.");if(c(b))throw new Error("DuplicateDefinitionError: a type with name '"+String(b)+"' is already registered");return x.prototype||(x.prototype=Object.create(HTMLElement.prototype)),x.__name=b.toLowerCase(),x.extends&&(x.extends=x.extends.toLowerCase()),x.lifecycle=x.lifecycle||{},x.ancestry=r(x.extends),s(x),a(x),n(x.prototype),l(x.__name,x),x.ctor=h(x),x.ctor.prototype=x.prototype,x.prototype.constructor=x.ctor,y.ready&&C(document),x.ctor}function n(y){if(!y.setAttribute._polyfilled){var A=y.setAttribute;y.setAttribute=function(y,C){i.call(this||b,y,C,A)};var C=y.removeAttribute;y.removeAttribute=function(y){i.call(this||b,y,null,C)},y.setAttribute._polyfilled=!0}}function i(y,A,C){y=y.toLowerCase();var x=this.getAttribute(y);C.apply(this||b,arguments);var w=this.getAttribute(y);(this||b).attributeChangedCallback&&w!==x&&this.attributeChangedCallback(y,x,w)}function o(y){for(var b=0;b<R.length;b++)if(y===R[b])return!0}function r(y){var b=c(y);return b?r(b.extends).concat([b]):[]}function s(y){for(var b,A=y.extends,C=0;b=y.ancestry[C];C++)A=b.is&&b.tag;y.tag=A||y.__name,A&&(y.is=y.__name)}function a(y){if(!Object.__proto__){var b=HTMLElement.prototype;if(y.is){var A=document.createElement(y.tag);b=Object.getPrototypeOf(A)}for(var C,x=y.prototype,w=!1;x;)x==b&&(w=!0),C=Object.getPrototypeOf(x),C&&(x.__proto__=C),x=C;w||console.warn(y.tag+" prototype not found in prototype chain for "+y.is),y.native=b}}function u(y){return w(L(y.tag),y)}function c(y){return y?k[y.toLowerCase()]:void 0}function l(y,b){k[y]=b}function h(y){return function(){return u(y)}}function p(y,b,A){return y===D?d(b,A):T(y,b)}function d(y,b){y&&(y=y.toLowerCase()),b&&(b=b.toLowerCase());var A=c(b||y);if(A){if(y==A.tag&&b==A.is)return new A.ctor;if(!b&&!A.is)return new A.ctor}var C;return b?(C=d(y),C.setAttribute("is",b),C):(C=L(y),y.indexOf("-")>=0&&E(C,HTMLElement),C)}function f(y,A){var C=y[A];y[A]=function(){var y=C.apply(this||b,arguments);return x(y),y}}var A,C=(y.isIE,y.upgradeDocumentTree),x=y.upgradeAll,w=y.upgradeWithDefinition,E=y.implementPrototype,S=y.useNative,R=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],k={},D="http://www.w3.org/1999/xhtml",L=document.createElement.bind(document),T=document.createElementNS.bind(document);A=Object.__proto__||S?function(y,b){return y instanceof b}:function(y,b){if(y instanceof b)return!0;for(var A=y;A;){if(A===b.prototype)return!0;A=A.__proto__}return!1},f(Node.prototype,"cloneNode"),f(document,"importNode"),document.registerElement=e,document.createElement=d,document.createElementNS=p,y.registry=k,y.instanceof=A,y.reservedTagList=R,y.getRegisteredDefinition=c,document.register=document.registerElement})),function(y){function e(){C(window.wrap(document)),window.CustomElements.ready=!0;var y=window.requestAnimationFrame||function(y){setTimeout(y,16)};y((function(){setTimeout((function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))}))}))}var b=y.useNative,A=y.initializeModules;if(y.isIE,b){var o=function(){};y.watchShadow=o,y.upgrade=o,y.upgradeAll=o,y.upgradeDocumentTree=o,y.upgradeSubtree=o,y.takeRecords=o,y.instanceof=function(y,b){return y instanceof b}}else A();var C=y.upgradeDocumentTree,x=y.upgradeDocument;if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(y){return y}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(y){y.import&&x(wrap(y.import))}),"complete"===document.readyState||y.flags.eager)e();else if("interactive"!==document.readyState||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var w=window.HTMLImports&&!window.HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(w,e)}else e()}(window.CustomElements))}.call(A),function(){}.call(A),function(){var y=this||b;(function(){(function(){(this||b).Trix={VERSION:"1.3.1",ZERO_WIDTH_SPACE:"\ufeff",NON_BREAKING_SPACE:" ",OBJECT_REPLACEMENT_CHARACTER:"￼",browser:{composesExistingText:/Android.*Chrome/.test(navigator.userAgent),forcesObjectResizing:/Trident.*rv:11/.test(navigator.userAgent),supportsInputEvents:function(){var y,b,A,C;if("undefined"==typeof InputEvent)return!1;for(C=["data","getTargetRanges","inputType"],y=0,b=C.length;b>y;y++)if(A=C[y],!(A in InputEvent.prototype))return!1;return!0}()},config:{}}}).call(this||b)}).call(y);var C=y.Trix;(function(){(function(){C.BasicObject=function(){function t(){}var y,A,C;return t.proxyMethod=function(C){var x,w,E,S,R;return E=A(C),x=E.name,S=E.toMethod,R=E.toProperty,w=E.optional,(this||b).prototype[x]=function(){var A,C;return A=null!=S?w?"function"==typeof(this||b)[S]?this[S]():void 0:this[S]():null!=R?(this||b)[R]:void 0,w?(C=null!=A?A[x]:void 0,null!=C?y.call(C,A,arguments):void 0):(C=A[x],y.call(C,A,arguments))}},A=function(y){var b,A;if(!(A=y.match(C)))throw new Error("can't parse @proxyMethod expression: "+y);return b={name:A[4]},null!=A[2]?b.toMethod=A[1]:b.toProperty=A[1],null!=A[3]&&(b.optional=!0),b},y=Function.prototype.apply,C=/^(.+?)(\(\))?(\?)?\.(.+?)$/,t}()}).call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.Object=function(y){function i(){(this||b).id=++A}var A;return t(i,y),A=0,i.fromJSONString=function(y){return this.fromJSON(JSON.parse(y))},i.prototype.hasSameConstructorAs=function(y){return(this||b).constructor===(null!=y?y.constructor:void 0)},i.prototype.isEqualTo=function(y){return(this||b)===y},i.prototype.inspect=function(){var y,A,C;return y=function(){var y,b,x;b=null!=(y=this.contentsForInspection())?y:{},x=[];for(A in b)C=b[A],x.push(A+"="+C);return x}.call(this||b),"#<"+(this||b).constructor.name+":"+(this||b).id+(y.length?" "+y.join(", "):"")+">"},i.prototype.contentsForInspection=function(){},i.prototype.toJSONString=function(){return JSON.stringify(this||b)},i.prototype.toUTF16String=function(){return C.UTF16String.box(this||b)},i.prototype.getCacheKey=function(){return(this||b).id.toString()},i}(C.BasicObject)}.call(this||b),function(){C.extend=function(y){var A,C;for(A in y)C=y[A],(this||b)[A]=C;return this||b}}.call(this||b),function(){C.extend({defer:function(y){return setTimeout(y,1)}})}.call(this||b),function(){var y,b;C.extend({normalizeSpaces:function(y){return y.replace(RegExp(""+C.ZERO_WIDTH_SPACE,"g"),"").replace(RegExp(""+C.NON_BREAKING_SPACE,"g")," ")},normalizeNewlines:function(y){return y.replace(/\r\n/g,"\n")},breakableWhitespacePattern:RegExp("[^\\S"+C.NON_BREAKING_SPACE+"]"),squishBreakableWhitespace:function(y){return y.replace(RegExp(""+C.breakableWhitespacePattern.source,"g")," ").replace(/\ {2,}/g," ")},summarizeStringChange:function(y,A){var x,w,E,S;return y=C.UTF16String.box(y),A=C.UTF16String.box(A),A.length<y.length?(w=b(y,A),S=w[0],x=w[1]):(E=b(A,y),x=E[0],S=E[1]),{added:x,removed:S}}}),b=function(b,A){var x,w,E,S,R;return b.isEqualTo(A)?["",""]:(w=y(b,A),S=w.utf16String.length,E=S?(R=w.offset,w,x=b.codepoints.slice(0,R).concat(b.codepoints.slice(R+S)),y(A,C.UTF16String.fromCodepoints(x))):y(A,b),[w.utf16String.toString(),E.utf16String.toString()])},y=function(y,b){var A,C,x;for(A=0,C=y.length,x=b.length;C>A&&y.charAt(A).isEqualTo(b.charAt(A));)A++;for(;C>A+1&&y.charAt(C-1).isEqualTo(b.charAt(x-1));)C--,x--;return{utf16String:y.slice(A,C),offset:A}}}.call(this||b),function(){C.extend({copyObject:function(y){var b,A,C;null==y&&(y={}),A={};for(b in y)C=y[b],A[b]=C;return A},objectsAreEqual:function(y,b){var A,C;if(null==y&&(y={}),null==b&&(b={}),Object.keys(y).length!==Object.keys(b).length)return!1;for(A in y)if(C=y[A],C!==b[A])return!1;return!0}})}.call(this||b),function(){var y=[].slice;C.extend({arraysAreEqual:function(y,b){var A,C,x,w;if(null==y&&(y=[]),null==b&&(b=[]),y.length!==b.length)return!1;for(C=A=0,x=y.length;x>A;C=++A)if(w=y[C],w!==b[C])return!1;return!0},arrayStartsWith:function(y,b){return null==y&&(y=[]),null==b&&(b=[]),C.arraysAreEqual(y.slice(0,b.length),b)},spliceArray:function(){var b,A,C;return A=arguments[0],b=2<=arguments.length?y.call(arguments,1):[],C=A.slice(0),C.splice.apply(C,b),C},summarizeArrayChange:function(y,b){var A,C,x,w,E,S,R,k,D,L,T;for(null==y&&(y=[]),null==b&&(b=[]),A=[],L=[],x=new Set,w=0,R=y.length;R>w;w++)T=y[w],x.add(T);for(C=new Set,E=0,k=b.length;k>E;E++)T=b[E],C.add(T),x.has(T)||A.push(T);for(S=0,D=y.length;D>S;S++)T=y[S],C.has(T)||L.push(T);return{added:A,removed:L}}})}.call(this||b),function(){var y,b,A,x;y=null,b=null,x=null,A=null,C.extend({getAllAttributeNames:function(){return null!=y?y:y=C.getTextAttributeNames().concat(C.getBlockAttributeNames())},getBlockConfig:function(y){return C.config.blockAttributes[y]},getBlockAttributeNames:function(){return null!=b?b:b=Object.keys(C.config.blockAttributes)},getTextConfig:function(y){return C.config.textAttributes[y]},getTextAttributeNames:function(){return null!=x?x:x=Object.keys(C.config.textAttributes)},getListAttributeNames:function(){var y,b;return null!=A?A:A=function(){var A,x;A=C.config.blockAttributes,x=[];for(y in A)b=A[y].listAttribute,null!=b&&x.push(b);return x}()}})}.call(this||b),function(){var y,A,x,w,E,S=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};y=document.documentElement,A=null!=(x=null!=(w=null!=(E=y.matchesSelector)?E:y.webkitMatchesSelector)?w:y.msMatchesSelector)?x:y.mozMatchesSelector,C.extend({handleEvent:function(b,A){var x,w,E,S,R,k,D,L,T,O,N;return D=null!=A?A:{},R=D.onElement,S=D.matchingSelector,N=D.withCallback,E=D.inPhase,k=D.preventDefault,T=D.times,x=null!=R?R:y,L=S,N,O="capturing"===E,w=function(y){var b;return null!=T&&0===--T&&w.destroy(),b=C.findClosestElementFromNode(y.target,{matchingSelector:L}),null!=b&&(null!=N&&N.call(b,y,b),k)?y.preventDefault():void 0},w.destroy=function(){return x.removeEventListener(b,w,O)},x.addEventListener(b,w,O),w},handleEventOnce:function(y,b){return null==b&&(b={}),b.times=1,C.handleEvent(y,b)},triggerEvent:function(b,A){var x,w,E,S,R,k,D;return D=null!=A?A:{},k=D.onElement,w=D.bubbles,E=D.cancelable,x=D.attributes,S=null!=k?k:y,w=!1!==w,E=!1!==E,R=document.createEvent("Events"),R.initEvent(b,w,E),null!=x&&C.extend.call(R,x),S.dispatchEvent(R)},elementMatchesSelector:function(y,b){return 1===(null!=y?y.nodeType:void 0)?A.call(y,b):void 0},findClosestElementFromNode:function(y,b){var A,x,w;for(x=null!=b?b:{},A=x.matchingSelector,w=x.untilNode;null!=y&&y.nodeType!==Node.ELEMENT_NODE;)y=y.parentNode;if(null!=y){if(null==A)return y;if(y.closest&&null==w)return y.closest(A);for(;y&&y!==w;){if(C.elementMatchesSelector(y,A))return y;y=y.parentNode}}},findInnerElement:function(y){for(;null!=y?y.firstElementChild:void 0;)y=y.firstElementChild;return y},innerElementIsActive:function(y){return document.activeElement!==y&&C.elementContainsNode(y,document.activeElement)},elementContainsNode:function(y,b){if(y&&b)for(;b;){if(b===y)return!0;b=b.parentNode}},findNodeFromContainerAndOffset:function(y,b){var A;if(y)return y.nodeType===Node.TEXT_NODE?y:0===b?null!=(A=y.firstChild)?A:y:y.childNodes.item(b-1)},findElementFromContainerAndOffset:function(y,b){var A;return A=C.findNodeFromContainerAndOffset(y,b),C.findClosestElementFromNode(A)},findChildIndexOfNode:function(y){var b;if(null!=y?y.parentNode:void 0){for(b=0;y=y.previousSibling;)b++;return b}},removeNode:function(y){var b;return null!=y&&null!=(b=y.parentNode)?b.removeChild(y):void 0},walkTree:function(y,b){var A,C,x,w,E;return x=null!=b?b:{},C=x.onlyNodesOfType,w=x.usingFilter,A=x.expandEntityReferences,E=function(){switch(C){case"element":return NodeFilter.SHOW_ELEMENT;case"text":return NodeFilter.SHOW_TEXT;case"comment":return NodeFilter.SHOW_COMMENT;default:return NodeFilter.SHOW_ALL}}(),document.createTreeWalker(y,E,null!=w?w:null,!0===A)},tagName:function(y){var b;return null!=y&&null!=(b=y.tagName)?b.toLowerCase():void 0},makeElement:function(y,b){var A,C,x,w,E,S,R,k,D,L,T,O,N,P;if(null==b&&(b={}),"object"==typeof y?(b=y,y=b.tagName):b={attributes:b},x=document.createElement(y),null!=b.editable&&(null==b.attributes&&(b.attributes={}),b.attributes.contenteditable=b.editable),b.attributes){D=b.attributes;for(S in D)P=D[S],x.setAttribute(S,P)}if(b.style){L=b.style;for(S in L)P=L[S],x.style[S]=P}if(b.data){T=b.data;for(S in T)P=T[S],x.dataset[S]=P}if(b.className)for(O=b.className.split(" "),w=0,R=O.length;R>w;w++)C=O[w],x.classList.add(C);if(b.textContent&&(x.textContent=b.textContent),b.childNodes)for(N=[].concat(b.childNodes),E=0,k=N.length;k>E;E++)A=N[E],x.appendChild(A);return x},getBlockTagNames:function(){var y,b;return null!=C.blockTagNames?C.blockTagNames:C.blockTagNames=function(){var A,x;A=C.config.blockAttributes,x=[];for(y in A)b=A[y].tagName,b&&x.push(b);return x}()},nodeIsBlockContainer:function(y){return C.nodeIsBlockStartComment(null!=y?y.firstChild:void 0)},nodeProbablyIsBlockContainer:function(y){var b,A;return b=C.tagName(y),S.call(C.getBlockTagNames(),b)>=0&&(A=C.tagName(y.firstChild),S.call(C.getBlockTagNames(),A)<0)},nodeIsBlockStart:function(y,b){var A;return A=(null!=b?b:{strict:!0}).strict,A?C.nodeIsBlockStartComment(y):C.nodeIsBlockStartComment(y)||!C.nodeIsBlockStartComment(y.firstChild)&&C.nodeProbablyIsBlockContainer(y)},nodeIsBlockStartComment:function(y){return C.nodeIsCommentNode(y)&&"block"===(null!=y?y.data:void 0)},nodeIsCommentNode:function(y){return(null!=y?y.nodeType:void 0)===Node.COMMENT_NODE},nodeIsCursorTarget:function(y,b){var A;return A=(null!=b?b:{}).name,y?C.nodeIsTextNode(y)?y.data===C.ZERO_WIDTH_SPACE?!A||y.parentNode.dataset.trixCursorTarget===A:void 0:C.nodeIsCursorTarget(y.firstChild):void 0},nodeIsAttachmentElement:function(y){return C.elementMatchesSelector(y,C.AttachmentView.attachmentSelector)},nodeIsEmptyTextNode:function(y){return C.nodeIsTextNode(y)&&""===(null!=y?y.data:void 0)},nodeIsTextNode:function(y){return(null!=y?y.nodeType:void 0)===Node.TEXT_NODE}})}.call(this||b),function(){var y,b,A,x,w;y=C.copyObject,x=C.objectsAreEqual,C.extend({normalizeRange:A=function(y){var A;if(null!=y)return Array.isArray(y)||(y=[y,y]),[b(y[0]),b(null!=(A=y[1])?A:y[0])]},rangeIsCollapsed:function(y){var b,C,x;if(null!=y)return C=A(y),x=C[0],b=C[1],w(x,b)},rangesAreEqual:function(y,b){var C,x,E,S,R,k;if(null!=y&&null!=b)return E=A(y),x=E[0],C=E[1],S=A(b),k=S[0],R=S[1],w(x,k)&&w(C,R)}}),b=function(b){return"number"==typeof b?b:y(b)},w=function(y,b){return"number"==typeof y?y===b:x(y,b)}}.call(this||b),function(){var y,A,x,w,E,S,R;C.registerElement=function(y,b){var A,C;return null==b&&(b={}),y=y.toLowerCase(),b=R(b),C=S(b),(A=C.defaultCSS)&&(delete C.defaultCSS,w(A,y)),E(y,C)},w=function(y,b){var A;return A=x(b),A.textContent=y.replace(/%t/g,b)},x=function(b){var A,C;return A=document.createElement("style"),A.setAttribute("type","text/css"),A.setAttribute("data-tag-name",b.toLowerCase()),(C=y())&&A.setAttribute("nonce",C),document.head.insertBefore(A,document.head.firstChild),A},y=function(){var y;return(y=A("trix-csp-nonce")||A("csp-nonce"))?y.getAttribute("content"):void 0},A=function(y){return document.head.querySelector("meta[name="+y+"]")},S=function(y){var b,A,C;A={};for(b in y)C=y[b],A[b]="function"==typeof C?{value:C}:C;return A},R=function(){var y;return y=function(y){var b,A,C,x,w;for(b={},w=["initialize","connect","disconnect"],A=0,x=w.length;x>A;A++)C=w[A],b[C]=y[C],delete y[C];return b},window.customElements?function(A){var C,x,w,E,S;return S=y(A),w=S.initialize,C=S.connect,x=S.disconnect,w&&(E=C,C=function(){return(this||b).initialized||((this||b).initialized=!0,w.call(this||b)),null!=E?E.call(this||b):void 0}),C&&(A.connectedCallback=C),x&&(A.disconnectedCallback=x),A}:function(b){var A,C,x,w;return w=y(b),x=w.initialize,A=w.connect,C=w.disconnect,x&&(b.createdCallback=x),A&&(b.attachedCallback=A),C&&(b.detachedCallback=C),b}}(),E=function(){return window.customElements?function(y,A){var C;return C=function(){return"object"==typeof Reflect?Reflect.construct(HTMLElement,[],C):HTMLElement.apply(this||b)},Object.setPrototypeOf(C.prototype,HTMLElement.prototype),Object.setPrototypeOf(C,HTMLElement),Object.defineProperties(C.prototype,A),window.customElements.define(y,C),C}:function(y,b){var A,C;return C=Object.create(HTMLElement.prototype,b),A=document.registerElement(y,{prototype:C}),Object.defineProperty(C,"constructor",{value:A}),A}}()}.call(this||b),function(){var y,b;C.extend({getDOMSelection:function(){var y;return y=window.getSelection(),y.rangeCount>0?y:void 0},getDOMRange:function(){var b,A;return(b=null!=(A=C.getDOMSelection())?A.getRangeAt(0):void 0)&&!y(b)?b:void 0},setDOMRange:function(y){var b;return b=window.getSelection(),b.removeAllRanges(),b.addRange(y),C.selectionChangeObserver.update()}}),y=function(y){return b(y.startContainer)||b(y.endContainer)},b=function(y){return!Object.getPrototypeOf(y)}}.call(this||b),function(){var y;y={"application/x-trix-feature-detection":"test"},C.extend({dataTransferIsPlainText:function(y){var b,A,C;return C=y.getData("text/plain"),A=y.getData("text/html"),C&&A?(b=(new DOMParser).parseFromString(A,"text/html").body,b.textContent===C?!b.querySelector("*"):void 0):null!=C?C.length:void 0},dataTransferIsWritable:function(b){var A,C;if(null!=(null!=b?b.setData:void 0)){for(A in y)if(C=y[A],!function(){try{return b.setData(A,C),b.getData(A)===C}catch(y){}}())return;return!0}},keyEventIsKeyboardCommand:function(){return/Mac|^iP/.test(navigator.platform)?function(y){return y.metaKey}:function(y){return y.ctrlKey}}()})}.call(this||b),function(){C.extend({RTL_PATTERN:/[\u05BE\u05C0\u05C3\u05D0-\u05EA\u05F0-\u05F4\u061B\u061F\u0621-\u063A\u0640-\u064A\u066D\u0671-\u06B7\u06BA-\u06BE\u06C0-\u06CE\u06D0-\u06D5\u06E5\u06E6\u200F\u202B\u202E\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE72\uFE74\uFE76-\uFEFC]/,getDirection:function(){var y,b,A,x;return b=C.makeElement("input",{dir:"auto",name:"x",dirName:"x.dir"}),y=C.makeElement("form"),y.appendChild(b),A=function(){try{return new FormData(y).has(b.dirName)}catch(y){}}(),x=function(){try{return b.matches(":dir(ltr),:dir(rtl)")}catch(y){}}(),A?function(A){return b.value=A,new FormData(y).get(b.dirName)}:x?function(y){return b.value=y,b.matches(":dir(rtl)")?"rtl":"ltr"}:function(y){var b;return b=y.trim().charAt(0),C.RTL_PATTERN.test(b)?"rtl":"ltr"}}()})}.call(this||b),function(){}.call(this||b),function(){var y,n=function(y,C){function n(){(this||b).constructor=y}for(var x in C)A.call(C,x)&&(y[x]=C[x]);return n.prototype=C.prototype,y.prototype=new n,y.__super__=C.prototype,y},A={}.hasOwnProperty;y=C.arraysAreEqual,C.Hash=function(A){function o(y){null==y&&(y={}),(this||b).values=w(y),o.__super__.constructor.apply(this||b,arguments)}var x,w,E,S,R;return n(o,A),o.fromCommonAttributesOfObjects=function(y){var A,C,w,E,S,R;if(null==y&&(y=[]),!y.length)return new(this||b);for(A=x(y[0]),w=A.getKeys(),R=y.slice(1),C=0,E=R.length;E>C;C++)S=R[C],w=A.getKeysCommonToHash(x(S)),A=A.slice(w);return A},o.box=function(y){return x(y)},o.prototype.add=function(y,b){return this.merge(S(y,b))},o.prototype.remove=function(y){return new C.Hash(w((this||b).values,y))},o.prototype.get=function(y){return(this||b).values[y]},o.prototype.has=function(y){return y in(this||b).values},o.prototype.merge=function(y){return new C.Hash(E((this||b).values,R(y)))},o.prototype.slice=function(y){var A,x,w,E;for(E={},A=0,w=y.length;w>A;A++)x=y[A],this.has(x)&&(E[x]=(this||b).values[x]);return new C.Hash(E)},o.prototype.getKeys=function(){return Object.keys((this||b).values)},o.prototype.getKeysCommonToHash=function(y){var A,C,w,E,S;for(y=x(y),E=this.getKeys(),S=[],A=0,w=E.length;w>A;A++)C=E[A],(this||b).values[C]===y.values[C]&&S.push(C);return S},o.prototype.isEqualTo=function(b){return y(this.toArray(),x(b).toArray())},o.prototype.isEmpty=function(){return 0===this.getKeys().length},o.prototype.toArray=function(){var y,A,C;return(null!=(this||b).array?(this||b).array:(this||b).array=function(){var x;A=[],x=(this||b).values;for(y in x)C=x[y],A.push(y,C);return A}.call(this||b)).slice(0)},o.prototype.toObject=function(){return w((this||b).values)},o.prototype.toJSON=function(){return this.toObject()},o.prototype.contentsForInspection=function(){return{values:JSON.stringify((this||b).values)}},S=function(y,b){var A;return A={},A[y]=b,A},E=function(y,b){var A,C,x;C=w(y);for(A in b)x=b[A],C[A]=x;return C},w=function(y,b){var A,C,x,w,E;for(w={},E=Object.keys(y).sort(),A=0,x=E.length;x>A;A++)C=E[A],C!==b&&(w[C]=y[C]);return w},x=function(y){return y instanceof C.Hash?y:new C.Hash(y)},R=function(y){return y instanceof C.Hash?y.values:y},o}(C.Object)}.call(this||b),function(){C.ObjectGroup=function(){function t(y,A){var C,x;(this||b).objects=null!=y?y:[],x=A.depth,C=A.asTree,C&&((this||b).depth=x,(this||b).objects=(this||b).constructor.groupObjects((this||b).objects,{asTree:C,depth:(this||b).depth+1}))}return t.groupObjects=function(y,A){var C,x,w,E,S,R,k,D,L;for(null==y&&(y=[]),L=null!=A?A:{},w=L.depth,C=L.asTree,C&&null==w&&(w=0),D=[],S=0,R=y.length;R>S;S++){if(k=y[S],E){if(("function"==typeof k.canBeGrouped?k.canBeGrouped(w):void 0)&&("function"==typeof(x=E[E.length-1]).canBeGroupedWith?x.canBeGroupedWith(k,w):void 0)){E.push(k);continue}D.push(new(this||b)(E,{depth:w,asTree:C})),E=null}("function"==typeof k.canBeGrouped?k.canBeGrouped(w):void 0)?E=[k]:D.push(k)}return E&&D.push(new(this||b)(E,{depth:w,asTree:C})),D},t.prototype.getObjects=function(){return(this||b).objects},t.prototype.getDepth=function(){return(this||b).depth},t.prototype.getCacheKey=function(){var y,b,A,C,x;for(b=["objectGroup"],x=this.getObjects(),y=0,A=x.length;A>y;y++)C=x[y],b.push(C.getCacheKey());return b.join("/")},t}()}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.ObjectMap=function(y){function n(y){var A,C,x,w,E;for(null==y&&(y=[]),(this||b).objects={},x=0,w=y.length;w>x;x++)E=y[x],C=JSON.stringify(E),null==(A=(this||b).objects)[C]&&(A[C]=E)}return t(n,y),n.prototype.find=function(y){var A;return A=JSON.stringify(y),(this||b).objects[A]},n}(C.BasicObject)}.call(this||b),function(){C.ElementStore=function(){function t(y){this.reset(y)}var y;return t.prototype.add=function(A){var C;return C=y(A),(this||b).elements[C]=A},t.prototype.remove=function(A){var C,x;return C=y(A),(x=(this||b).elements[C])?(delete(this||b).elements[C],x):void 0},t.prototype.reset=function(y){var A,C,x;for(null==y&&(y=[]),(this||b).elements={},C=0,x=y.length;x>C;C++)A=y[C],this.add(A);return y},y=function(y){return y.dataset.trixStoreKey},t}()}.call(this||b),function(){}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.Operation=function(y){function n(){return n.__super__.constructor.apply(this||b,arguments)}return t(n,y),n.prototype.isPerforming=function(){return!0===(this||b).performing},n.prototype.hasPerformed=function(){return!0===(this||b).performed},n.prototype.hasSucceeded=function(){return(this||b).performed&&(this||b).succeeded},n.prototype.hasFailed=function(){return(this||b).performed&&!(this||b).succeeded},n.prototype.getPromise=function(){return null!=(this||b).promise?(this||b).promise:(this||b).promise=new Promise(function(y){return function(b,A){return y.performing=!0,y.perform((function(C,x){return y.succeeded=C,y.performing=!1,y.performed=!0,y.succeeded?b(x):A(x)}))}}(this||b))},n.prototype.perform=function(y){return y(!1)},n.prototype.release=function(){var y;return null!=(y=(this||b).promise)&&"function"==typeof y.cancel&&y.cancel(),(this||b).promise=null,(this||b).performing=null,(this||b).performed=null,(this||b).succeeded=null},n.proxyMethod("getPromise().then"),n.proxyMethod("getPromise().catch"),n}(C.BasicObject)}.call(this||b),function(){var y,A,x,w,E,s=function(y,A){function n(){(this||b).constructor=y}for(var C in A)S.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},S={}.hasOwnProperty;C.UTF16String=function(y){function e(y,A){(this||b).ucs2String=y,(this||b).codepoints=A,(this||b).length=(this||b).codepoints.length,(this||b).ucs2Length=(this||b).ucs2String.length}return s(e,y),e.box=function(y){return null==y&&(y=""),y instanceof(this||b)?y:this.fromUCS2String(null!=y?y.toString():void 0)},e.fromUCS2String=function(y){return new(this||b)(y,w(y))},e.fromCodepoints=function(y){return new(this||b)(E(y),y)},e.prototype.offsetToUCS2Offset=function(y){return E((this||b).codepoints.slice(0,Math.max(0,y))).length},e.prototype.offsetFromUCS2Offset=function(y){return w((this||b).ucs2String.slice(0,Math.max(0,y))).length},e.prototype.slice=function(){var y;return(this||b).constructor.fromCodepoints((y=(this||b).codepoints).slice.apply(y,arguments))},e.prototype.charAt=function(y){return this.slice(y,y+1)},e.prototype.isEqualTo=function(y){return(this||b).constructor.box(y).ucs2String===(this||b).ucs2String},e.prototype.toJSON=function(){return(this||b).ucs2String},e.prototype.getCacheKey=function(){return(this||b).ucs2String},e.prototype.toString=function(){return(this||b).ucs2String},e}(C.BasicObject),y=1===("function"==typeof Array.from?Array.from("👼").length:void 0),A=null!=("function"==typeof" ".codePointAt?" ".codePointAt(0):void 0),x=" 👼"===("function"==typeof String.fromCodePoint?String.fromCodePoint(32,128124):void 0),w=y&&A?function(y){return Array.from(y).map((function(y){return y.codePointAt(0)}))}:function(y){var b,A,C,x,w;for(x=[],b=0,C=y.length;C>b;)w=y.charCodeAt(b++),w>=55296&&56319>=w&&C>b&&(A=y.charCodeAt(b++),56320===(64512&A)?w=((1023&w)<<10)+(1023&A)+65536:b--),x.push(w);return x},E=x?function(y){return String.fromCodePoint.apply(String,y)}:function(y){var b,A,C;return b=function(){var b,x,w;for(w=[],b=0,x=y.length;x>b;b++)C=y[b],A="",C>65535&&(C-=65536,A+=String.fromCharCode(C>>>10&1023|55296),C=56320|1023&C),w.push(A+String.fromCharCode(C));return w}(),b.join("")}}.call(this||b),function(){}.call(this||b),function(){}.call(this||b),function(){C.config.lang={attachFiles:"Attach Files",bold:"Bold",bullets:"Bullets",byte:"Byte",bytes:"Bytes",captionPlaceholder:"Add a caption…",code:"Code",heading1:"Heading",indent:"Increase Level",italic:"Italic",link:"Link",numbers:"Numbers",outdent:"Decrease Level",quote:"Quote",redo:"Redo",remove:"Remove",strike:"Strikethrough",undo:"Undo",unlink:"Unlink",url:"URL",urlPlaceholder:"Enter a URL…",GB:"GB",KB:"KB",MB:"MB",PB:"PB",TB:"TB"}}.call(this||b),function(){C.config.css={attachment:"attachment",attachmentCaption:"attachment__caption",attachmentCaptionEditor:"attachment__caption-editor",attachmentMetadata:"attachment__metadata",attachmentMetadataContainer:"attachment__metadata-container",attachmentName:"attachment__name",attachmentProgress:"attachment__progress",attachmentSize:"attachment__size",attachmentToolbar:"attachment__toolbar",attachmentGallery:"attachment-gallery"}}.call(this||b),function(){var y;C.config.blockAttributes=y={default:{tagName:"div",parse:!1},quote:{tagName:"blockquote",nestable:!0},heading1:{tagName:"h1",terminal:!0,breakOnReturn:!0,group:!1},code:{tagName:"pre",terminal:!0,text:{plaintext:!0}},bulletList:{tagName:"ul",parse:!1},bullet:{tagName:"li",listAttribute:"bulletList",group:!1,nestable:!0,test:function(A){return C.tagName(A.parentNode)===y[(this||b).listAttribute].tagName}},numberList:{tagName:"ol",parse:!1},number:{tagName:"li",listAttribute:"numberList",group:!1,nestable:!0,test:function(A){return C.tagName(A.parentNode)===y[(this||b).listAttribute].tagName}},attachmentGallery:{tagName:"div",exclusive:!0,terminal:!0,parse:!1,group:!1}}}.call(this||b),function(){var y,A;y=C.config.lang,A=[y.bytes,y.KB,y.MB,y.GB,y.TB,y.PB],C.config.fileSize={prefix:"IEC",precision:2,formatter:function(C){var x,w,E,S,R;switch(C){case 0:return"0 "+y.bytes;case 1:return"1 "+y.byte;default:return x=function(){switch((this||b).prefix){case"SI":return 1e3;case"IEC":return 1024}}.call(this||b),w=Math.floor(Math.log(C)/Math.log(x)),E=C/Math.pow(x,w),S=E.toFixed((this||b).precision),R=S.replace(/0*$/,"").replace(/\.$/,""),R+" "+A[w]}}}}.call(this||b),function(){C.config.textAttributes={bold:{tagName:"strong",inheritable:!0,parser:function(y){var b;return b=window.getComputedStyle(y),"bold"===b.fontWeight||b.fontWeight>=600}},italic:{tagName:"em",inheritable:!0,parser:function(y){var b;return b=window.getComputedStyle(y),"italic"===b.fontStyle}},href:{groupTagName:"a",parser:function(y){var b,A,x;return b=C.AttachmentView.attachmentSelector,x="a:not("+b+")",(A=C.findClosestElementFromNode(y,{matchingSelector:x}))?A.getAttribute("href"):void 0}},strike:{tagName:"del",inheritable:!0},frozen:{style:{backgroundColor:"highlight"}}}}.call(this||b),function(){var y,b,A,x,w;w="[data-trix-serialize=false]",x=["contenteditable","data-trix-id","data-trix-store-key","data-trix-mutable","data-trix-placeholder","tabindex"],b="data-trix-serialized-attributes",A="["+b+"]",y=new RegExp("\x3c!--block--\x3e","g"),C.extend({serializers:{"application/json":function(y){var b;if(y instanceof C.Document)b=y;else{if(!(y instanceof HTMLElement))throw new Error("unserializable object");b=C.Document.fromHTML(y.innerHTML)}return b.toSerializableDocument().toJSONString()},"text/html":function(E){var S,R,k,D,L,T,O,N,P,I,_,B,F,M,j,W,q;if(E instanceof C.Document)D=C.DocumentView.render(E);else{if(!(E instanceof HTMLElement))throw new Error("unserializable object");D=E.cloneNode(!0)}for(M=D.querySelectorAll(w),L=0,P=M.length;P>L;L++)k=M[L],C.removeNode(k);for(T=0,I=x.length;I>T;T++)for(S=x[T],j=D.querySelectorAll("["+S+"]"),O=0,_=j.length;_>O;O++)k=j[O],k.removeAttribute(S);for(W=D.querySelectorAll(A),N=0,B=W.length;B>N;N++){k=W[N];try{R=JSON.parse(k.getAttribute(b)),k.removeAttribute(b);for(F in R)q=R[F],k.setAttribute(F,q)}catch(y){}}return D.innerHTML.replace(y,"")}},deserializers:{"application/json":function(y){return C.Document.fromJSONString(y)},"text/html":function(y){return C.Document.fromHTML(y)}},serializeToContentType:function(y,b){var A;if(A=C.serializers[b])return A(y);throw new Error("unknown content type: "+b)},deserializeFromContentType:function(y,b){var A;if(A=C.deserializers[b])return A(y);throw new Error("unknown content type: "+b)}})}.call(this||b),function(){var y;y=C.config.lang,C.config.toolbar={getDefaultHTML:function(){return'<div class="trix-button-row">\n  <span class="trix-button-group trix-button-group--text-tools" data-trix-button-group="text-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-bold" data-trix-attribute="bold" data-trix-key="b" title="'+y.bold+'" tabindex="-1">'+y.bold+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-italic" data-trix-attribute="italic" data-trix-key="i" title="'+y.italic+'" tabindex="-1">'+y.italic+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-strike" data-trix-attribute="strike" title="'+y.strike+'" tabindex="-1">'+y.strike+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-link" data-trix-attribute="href" data-trix-action="link" data-trix-key="k" title="'+y.link+'" tabindex="-1">'+y.link+'</button>\n  </span>\n\n  <span class="trix-button-group trix-button-group--block-tools" data-trix-button-group="block-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-heading-1" data-trix-attribute="heading1" title="'+y.heading1+'" tabindex="-1">'+y.heading1+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-quote" data-trix-attribute="quote" title="'+y.quote+'" tabindex="-1">'+y.quote+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-code" data-trix-attribute="code" title="'+y.code+'" tabindex="-1">'+y.code+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-bullet-list" data-trix-attribute="bullet" title="'+y.bullets+'" tabindex="-1">'+y.bullets+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-number-list" data-trix-attribute="number" title="'+y.numbers+'" tabindex="-1">'+y.numbers+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-decrease-nesting-level" data-trix-action="decreaseNestingLevel" title="'+y.outdent+'" tabindex="-1">'+y.outdent+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-increase-nesting-level" data-trix-action="increaseNestingLevel" title="'+y.indent+'" tabindex="-1">'+y.indent+'</button>\n  </span>\n\n  <span class="trix-button-group trix-button-group--file-tools" data-trix-button-group="file-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-attach" data-trix-action="attachFiles" title="'+y.attachFiles+'" tabindex="-1">'+y.attachFiles+'</button>\n  </span>\n\n  <span class="trix-button-group-spacer"></span>\n\n  <span class="trix-button-group trix-button-group--history-tools" data-trix-button-group="history-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-undo" data-trix-action="undo" data-trix-key="z" title="'+y.undo+'" tabindex="-1">'+y.undo+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-redo" data-trix-action="redo" data-trix-key="shift+z" title="'+y.redo+'" tabindex="-1">'+y.redo+'</button>\n  </span>\n</div>\n\n<div class="trix-dialogs" data-trix-dialogs>\n  <div class="trix-dialog trix-dialog--link" data-trix-dialog="href" data-trix-dialog-attribute="href">\n    <div class="trix-dialog__link-fields">\n      <input type="url" name="href" class="trix-input trix-input--dialog" placeholder="'+y.urlPlaceholder+'" aria-label="'+y.url+'" required data-trix-input>\n      <div class="trix-button-group">\n        <input type="button" class="trix-button trix-button--dialog" value="'+y.link+'" data-trix-method="setAttribute">\n        <input type="button" class="trix-button trix-button--dialog" value="'+y.unlink+'" data-trix-method="removeAttribute">\n      </div>\n    </div>\n  </div>\n</div>'}}}.call(this||b),function(){C.config.undoInterval=5e3}.call(this||b),function(){C.config.attachments={preview:{presentation:"gallery",caption:{name:!0,size:!0}},file:{caption:{size:!0}}}}.call(this||b),function(){C.config.keyNames={8:"backspace",9:"tab",13:"return",27:"escape",37:"left",39:"right",46:"delete",68:"d",72:"h",79:"o"}}.call(this||b),function(){C.config.input={level2Enabled:!0,getLevel:function(){return(this||b).level2Enabled&&C.browser.supportsInputEvents?2:0},pickFiles:function(y){var A;return A=C.makeElement("input",{type:"file",multiple:!0,hidden:!0,id:(this||b).fileInputId}),A.addEventListener("change",(function(){return y(A.files),C.removeNode(A)})),C.removeNode(document.getElementById((this||b).fileInputId)),document.body.appendChild(A),A.click()},fileInputId:"trix-file-input-"+Date.now().toString(16)}}.call(this||b),function(){}.call(this||b),function(){C.registerElement("trix-toolbar",{defaultCSS:"%t {\n  display: block;\n}\n\n%t {\n  white-space: nowrap;\n}\n\n%t [data-trix-dialog] {\n  display: none;\n}\n\n%t [data-trix-dialog][data-trix-active] {\n  display: block;\n}\n\n%t [data-trix-dialog] [data-trix-validate]:invalid {\n  background-color: #ffdddd;\n}",initialize:function(){return""===(this||b).innerHTML?(this||b).innerHTML=C.config.toolbar.getDefaultHTML():void 0}})}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty,A=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};C.ObjectView=function(y){function o(y,A){(this||b).object=y,(this||b).options=null!=A?A:{},(this||b).childViews=[],(this||b).rootView=this||b}return t(o,y),o.prototype.getNodes=function(){var y,A,C,x,w;for(null==(this||b).nodes&&((this||b).nodes=this.createNodes()),x=(this||b).nodes,w=[],y=0,A=x.length;A>y;y++)C=x[y],w.push(C.cloneNode(!0));return w},o.prototype.invalidate=function(){var y;return(this||b).nodes=null,(this||b).childViews=[],null!=(y=(this||b).parentView)?y.invalidate():void 0},o.prototype.invalidateViewForObject=function(y){var b;return null!=(b=this.findViewForObject(y))?b.invalidate():void 0},o.prototype.findOrCreateCachedChildView=function(y,A){var C;return(C=this.getCachedViewForObject(A))?this.recordChildView(C):(C=(this||b).createChildView.apply(this||b,arguments),this.cacheViewForObject(C,A)),C},o.prototype.createChildView=function(y,b,A){var x;return null==A&&(A={}),b instanceof C.ObjectGroup&&(A.viewClass=y,y=C.ObjectGroupView),x=new y(b,A),this.recordChildView(x)},o.prototype.recordChildView=function(y){return y.parentView=this||b,y.rootView=(this||b).rootView,(this||b).childViews.push(y),y},o.prototype.getAllChildViews=function(){var y,A,C,x,w;for(w=[],x=(this||b).childViews,A=0,C=x.length;C>A;A++)y=x[A],w.push(y),w=w.concat(y.getAllChildViews());return w},o.prototype.findElement=function(){return this.findElementForObject((this||b).object)},o.prototype.findElementForObject=function(y){var A;return(A=null!=y?y.id:void 0)?(this||b).rootView.element.querySelector("[data-trix-id='"+A+"']"):void 0},o.prototype.findViewForObject=function(y){var b,A,C,x;for(C=this.getAllChildViews(),b=0,A=C.length;A>b;b++)if(x=C[b],x.object===y)return x},o.prototype.getViewCache=function(){return(this||b).rootView!==(this||b)?(this||b).rootView.getViewCache():this.isViewCachingEnabled()?null!=(this||b).viewCache?(this||b).viewCache:(this||b).viewCache={}:void 0},o.prototype.isViewCachingEnabled=function(){return!1!==(this||b).shouldCacheViews},o.prototype.enableViewCaching=function(){return(this||b).shouldCacheViews=!0},o.prototype.disableViewCaching=function(){return(this||b).shouldCacheViews=!1},o.prototype.getCachedViewForObject=function(y){var b;return null!=(b=this.getViewCache())?b[y.getCacheKey()]:void 0},o.prototype.cacheViewForObject=function(y,b){var A;return null!=(A=this.getViewCache())?A[b.getCacheKey()]=y:void 0},o.prototype.garbageCollectCachedViews=function(){var y,C,x,w,E,S;if(y=this.getViewCache()){S=this.getAllChildViews().concat(this||b),x=function(){var y,b,A;for(A=[],y=0,b=S.length;b>y;y++)E=S[y],A.push(E.object.getCacheKey());return A}(),w=[];for(C in y)A.call(x,C)<0&&w.push(delete y[C]);return w}},o}(C.BasicObject)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.ObjectGroupView=function(y){function n(){n.__super__.constructor.apply(this||b,arguments),(this||b).objectGroup=(this||b).object,(this||b).viewClass=(this||b).options.viewClass,delete(this||b).options.viewClass}return t(n,y),n.prototype.getChildViews=function(){var y,A,C,x;if(!(this||b).childViews.length)for(x=(this||b).objectGroup.getObjects(),y=0,A=x.length;A>y;y++)C=x[y],this.findOrCreateCachedChildView((this||b).viewClass,C,(this||b).options);return(this||b).childViews},n.prototype.createNodes=function(){var y,b,A,C,x,w,E,S,R;for(y=this.createContainerElement(),E=this.getChildViews(),b=0,C=E.length;C>b;b++)for(R=E[b],S=R.getNodes(),A=0,x=S.length;x>A;A++)w=S[A],y.appendChild(w);return[y]},n.prototype.createContainerElement=function(y){return null==y&&(y=(this||b).objectGroup.getDepth()),this.getChildViews()[0].createContainerElement(y)},n}(C.ObjectView)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.Controller=function(y){function n(){return n.__super__.constructor.apply(this||b,arguments)}return t(n,y),n}(C.BasicObject)}.call(this||b),function(){var y,A,x,w,E,S,a=function(y,b){return function(){return y.apply(b,arguments)}},u=function(y,A){function n(){(this||b).constructor=y}for(var C in A)R.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},R={}.hasOwnProperty,k=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};y=C.findClosestElementFromNode,x=C.nodeIsEmptyTextNode,A=C.nodeIsBlockStartComment,w=C.normalizeSpaces,E=C.summarizeStringChange,S=C.tagName,C.MutationObserver=function(C){function c(y){(this||b).element=y,(this||b).didMutate=a((this||b).didMutate,this||b),(this||b).observer=new window.MutationObserver((this||b).didMutate),this.start()}var R,D,L,T;return u(c,C),D="data-trix-mutable",L="["+D+"]",T={attributes:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},c.prototype.start=function(){return this.reset(),(this||b).observer.observe((this||b).element,T)},c.prototype.stop=function(){return(this||b).observer.disconnect()},c.prototype.didMutate=function(y){var A,C;return(A=(this||b).mutations).push.apply(A,this.findSignificantMutations(y)),(this||b).mutations.length?(null!=(C=(this||b).delegate)&&"function"==typeof C.elementDidMutate&&C.elementDidMutate(this.getMutationSummary()),this.reset()):void 0},c.prototype.reset=function(){return(this||b).mutations=[]},c.prototype.findSignificantMutations=function(y){var b,A,C,x;for(x=[],b=0,A=y.length;A>b;b++)C=y[b],this.mutationIsSignificant(C)&&x.push(C);return x},c.prototype.mutationIsSignificant=function(y){var b,A,C,x;if(this.nodeIsMutable(y.target))return!1;for(x=this.nodesModifiedByMutation(y),b=0,A=x.length;A>b;b++)if(C=x[b],this.nodeIsSignificant(C))return!0;return!1},c.prototype.nodeIsSignificant=function(y){return y!==(this||b).element&&!this.nodeIsMutable(y)&&!x(y)},c.prototype.nodeIsMutable=function(b){return y(b,{matchingSelector:L})},c.prototype.nodesModifiedByMutation=function(y){var b;switch(b=[],y.type){case"attributes":y.attributeName!==D&&b.push(y.target);break;case"characterData":b.push(y.target.parentNode),b.push(y.target);break;case"childList":b.push.apply(b,y.addedNodes),b.push.apply(b,y.removedNodes)}return b},c.prototype.getMutationSummary=function(){return this.getTextMutationSummary()},c.prototype.getTextMutationSummary=function(){var y,b,A,C,x,w,E,S,R,D,L;for(S=this.getTextChangesFromCharacterData(),A=S.additions,x=S.deletions,L=this.getTextChangesFromChildList(),R=L.additions,w=0,E=R.length;E>w;w++)b=R[w],k.call(A,b)<0&&A.push(b);return x.push.apply(x,L.deletions),D={},(y=A.join(""))&&(D.textAdded=y),(C=x.join(""))&&(D.textDeleted=C),D},c.prototype.getMutationsByType=function(y){var A,C,x,w,E;for(w=(this||b).mutations,E=[],A=0,C=w.length;C>A;A++)x=w[A],x.type===y&&E.push(x);return E},c.prototype.getTextChangesFromChildList=function(){var y,b,C,x,E,S,k,D,L,T,O;for(y=[],k=[],S=this.getMutationsByType("childList"),b=0,x=S.length;x>b;b++)E=S[b],y.push.apply(y,E.addedNodes),k.push.apply(k,E.removedNodes);return D=0===y.length&&1===k.length&&A(k[0]),D?(T=[],O=["\n"]):(T=R(y),O=R(k)),{additions:function(){var y,b,A;for(A=[],C=y=0,b=T.length;b>y;C=++y)L=T[C],L!==O[C]&&A.push(w(L));return A}(),deletions:function(){var y,b,A;for(A=[],C=y=0,b=O.length;b>y;C=++y)L=O[C],L!==T[C]&&A.push(w(L));return A}()}},c.prototype.getTextChangesFromCharacterData=function(){var y,b,A,C,x,S,R,k;return b=this.getMutationsByType("characterData"),b.length&&(k=b[0],A=b[b.length-1],x=w(k.oldValue),C=w(A.target.data),S=E(x,C),y=S.added,R=S.removed),{additions:y?[y]:[],deletions:R?[R]:[]}},R=function(y){var b,A,C,x;for(null==y&&(y=[]),x=[],b=0,A=y.length;A>b;b++)switch(C=y[b],C.nodeType){case Node.TEXT_NODE:x.push(C.data);break;case Node.ELEMENT_NODE:"br"===S(C)?x.push("\n"):x.push.apply(x,R(C.childNodes))}return x},c}(C.BasicObject)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.FileVerificationOperation=function(y){function n(y){(this||b).file=y}return t(n,y),n.prototype.perform=function(y){var A;return A=new FileReader,A.onerror=function(){return y(!1)},A.onload=function(b){return function(){A.onerror=null;try{A.abort()}catch(y){}return y(!0,b.file)}}(this||b),A.readAsArrayBuffer((this||b).file)},n}(C.Operation)}.call(this||b),function(){var y,A,i=function(y,A){function n(){(this||b).constructor=y}for(var C in A)x.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},x={}.hasOwnProperty;y=C.handleEvent,A=C.innerElementIsActive,C.InputController=function(x){function r(A){var x;(this||b).element=A,(this||b).mutationObserver=new C.MutationObserver((this||b).element),(this||b).mutationObserver.delegate=this||b;for(x in(this||b).events)y(x,{onElement:(this||b).element,withCallback:this.handlerFor(x)})}return i(r,x),r.prototype.events={},r.prototype.elementDidMutate=function(){},r.prototype.editorWillSyncDocumentView=function(){return(this||b).mutationObserver.stop()},r.prototype.editorDidSyncDocumentView=function(){return(this||b).mutationObserver.start()},r.prototype.requestRender=function(){var y;return null!=(y=(this||b).delegate)&&"function"==typeof y.inputControllerDidRequestRender?y.inputControllerDidRequestRender():void 0},r.prototype.requestReparse=function(){var y;return null!=(y=(this||b).delegate)&&"function"==typeof y.inputControllerDidRequestReparse&&y.inputControllerDidRequestReparse(),this.requestRender()},r.prototype.attachFiles=function(y){var A,x;return x=function(){var b,x,w;for(w=[],b=0,x=y.length;x>b;b++)A=y[b],w.push(new C.FileVerificationOperation(A));return w}(),Promise.all(x).then(function(y){return function(A){return y.handleInput((function(){var y,C;return null!=(y=(this||b).delegate)&&y.inputControllerWillAttachFiles(),null!=(C=(this||b).responder)&&C.insertFiles(A),this.requestRender()}))}}(this||b))},r.prototype.handlerFor=function(y){return function(C){return function(x){return x.defaultPrevented?void 0:C.handleInput((function(){return A((this||b).element)?void 0:((this||b).eventName=y,(this||b).events[y].call(this||b,x))}))}}(this||b)},r.prototype.handleInput=function(y){var A,C;try{return null!=(A=(this||b).delegate)&&A.inputControllerWillHandleInput(),y.call(this||b)}finally{null!=(C=(this||b).delegate)&&C.inputControllerDidHandleInput()}},r.prototype.createLinkHTML=function(y,b){var A;return A=document.createElement("a"),A.href=y,A.textContent=null!=b?b:y,A.outerHTML},r}(C.BasicObject)}.call(this||b),function(){var y,A,x,w,E,S,R,k,D,L,T,O,f=function(y,A){function n(){(this||b).constructor=y}for(var C in A)N.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},N={}.hasOwnProperty,P=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};D=C.makeElement,L=C.objectsAreEqual,C.tagName,A=C.browser,R=C.keyEventIsKeyboardCommand,w=C.dataTransferIsWritable,x=C.dataTransferIsPlainText,k=C.config.keyNames,C.Level0InputController=function(A){function s(){s.__super__.constructor.apply(this||b,arguments),this.resetInputSummary()}var S;return f(s,A),S=0,s.prototype.setInputSummary=function(y){var A,C;null==y&&(y={}),(this||b).inputSummary.eventName=(this||b).eventName;for(A in y)C=y[A],(this||b).inputSummary[A]=C;return(this||b).inputSummary},s.prototype.resetInputSummary=function(){return(this||b).inputSummary={}},s.prototype.reset=function(){return this.resetInputSummary(),C.selectionChangeObserver.reset()},s.prototype.elementDidMutate=function(y){var A;return this.isComposing()?null!=(A=(this||b).delegate)&&"function"==typeof A.inputControllerDidAllowUnhandledInput?A.inputControllerDidAllowUnhandledInput():void 0:this.handleInput((function(){return this.mutationIsSignificant(y)&&(this.mutationIsExpected(y)?this.requestRender():this.requestReparse()),this.reset()}))},s.prototype.mutationIsExpected=function(y){var A,C,x,w,E,S,R,k,D,L;return R=y.textAdded,k=y.textDeleted,!!(this||b).inputSummary.preferDocument||(A=null!=R?R===(this||b).inputSummary.textAdded:!(this||b).inputSummary.textAdded,C=null!=k?(this||b).inputSummary.didDelete:!(this||b).inputSummary.didDelete,D=("\n"===R||" \n"===R)&&!A,L="\n"===k&&!C,S=D&&!L||L&&!D,!!(S&&(w=this.getSelectedRange())&&(x=D?R.replace(/\n$/,"").length||-1:(null!=R?R.length:void 0)||1,null!=(E=(this||b).responder)?E.positionIsBlockBreak(w[1]+x):void 0))||A&&C)},s.prototype.mutationIsSignificant=function(y){var A,C,x;return x=Object.keys(y).length>0,A=""===(null!=(C=(this||b).compositionInput)?C.getEndData():void 0),x||!A},s.prototype.events={keydown:function(y){var A,x,w,E,S,D,L,T,O;if(this.isComposing()||this.resetInputSummary(),(this||b).inputSummary.didInput=!0,E=k[y.keyCode]){for(x=(this||b).keys,T=["ctrl","alt","shift","meta"],w=0,D=T.length;D>w;w++)L=T[w],y[L+"Key"]&&("ctrl"===L&&(L="control"),x=null!=x?x[L]:void 0);null!=(null!=x?x[E]:void 0)&&(this.setInputSummary({keyName:E}),C.selectionChangeObserver.reset(),x[E].call(this||b,y))}return R(y)&&(A=String.fromCharCode(y.keyCode).toLowerCase())&&(S=function(){var b,A,C,x;for(C=["alt","shift"],x=[],b=0,A=C.length;A>b;b++)L=C[b],y[L+"Key"]&&x.push(L);return x}(),S.push(A),null!=(O=(this||b).delegate)?O.inputControllerDidReceiveKeyboardCommand(S):void 0)?y.preventDefault():void 0},keypress:function(y){var A,C,x;if(null==(this||b).inputSummary.eventName&&!y.metaKey&&(!y.ctrlKey||y.altKey))return(x=O(y))?(null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),null!=(C=(this||b).responder)&&C.insertString(x),this.setInputSummary({textAdded:x,didDelete:this.selectionIsExpanded()})):void 0},textInput:function(y){var A,C,x,w;return A=y.data,w=(this||b).inputSummary.textAdded,w&&w!==A&&w.toUpperCase()===A?(C=this.getSelectedRange(),this.setSelectedRange([C[0],C[1]+w.length]),null!=(x=(this||b).responder)&&x.insertString(A),this.setInputSummary({textAdded:A}),this.setSelectedRange(C)):void 0},dragenter:function(y){return y.preventDefault()},dragstart:function(y){var A;return y.target,this.serializeSelectionToDataTransfer(y.dataTransfer),(this||b).draggedRange=this.getSelectedRange(),null!=(A=(this||b).delegate)&&"function"==typeof A.inputControllerDidStartDrag?A.inputControllerDidStartDrag():void 0},dragover:function(y){var A,C;return!(this||b).draggedRange&&!this.canAcceptDataTransfer(y.dataTransfer)||(y.preventDefault(),A={x:y.clientX,y:y.clientY},L(A,(this||b).draggingPoint))?void 0:((this||b).draggingPoint=A,null!=(C=(this||b).delegate)&&"function"==typeof C.inputControllerDidReceiveDragOverPoint?C.inputControllerDidReceiveDragOverPoint((this||b).draggingPoint):void 0)},dragend:function(){var y;return null!=(y=(this||b).delegate)&&"function"==typeof y.inputControllerDidCancelDrag&&y.inputControllerDidCancelDrag(),(this||b).draggedRange=null,(this||b).draggingPoint=null},drop:function(y){var A,x,w,E,S,R,k,D,L;return y.preventDefault(),w=null!=(S=y.dataTransfer)?S.files:void 0,E={x:y.clientX,y:y.clientY},null!=(R=(this||b).responder)&&R.setLocationRangeFromPointRange(E),(null!=w?w.length:void 0)?this.attachFiles(w):(this||b).draggedRange?(null!=(k=(this||b).delegate)&&k.inputControllerWillMoveText(),null!=(D=(this||b).responder)&&D.moveTextFromRange((this||b).draggedRange),(this||b).draggedRange=null,this.requestRender()):(x=y.dataTransfer.getData("application/x-trix-document"))&&(A=C.Document.fromJSONString(x),null!=(L=(this||b).responder)&&L.insertDocument(A),this.requestRender()),(this||b).draggedRange=null,(this||b).draggingPoint=null},cut:function(y){var A,C;return(null!=(A=(this||b).responder)?A.selectionIsExpanded():void 0)&&(this.serializeSelectionToDataTransfer(y.clipboardData)&&y.preventDefault(),null!=(C=(this||b).delegate)&&C.inputControllerWillCutText(),this.deleteInDirection("backward"),y.defaultPrevented)?this.requestRender():void 0},copy:function(y){var A;return(null!=(A=(this||b).responder)?A.selectionIsExpanded():void 0)&&this.serializeSelectionToDataTransfer(y.clipboardData)?y.preventDefault():void 0},paste:function(y){var A,w,R,k,D,L,O,N,I,_,B,F,M,j,W,q,V,U,H,z,J,K,G;return A=null!=(N=y.clipboardData)?N:y.testClipboardData,O={clipboard:A},null==A||T(y)?void this.getPastedHTMLUsingHiddenElement(function(y){return function(b){var A,C,x;return O.type="text/html",O.html=b,null!=(A=y.delegate)&&A.inputControllerWillPaste(O),null!=(C=y.responder)&&C.insertHTML(O.html),y.requestRender(),null!=(x=y.delegate)?x.inputControllerDidPaste(O):void 0}}(this||b)):((k=A.getData("URL"))?(O.type="text/html",G=(L=A.getData("public.url-name"))?C.squishBreakableWhitespace(L).trim():k,O.html=this.createLinkHTML(k,G),null!=(I=(this||b).delegate)&&I.inputControllerWillPaste(O),this.setInputSummary({textAdded:G,didDelete:this.selectionIsExpanded()}),null!=(W=(this||b).responder)&&W.insertHTML(O.html),this.requestRender(),null!=(q=(this||b).delegate)&&q.inputControllerDidPaste(O)):x(A)?(O.type="text/plain",O.string=A.getData("text/plain"),null!=(V=(this||b).delegate)&&V.inputControllerWillPaste(O),this.setInputSummary({textAdded:O.string,didDelete:this.selectionIsExpanded()}),null!=(U=(this||b).responder)&&U.insertString(O.string),this.requestRender(),null!=(H=(this||b).delegate)&&H.inputControllerDidPaste(O)):(D=A.getData("text/html"))?(O.type="text/html",O.html=D,null!=(z=(this||b).delegate)&&z.inputControllerWillPaste(O),null!=(J=(this||b).responder)&&J.insertHTML(O.html),this.requestRender(),null!=(K=(this||b).delegate)&&K.inputControllerDidPaste(O)):P.call(A.types,"Files")>=0&&(R=null!=(_=A.items)&&null!=(B=_[0])&&"function"==typeof B.getAsFile?B.getAsFile():void 0)&&(!R.name&&(w=E(R))&&(R.name="pasted-file-"+ ++S+"."+w),O.type="File",O.file=R,null!=(F=(this||b).delegate)&&F.inputControllerWillAttachFiles(),null!=(M=(this||b).responder)&&M.insertFile(O.file),this.requestRender(),null!=(j=(this||b).delegate)&&j.inputControllerDidPaste(O)),y.preventDefault())},compositionstart:function(y){return this.getCompositionInput().start(y.data)},compositionupdate:function(y){return this.getCompositionInput().update(y.data)},compositionend:function(y){return this.getCompositionInput().end(y.data)},beforeinput:function(){return(this||b).inputSummary.didInput=!0},input:function(y){return(this||b).inputSummary.didInput=!0,y.stopPropagation()}},s.prototype.keys={backspace:function(y){var A;return null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),this.deleteInDirection("backward",y)},delete:function(y){var A;return null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),this.deleteInDirection("forward",y)},return:function(){var y,A;return this.setInputSummary({preferDocument:!0}),null!=(y=(this||b).delegate)&&y.inputControllerWillPerformTyping(),null!=(A=(this||b).responder)?A.insertLineBreak():void 0},tab:function(y){var A,C;return(null!=(A=(this||b).responder)?A.canIncreaseNestingLevel():void 0)?(null!=(C=(this||b).responder)&&C.increaseNestingLevel(),this.requestRender(),y.preventDefault()):void 0},left:function(y){var A;return this.selectionIsInCursorTarget()?(y.preventDefault(),null!=(A=(this||b).responder)?A.moveCursorInDirection("backward"):void 0):void 0},right:function(y){var A;return this.selectionIsInCursorTarget()?(y.preventDefault(),null!=(A=(this||b).responder)?A.moveCursorInDirection("forward"):void 0):void 0},control:{d:function(y){var A;return null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),this.deleteInDirection("forward",y)},h:function(y){var A;return null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),this.deleteInDirection("backward",y)},o:function(y){var A,C;return y.preventDefault(),null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),null!=(C=(this||b).responder)&&C.insertString("\n",{updatePosition:!1}),this.requestRender()}},shift:{return:function(y){var A,C;return null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),null!=(C=(this||b).responder)&&C.insertString("\n"),this.requestRender(),y.preventDefault()},tab:function(y){var A,C;return(null!=(A=(this||b).responder)?A.canDecreaseNestingLevel():void 0)?(null!=(C=(this||b).responder)&&C.decreaseNestingLevel(),this.requestRender(),y.preventDefault()):void 0},left:function(y){return this.selectionIsInCursorTarget()?(y.preventDefault(),this.expandSelectionInDirection("backward")):void 0},right:function(y){return this.selectionIsInCursorTarget()?(y.preventDefault(),this.expandSelectionInDirection("forward")):void 0}},alt:{backspace:function(){var y;return this.setInputSummary({preferDocument:!1}),null!=(y=(this||b).delegate)?y.inputControllerWillPerformTyping():void 0}},meta:{backspace:function(){var y;return this.setInputSummary({preferDocument:!1}),null!=(y=(this||b).delegate)?y.inputControllerWillPerformTyping():void 0}}},s.prototype.getCompositionInput=function(){return this.isComposing()?(this||b).compositionInput:(this||b).compositionInput=new y(this||b)},s.prototype.isComposing=function(){return null!=(this||b).compositionInput&&!(this||b).compositionInput.isEnded()},s.prototype.deleteInDirection=function(y,A){var C;return!1!==(null!=(C=(this||b).responder)?C.deleteInDirection(y):void 0)?this.setInputSummary({didDelete:!0}):A?(A.preventDefault(),this.requestRender()):void 0},s.prototype.serializeSelectionToDataTransfer=function(y){var A,x;if(w(y))return A=null!=(x=(this||b).responder)?x.getSelectedDocument().toSerializableDocument():void 0,y.setData("application/x-trix-document",JSON.stringify(A)),y.setData("text/html",C.DocumentView.render(A).innerHTML),y.setData("text/plain",A.toString().replace(/\n$/,"")),!0},s.prototype.canAcceptDataTransfer=function(y){var b,A,C,x,w,E;for(E={},x=null!=(C=null!=y?y.types:void 0)?C:[],b=0,A=x.length;A>b;b++)w=x[b],E[w]=!0;return E.Files||E["application/x-trix-document"]||E["text/html"]||E["text/plain"]},s.prototype.getPastedHTMLUsingHiddenElement=function(y){var A,x,w;return x=this.getSelectedRange(),w={position:"absolute",left:window.pageXOffset+"px",top:window.pageYOffset+"px",opacity:0},A=D({style:w,tagName:"div",editable:!0}),document.body.appendChild(A),A.focus(),requestAnimationFrame(function(b){return function(){var w;return w=A.innerHTML,C.removeNode(A),b.setSelectedRange(x),y(w)}}(this||b))},s.proxyMethod("responder?.getSelectedRange"),s.proxyMethod("responder?.setSelectedRange"),s.proxyMethod("responder?.expandSelectionInDirection"),s.proxyMethod("responder?.selectionIsInCursorTarget"),s.proxyMethod("responder?.selectionIsExpanded"),s}(C.InputController),E=function(y){var b,A;return null!=(b=y.type)&&null!=(A=b.match(/\/(\w+)$/))?A[1]:void 0},S=null!=("function"==typeof" ".codePointAt?" ".codePointAt(0):void 0),O=function(y){var b;return y.key&&S&&y.key.codePointAt(0)===y.keyCode?y.key:(null===y.which?b=y.keyCode:0!==y.which&&0!==y.charCode&&(b=y.charCode),null!=b&&"escape"!==k[b]?C.UTF16String.fromCodepoints([b]).toString():void 0)},T=function(y){var b,A,C,x,w,E,S,R,k;if(S=y.clipboardData){if(P.call(S.types,"text/html")>=0){for(R=S.types,C=0,E=R.length;E>C;C++)if(k=R[C],b=/^CorePasteboardFlavorType/.test(k),A=/^dyn\./.test(k)&&S.getData(k),b||A)return!0;return!1}return x=P.call(S.types,"com.apple.webarchive")>=0,w=P.call(S.types,"com.apple.flat-rtfd")>=0,x||w}},y=function(y){function e(y){var A;(this||b).inputController=y,A=(this||b).inputController,(this||b).responder=A.responder,(this||b).delegate=A.delegate,(this||b).inputSummary=A.inputSummary,(this||b).data={}}return f(e,y),e.prototype.start=function(y){var A,C;return(this||b).data.start=y,this.isSignificant()?("keypress"===(this||b).inputSummary.eventName&&(this||b).inputSummary.textAdded&&null!=(A=(this||b).responder)&&A.deleteInDirection("left"),this.selectionIsExpanded()||(this.insertPlaceholder(),this.requestRender()),(this||b).range=null!=(C=(this||b).responder)?C.getSelectedRange():void 0):void 0},e.prototype.update=function(y){var A;return(this||b).data.update=y,this.isSignificant()&&(A=this.selectPlaceholder())?(this.forgetPlaceholder(),(this||b).range=A):void 0},e.prototype.end=function(y){var A,C,x,w;return(this||b).data.end=y,this.isSignificant()?(this.forgetPlaceholder(),this.canApplyToDocument()?(this.setInputSummary({preferDocument:!0,didInput:!1}),null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),null!=(C=(this||b).responder)&&C.setSelectedRange((this||b).range),null!=(x=(this||b).responder)&&x.insertString((this||b).data.end),null!=(w=(this||b).responder)?w.setSelectedRange((this||b).range[0]+(this||b).data.end.length):void 0):null!=(this||b).data.start||null!=(this||b).data.update?(this.requestReparse(),(this||b).inputController.reset()):void 0):(this||b).inputController.reset()},e.prototype.getEndData=function(){return(this||b).data.end},e.prototype.isEnded=function(){return null!=this.getEndData()},e.prototype.isSignificant=function(){return!A.composesExistingText||(this||b).inputSummary.didInput},e.prototype.canApplyToDocument=function(){var y,A;return 0===(null!=(y=(this||b).data.start)?y.length:void 0)&&(null!=(A=(this||b).data.end)?A.length:void 0)>0&&null!=(this||b).range},e.proxyMethod("inputController.setInputSummary"),e.proxyMethod("inputController.requestRender"),e.proxyMethod("inputController.requestReparse"),e.proxyMethod("responder?.selectionIsExpanded"),e.proxyMethod("responder?.insertPlaceholder"),e.proxyMethod("responder?.selectPlaceholder"),e.proxyMethod("responder?.forgetPlaceholder"),e}(C.BasicObject)}.call(this||b),function(){var y,A,x,o=function(y,b){return function(){return y.apply(b,arguments)}},r=function(y,A){function n(){(this||b).constructor=y}for(var C in A)w.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},w={}.hasOwnProperty,E=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};y=C.dataTransferIsPlainText,A=C.keyEventIsKeyboardCommand,x=C.objectsAreEqual,C.Level2InputController=function(w){function u(){return(this||b).render=o((this||b).render,this||b),u.__super__.constructor.apply(this||b,arguments)}var S,R,k,D,L,T;return r(u,w),u.prototype.elementDidMutate=function(){var y;return(this||b).scheduledRender?(this||b).composing&&null!=(y=(this||b).delegate)&&"function"==typeof y.inputControllerDidAllowUnhandledInput?y.inputControllerDidAllowUnhandledInput():void 0:this.reparse()},u.prototype.scheduleRender=function(){return null!=(this||b).scheduledRender?(this||b).scheduledRender:(this||b).scheduledRender=requestAnimationFrame((this||b).render)},u.prototype.render=function(){var y;return cancelAnimationFrame((this||b).scheduledRender),(this||b).scheduledRender=null,(this||b).composing||null!=(y=(this||b).delegate)&&y.render(),"function"==typeof(this||b).afterRender&&this.afterRender(),(this||b).afterRender=null},u.prototype.reparse=function(){var y;return null!=(y=(this||b).delegate)?y.reparse():void 0},u.prototype.events={keydown:function(y){var C,x,w,E;if(A(y)){if(C=R(y),null!=(E=(this||b).delegate)?E.inputControllerDidReceiveKeyboardCommand(C):void 0)return y.preventDefault()}else if(w=y.key,y.altKey&&(w+="+Alt"),y.shiftKey&&(w+="+Shift"),x=(this||b).keys[w])return this.withEvent(y,x)},paste:function(y){var A,C,x,w,E,S,R,L,T;return k(y)?(y.preventDefault(),this.attachFiles(y.clipboardData.files)):D(y)?(y.preventDefault(),C={type:"text/plain",string:y.clipboardData.getData("text/plain")},null!=(x=(this||b).delegate)&&x.inputControllerWillPaste(C),null!=(w=(this||b).responder)&&w.insertString(C.string),this.render(),null!=(E=(this||b).delegate)?E.inputControllerDidPaste(C):void 0):(A=null!=(S=y.clipboardData)?S.getData("URL"):void 0)?(y.preventDefault(),C={type:"text/html",html:this.createLinkHTML(A)},null!=(R=(this||b).delegate)&&R.inputControllerWillPaste(C),null!=(L=(this||b).responder)&&L.insertHTML(C.html),this.render(),null!=(T=(this||b).delegate)?T.inputControllerDidPaste(C):void 0):void 0},beforeinput:function(y){var A;return(A=(this||b).inputTypes[y.inputType])?(this.withEvent(y,A),this.scheduleRender()):void 0},input:function(){return C.selectionChangeObserver.reset()},dragstart:function(y){var A,C;return(null!=(A=(this||b).responder)?A.selectionContainsAttachments():void 0)?(y.dataTransfer.setData("application/x-trix-dragging",!0),(this||b).dragging={range:null!=(C=(this||b).responder)?C.getSelectedRange():void 0,point:L(y)}):void 0},dragenter:function(y){return S(y)?y.preventDefault():void 0},dragover:function(y){var A,C;if((this||b).dragging){if(y.preventDefault(),A=L(y),!x(A,(this||b).dragging.point))return(this||b).dragging.point=A,null!=(C=(this||b).responder)?C.setLocationRangeFromPointRange(A):void 0}else if(S(y))return y.preventDefault()},drop:function(y){var A,C,x,w;return(this||b).dragging?(y.preventDefault(),null!=(C=(this||b).delegate)&&C.inputControllerWillMoveText(),null!=(x=(this||b).responder)&&x.moveTextFromRange((this||b).dragging.range),(this||b).dragging=null,this.scheduleRender()):S(y)?(y.preventDefault(),A=L(y),null!=(w=(this||b).responder)&&w.setLocationRangeFromPointRange(A),this.attachFiles(y.dataTransfer.files)):void 0},dragend:function(){var y;return(this||b).dragging?(null!=(y=(this||b).responder)&&y.setSelectedRange((this||b).dragging.range),(this||b).dragging=null):void 0},compositionend:function(){return(this||b).composing?((this||b).composing=!1,this.scheduleRender()):void 0}},u.prototype.keys={ArrowLeft:function(){var y,A;return(null!=(y=(this||b).responder)?y.shouldManageMovingCursorInDirection("backward"):void 0)?((this||b).event.preventDefault(),null!=(A=(this||b).responder)?A.moveCursorInDirection("backward"):void 0):void 0},ArrowRight:function(){var y,A;return(null!=(y=(this||b).responder)?y.shouldManageMovingCursorInDirection("forward"):void 0)?((this||b).event.preventDefault(),null!=(A=(this||b).responder)?A.moveCursorInDirection("forward"):void 0):void 0},Backspace:function(){var y,A,C;return(null!=(y=(this||b).responder)?y.shouldManageDeletingInDirection("backward"):void 0)?((this||b).event.preventDefault(),null!=(A=(this||b).delegate)&&A.inputControllerWillPerformTyping(),null!=(C=(this||b).responder)&&C.deleteInDirection("backward"),this.render()):void 0},Tab:function(){var y,A;return(null!=(y=(this||b).responder)?y.canIncreaseNestingLevel():void 0)?((this||b).event.preventDefault(),null!=(A=(this||b).responder)&&A.increaseNestingLevel(),this.render()):void 0},"Tab+Shift":function(){var y,A;return(null!=(y=(this||b).responder)?y.canDecreaseNestingLevel():void 0)?((this||b).event.preventDefault(),null!=(A=(this||b).responder)&&A.decreaseNestingLevel(),this.render()):void 0}},u.prototype.inputTypes={deleteByComposition:function(){return this.deleteInDirection("backward",{recordUndoEntry:!1})},deleteByCut:function(){return this.deleteInDirection("backward")},deleteByDrag:function(){return(this||b).event.preventDefault(),this.withTargetDOMRange((function(){var y;return(this||b).deleteByDragRange=null!=(y=(this||b).responder)?y.getSelectedRange():void 0}))},deleteCompositionText:function(){return this.deleteInDirection("backward",{recordUndoEntry:!1})},deleteContent:function(){return this.deleteInDirection("backward")},deleteContentBackward:function(){return this.deleteInDirection("backward")},deleteContentForward:function(){return this.deleteInDirection("forward")},deleteEntireSoftLine:function(){return this.deleteInDirection("forward")},deleteHardLineBackward:function(){return this.deleteInDirection("backward")},deleteHardLineForward:function(){return this.deleteInDirection("forward")},deleteSoftLineBackward:function(){return this.deleteInDirection("backward")},deleteSoftLineForward:function(){return this.deleteInDirection("forward")},deleteWordBackward:function(){return this.deleteInDirection("backward")},deleteWordForward:function(){return this.deleteInDirection("forward")},formatBackColor:function(){return this.activateAttributeIfSupported("backgroundColor",(this||b).event.data)},formatBold:function(){return this.toggleAttributeIfSupported("bold")},formatFontColor:function(){return this.activateAttributeIfSupported("color",(this||b).event.data)},formatFontName:function(){return this.activateAttributeIfSupported("font",(this||b).event.data)},formatIndent:function(){var y;return(null!=(y=(this||b).responder)?y.canIncreaseNestingLevel():void 0)?this.withTargetDOMRange((function(){var y;return null!=(y=(this||b).responder)?y.increaseNestingLevel():void 0})):void 0},formatItalic:function(){return this.toggleAttributeIfSupported("italic")},formatJustifyCenter:function(){return this.toggleAttributeIfSupported("justifyCenter")},formatJustifyFull:function(){return this.toggleAttributeIfSupported("justifyFull")},formatJustifyLeft:function(){return this.toggleAttributeIfSupported("justifyLeft")},formatJustifyRight:function(){return this.toggleAttributeIfSupported("justifyRight")},formatOutdent:function(){var y;return(null!=(y=(this||b).responder)?y.canDecreaseNestingLevel():void 0)?this.withTargetDOMRange((function(){var y;return null!=(y=(this||b).responder)?y.decreaseNestingLevel():void 0})):void 0},formatRemove:function(){return this.withTargetDOMRange((function(){var y,A,C,x;x=[];for(y in null!=(A=(this||b).responder)?A.getCurrentAttributes():void 0)x.push(null!=(C=(this||b).responder)?C.removeCurrentAttribute(y):void 0);return x}))},formatSetBlockTextDirection:function(){return this.activateAttributeIfSupported("blockDir",(this||b).event.data)},formatSetInlineTextDirection:function(){return this.activateAttributeIfSupported("textDir",(this||b).event.data)},formatStrikeThrough:function(){return this.toggleAttributeIfSupported("strike")},formatSubscript:function(){return this.toggleAttributeIfSupported("sub")},formatSuperscript:function(){return this.toggleAttributeIfSupported("sup")},formatUnderline:function(){return this.toggleAttributeIfSupported("underline")},historyRedo:function(){var y;return null!=(y=(this||b).delegate)?y.inputControllerWillPerformRedo():void 0},historyUndo:function(){var y;return null!=(y=(this||b).delegate)?y.inputControllerWillPerformUndo():void 0},insertCompositionText:function(){return(this||b).composing=!0,this.insertString((this||b).event.data)},insertFromComposition:function(){return(this||b).composing=!1,this.insertString((this||b).event.data)},insertFromDrop:function(){var y,A;return(y=(this||b).deleteByDragRange)?((this||b).deleteByDragRange=null,null!=(A=(this||b).delegate)&&A.inputControllerWillMoveText(),this.withTargetDOMRange((function(){var A;return null!=(A=(this||b).responder)?A.moveTextFromRange(y):void 0}))):void 0},insertFromPaste:function(){var A,x,w,E,S,R,k,D,L,T,O;return A=(this||b).event.dataTransfer,S={dataTransfer:A},(x=A.getData("URL"))?((this||b).event.preventDefault(),S.type="text/html",O=(E=A.getData("public.url-name"))?C.squishBreakableWhitespace(E).trim():x,S.html=this.createLinkHTML(x,O),null!=(R=(this||b).delegate)&&R.inputControllerWillPaste(S),this.withTargetDOMRange((function(){var y;return null!=(y=(this||b).responder)?y.insertHTML(S.html):void 0})),(this||b).afterRender=function(y){return function(){var b;return null!=(b=y.delegate)?b.inputControllerDidPaste(S):void 0}}(this||b)):y(A)?(S.type="text/plain",S.string=A.getData("text/plain"),null!=(k=(this||b).delegate)&&k.inputControllerWillPaste(S),this.withTargetDOMRange((function(){var y;return null!=(y=(this||b).responder)?y.insertString(S.string):void 0})),(this||b).afterRender=function(y){return function(){var b;return null!=(b=y.delegate)?b.inputControllerDidPaste(S):void 0}}(this||b)):(w=A.getData("text/html"))?((this||b).event.preventDefault(),S.type="text/html",S.html=w,null!=(D=(this||b).delegate)&&D.inputControllerWillPaste(S),this.withTargetDOMRange((function(){var y;return null!=(y=(this||b).responder)?y.insertHTML(S.html):void 0})),(this||b).afterRender=function(y){return function(){var b;return null!=(b=y.delegate)?b.inputControllerDidPaste(S):void 0}}(this||b)):(null!=(L=A.files)?L.length:void 0)?(S.type="File",S.file=A.files[0],null!=(T=(this||b).delegate)&&T.inputControllerWillPaste(S),this.withTargetDOMRange((function(){var y;return null!=(y=(this||b).responder)?y.insertFile(S.file):void 0})),(this||b).afterRender=function(y){return function(){var b;return null!=(b=y.delegate)?b.inputControllerDidPaste(S):void 0}}(this||b)):void 0},insertFromYank:function(){return this.insertString((this||b).event.data)},insertLineBreak:function(){return this.insertString("\n")},insertLink:function(){return this.activateAttributeIfSupported("href",(this||b).event.data)},insertOrderedList:function(){return this.toggleAttributeIfSupported("number")},insertParagraph:function(){var y;return null!=(y=(this||b).delegate)&&y.inputControllerWillPerformTyping(),this.withTargetDOMRange((function(){var y;return null!=(y=(this||b).responder)?y.insertLineBreak():void 0}))},insertReplacementText:function(){return this.insertString((this||b).event.dataTransfer.getData("text/plain"),{updatePosition:!1})},insertText:function(){var y,A;return this.insertString(null!=(y=(this||b).event.data)?y:null!=(A=(this||b).event.dataTransfer)?A.getData("text/plain"):void 0)},insertTranspose:function(){return this.insertString((this||b).event.data)},insertUnorderedList:function(){return this.toggleAttributeIfSupported("bullet")}},u.prototype.insertString=function(y,A){var C;return null==y&&(y=""),null!=(C=(this||b).delegate)&&C.inputControllerWillPerformTyping(),this.withTargetDOMRange((function(){var C;return null!=(C=(this||b).responder)?C.insertString(y,A):void 0}))},u.prototype.toggleAttributeIfSupported=function(y){var A;return E.call(C.getAllAttributeNames(),y)>=0?(null!=(A=(this||b).delegate)&&A.inputControllerWillPerformFormatting(y),this.withTargetDOMRange((function(){var A;return null!=(A=(this||b).responder)?A.toggleCurrentAttribute(y):void 0}))):void 0},u.prototype.activateAttributeIfSupported=function(y,A){var x;return E.call(C.getAllAttributeNames(),y)>=0?(null!=(x=(this||b).delegate)&&x.inputControllerWillPerformFormatting(y),this.withTargetDOMRange((function(){var C;return null!=(C=(this||b).responder)?C.setCurrentAttribute(y,A):void 0}))):void 0},u.prototype.deleteInDirection=function(y,A){var C,x,w,E;return w=(null!=A?A:{recordUndoEntry:!0}).recordUndoEntry,w&&null!=(E=(this||b).delegate)&&E.inputControllerWillPerformTyping(),x=function(b){return function(){var A;return null!=(A=b.responder)?A.deleteInDirection(y):void 0}}(this||b),(C=this.getTargetDOMRange({minLength:2}))?this.withTargetDOMRange(C,x):x()},u.prototype.withTargetDOMRange=function(y,A){var x;return"function"==typeof y&&(A=y,y=this.getTargetDOMRange()),y?null!=(x=(this||b).responder)?x.withTargetDOMRange(y,A.bind(this||b)):void 0:(C.selectionChangeObserver.reset(),A.call(this||b))},u.prototype.getTargetDOMRange=function(y){var A,C,x,w;return x=(null!=y?y:{minLength:0}).minLength,(w="function"==typeof(A=(this||b).event).getTargetRanges?A.getTargetRanges():void 0)&&w.length&&(C=T(w[0]),0===x||C.toString().length>=x)?C:void 0},T=function(y){var b;return b=document.createRange(),b.setStart(y.startContainer,y.startOffset),b.setEnd(y.endContainer,y.endOffset),b},u.prototype.withEvent=function(y,A){var C;(this||b).event=y;try{C=A.call(this||b)}finally{(this||b).event=null}return C},S=function(y){var b,A;return E.call(null!=(b=null!=(A=y.dataTransfer)?A.types:void 0)?b:[],"Files")>=0},k=function(y){var b;return(b=y.clipboardData)?E.call(b.types,"Files")>=0&&1===b.types.length&&b.files.length>=1:void 0},D=function(y){var b;return(b=y.clipboardData)?E.call(b.types,"text/plain")>=0&&1===b.types.length:void 0},R=function(y){var b;return b=[],y.altKey&&b.push("alt"),y.shiftKey&&b.push("shift"),b.push(y.key),b},L=function(y){return{x:y.clientX,y:y.clientY}},u}(C.InputController)}.call(this||b),function(){var y,A,x,w,E,S,R,k,c=function(y,b){return function(){return y.apply(b,arguments)}},l=function(y,A){function n(){(this||b).constructor=y}for(var C in A)D.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},D={}.hasOwnProperty;A=C.defer,x=C.handleEvent,S=C.makeElement,k=C.tagName,R=C.config,E=R.lang,y=R.css,w=R.keyNames,C.AttachmentEditorController=function(R){function h(y,A,C,x){(this||b).attachmentPiece=y,(this||b).element=A,(this||b).container=C,(this||b).options=null!=x?x:{},(this||b).didBlurCaption=c((this||b).didBlurCaption,this||b),(this||b).didChangeCaption=c((this||b).didChangeCaption,this||b),(this||b).didInputCaption=c((this||b).didInputCaption,this||b),(this||b).didKeyDownCaption=c((this||b).didKeyDownCaption,this||b),(this||b).didClickActionButton=c((this||b).didClickActionButton,this||b),(this||b).didClickToolbar=c((this||b).didClickToolbar,this||b),(this||b).attachment=(this||b).attachmentPiece.attachment,"a"===k((this||b).element)&&((this||b).element=(this||b).element.firstChild),this.install()}var D;return l(h,R),D=function(y){return function(){var A;return A=y.apply(this||b,arguments),A.do(),null==(this||b).undos&&((this||b).undos=[]),(this||b).undos.push(A.undo)}},h.prototype.install=function(){return this.makeElementMutable(),this.addToolbar(),(this||b).attachment.isPreviewable()?this.installCaptionEditor():void 0},h.prototype.uninstall=function(){var y,A;for(this.savePendingCaption();A=(this||b).undos.pop();)A();return null!=(y=(this||b).delegate)?y.didUninstallAttachmentEditor(this||b):void 0},h.prototype.savePendingCaption=function(){var y,A,C;return null!=(this||b).pendingCaption?(y=(this||b).pendingCaption,(this||b).pendingCaption=null,y?null!=(A=(this||b).delegate)&&"function"==typeof A.attachmentEditorDidRequestUpdatingAttributesForAttachment?A.attachmentEditorDidRequestUpdatingAttributesForAttachment({caption:y},(this||b).attachment):void 0:null!=(C=(this||b).delegate)&&"function"==typeof C.attachmentEditorDidRequestRemovingAttributeForAttachment?C.attachmentEditorDidRequestRemovingAttributeForAttachment("caption",(this||b).attachment):void 0):void 0},h.prototype.makeElementMutable=D((function(){return{do:function(y){return function(){return y.element.dataset.trixMutable=!0}}(this||b),undo:function(y){return function(){return delete y.element.dataset.trixMutable}}(this||b)}})),h.prototype.addToolbar=D((function(){var A;return A=S({tagName:"div",className:y.attachmentToolbar,data:{trixMutable:!0},childNodes:S({tagName:"div",className:"trix-button-row",childNodes:S({tagName:"span",className:"trix-button-group trix-button-group--actions",childNodes:S({tagName:"button",className:"trix-button trix-button--remove",textContent:E.remove,attributes:{title:E.remove},data:{trixAction:"remove"}})})})}),(this||b).attachment.isPreviewable()&&A.appendChild(S({tagName:"div",className:y.attachmentMetadataContainer,childNodes:S({tagName:"span",className:y.attachmentMetadata,childNodes:[S({tagName:"span",className:y.attachmentName,textContent:(this||b).attachment.getFilename(),attributes:{title:(this||b).attachment.getFilename()}}),S({tagName:"span",className:y.attachmentSize,textContent:(this||b).attachment.getFormattedFilesize()})]})})),x("click",{onElement:A,withCallback:(this||b).didClickToolbar}),x("click",{onElement:A,matchingSelector:"[data-trix-action]",withCallback:(this||b).didClickActionButton}),{do:function(y){return function(){return y.element.appendChild(A)}}(this||b),undo:function(){return function(){return C.removeNode(A)}}()}})),h.prototype.installCaptionEditor=D((function(){var w,R,k,D,L;return D=S({tagName:"textarea",className:y.attachmentCaptionEditor,attributes:{placeholder:E.captionPlaceholder},data:{trixMutable:!0}}),D.value=(this||b).attachmentPiece.getCaption(),L=D.cloneNode(),L.classList.add("trix-autoresize-clone"),L.tabIndex=-1,w=function(){return L.value=D.value,D.style.height=L.scrollHeight+"px"},x("input",{onElement:D,withCallback:w}),x("input",{onElement:D,withCallback:(this||b).didInputCaption}),x("keydown",{onElement:D,withCallback:(this||b).didKeyDownCaption}),x("change",{onElement:D,withCallback:(this||b).didChangeCaption}),x("blur",{onElement:D,withCallback:(this||b).didBlurCaption}),k=(this||b).element.querySelector("figcaption"),R=k.cloneNode(),{do:function(b){return function(){return k.style.display="none",R.appendChild(D),R.appendChild(L),R.classList.add(y.attachmentCaption+"--editing"),k.parentElement.insertBefore(R,k),w(),b.options.editCaption?A((function(){return D.focus()})):void 0}}(this||b),undo:function(){return C.removeNode(R),k.style.display=null}}})),h.prototype.didClickToolbar=function(y){return y.preventDefault(),y.stopPropagation()},h.prototype.didClickActionButton=function(y){var A;switch(y.target.getAttribute("data-trix-action")){case"remove":return null!=(A=(this||b).delegate)?A.attachmentEditorDidRequestRemovalOfAttachment((this||b).attachment):void 0}},h.prototype.didKeyDownCaption=function(y){var A;return"return"===w[y.keyCode]?(y.preventDefault(),this.savePendingCaption(),null!=(A=(this||b).delegate)&&"function"==typeof A.attachmentEditorDidRequestDeselectingAttachment?A.attachmentEditorDidRequestDeselectingAttachment((this||b).attachment):void 0):void 0},h.prototype.didInputCaption=function(y){return(this||b).pendingCaption=y.target.value.replace(/\s/g," ").trim()},h.prototype.didChangeCaption=function(){return this.savePendingCaption()},h.prototype.didBlurCaption=function(){return this.savePendingCaption()},h}(C.BasicObject)}.call(this||b),function(){var y,A,x,o=function(y,A){function n(){(this||b).constructor=y}for(var C in A)w.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},w={}.hasOwnProperty;x=C.makeElement,y=C.config.css,C.AttachmentView=function(w){function s(){s.__super__.constructor.apply(this||b,arguments),(this||b).attachment=(this||b).object,(this||b).attachment.uploadProgressDelegate=this||b,(this||b).attachmentPiece=(this||b).options.piece}var E;return o(s,w),s.attachmentSelector="[data-trix-attachment]",s.prototype.createContentNodes=function(){return[]},s.prototype.createNodes=function(){var A,C,w,S,R,k,D;if(A=S=x({tagName:"figure",className:this.getClassName(),data:this.getData(),editable:!1}),(C=this.getHref())&&(S=x({tagName:"a",editable:!1,attributes:{href:C,tabindex:-1}}),A.appendChild(S)),(this||b).attachment.hasContent())S.innerHTML=(this||b).attachment.getContent();else for(D=this.createContentNodes(),w=0,R=D.length;R>w;w++)k=D[w],S.appendChild(k);return S.appendChild(this.createCaptionElement()),(this||b).attachment.isPending()&&((this||b).progressElement=x({tagName:"progress",attributes:{class:y.attachmentProgress,value:(this||b).attachment.getUploadProgress(),max:100},data:{trixMutable:!0,trixStoreKey:["progressElement",(this||b).attachment.id].join("/")}}),A.appendChild((this||b).progressElement)),[E("left"),A,E("right")]},s.prototype.createCaptionElement=function(){var A,C,w,E,S,R,k;return w=x({tagName:"figcaption",className:y.attachmentCaption}),(A=(this||b).attachmentPiece.getCaption())?(w.classList.add(y.attachmentCaption+"--edited"),w.textContent=A):(C=this.getCaptionConfig(),C.name&&(E=(this||b).attachment.getFilename()),C.size&&(R=(this||b).attachment.getFormattedFilesize()),E&&(S=x({tagName:"span",className:y.attachmentName,textContent:E}),w.appendChild(S)),R&&(E&&w.appendChild(document.createTextNode(" ")),k=x({tagName:"span",className:y.attachmentSize,textContent:R}),w.appendChild(k))),w},s.prototype.getClassName=function(){var A,C;return C=[y.attachment,y.attachment+"--"+(this||b).attachment.getType()],(A=(this||b).attachment.getExtension())&&C.push(y.attachment+"--"+A),C.join(" ")},s.prototype.getData=function(){var y,A;return A={trixAttachment:JSON.stringify((this||b).attachment),trixContentType:(this||b).attachment.getContentType(),trixId:(this||b).attachment.id},y=(this||b).attachmentPiece.attributes,y.isEmpty()||(A.trixAttributes=JSON.stringify(y)),(this||b).attachment.isPending()&&(A.trixSerialize=!1),A},s.prototype.getHref=function(){return A((this||b).attachment.getContent(),"a")?void 0:(this||b).attachment.getHref()},s.prototype.getCaptionConfig=function(){var y,A,x;return x=(this||b).attachment.getType(),y=C.copyObject(null!=(A=C.config.attachments[x])?A.caption:void 0),"file"===x&&(y.name=!0),y},s.prototype.findProgressElement=function(){var y;return null!=(y=this.findElement())?y.querySelector("progress"):void 0},E=function(y){return x({tagName:"span",textContent:C.ZERO_WIDTH_SPACE,data:{trixCursorTarget:y,trixSerialize:!1}})},s.prototype.attachmentDidChangeUploadProgress=function(){var y,A;return A=(this||b).attachment.getUploadProgress(),null!=(y=this.findProgressElement())?y.value=A:void 0},s}(C.ObjectView),A=function(y,b){var A;return A=x("div"),A.innerHTML=null!=y?y:"",A.querySelector(b)}}.call(this||b),function(){var y,n=function(y,C){function n(){(this||b).constructor=y}for(var x in C)A.call(C,x)&&(y[x]=C[x]);return n.prototype=C.prototype,y.prototype=new n,y.__super__=C.prototype,y},A={}.hasOwnProperty;y=C.makeElement,C.PreviewableAttachmentView=function(A){function o(){o.__super__.constructor.apply(this||b,arguments),(this||b).attachment.previewDelegate=this||b}return n(o,A),o.prototype.createContentNodes=function(){return(this||b).image=y({tagName:"img",attributes:{src:""},data:{trixMutable:!0}}),this.refresh((this||b).image),[(this||b).image]},o.prototype.createCaptionElement=function(){var y;return y=o.__super__.createCaptionElement.apply(this||b,arguments),y.textContent||y.setAttribute("data-trix-placeholder",C.config.lang.captionPlaceholder),y},o.prototype.refresh=function(y){var b;return null==y&&(y=null!=(b=this.findElement())?b.querySelector("img"):void 0),y?this.updateAttributesForImage(y):void 0},o.prototype.updateAttributesForImage=function(y){var A,C,x,w,E,S;return E=(this||b).attachment.getURL(),C=(this||b).attachment.getPreviewURL(),y.src=C||E,C===E?y.removeAttribute("data-trix-serialized-attributes"):(x=JSON.stringify({src:E}),y.setAttribute("data-trix-serialized-attributes",x)),S=(this||b).attachment.getWidth(),A=(this||b).attachment.getHeight(),null!=S&&(y.width=S),null!=A&&(y.height=A),w=["imageElement",(this||b).attachment.id,y.src,y.width,y.height].join("/"),y.dataset.trixStoreKey=w},o.prototype.attachmentDidChangeAttributes=function(){return this.refresh((this||b).image),this.refresh()},o}(C.AttachmentView)}.call(this||b),function(){var y,A,x,o=function(y,A){function n(){(this||b).constructor=y}for(var C in A)w.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},w={}.hasOwnProperty;x=C.makeElement,y=C.findInnerElement,A=C.getTextConfig,C.PieceView=function(w){function s(){var y;s.__super__.constructor.apply(this||b,arguments),(this||b).piece=(this||b).object,(this||b).attributes=(this||b).piece.getAttributes(),y=(this||b).options,(this||b).textConfig=y.textConfig,(this||b).context=y.context,(this||b).piece.attachment?(this||b).attachment=(this||b).piece.attachment:(this||b).string=(this||b).piece.toString()}var E;return o(s,w),s.prototype.createNodes=function(){var A,C,x,w,E,S;if(S=(this||b).attachment?this.createAttachmentNodes():this.createStringNodes(),A=this.createElement()){for(x=y(A),C=0,w=S.length;w>C;C++)E=S[C],x.appendChild(E);S=[A]}return S},s.prototype.createAttachmentNodes=function(){var y,A;return y=(this||b).attachment.isPreviewable()?C.PreviewableAttachmentView:C.AttachmentView,A=this.createChildView(y,(this||b).piece.attachment,{piece:(this||b).piece}),A.getNodes()},s.prototype.createStringNodes=function(){var y,A,C,w,E,S,R,k,D;if(null!=(R=(this||b).textConfig)?R.plaintext:void 0)return[document.createTextNode((this||b).string)];for(S=[],k=(this||b).string.split("\n"),C=A=0,w=k.length;w>A;C=++A)D=k[C],C>0&&(y=x("br"),S.push(y)),D.length&&(E=document.createTextNode(this.preserveSpaces(D)),S.push(E));return S},s.prototype.createElement=function(){var y,C,w,E,S,R,k,D,L;D={},R=(this||b).attributes;for(E in R)if(L=R[E],(y=A(E))&&(y.tagName&&(S=x(y.tagName),w?(w.appendChild(S),w=S):C=w=S),y.styleProperty&&(D[y.styleProperty]=L),y.style)){k=y.style;for(E in k)L=k[E],D[E]=L}if(Object.keys(D).length){null==C&&(C=x("span"));for(E in D)L=D[E],C.style[E]=L}return C},s.prototype.createContainerElement=function(){var y,C,w,E,S;E=(this||b).attributes;for(w in E)if(S=E[w],(C=A(w))&&C.groupTagName)return y={},y[w]=S,x(C.groupTagName,y)},E=C.NON_BREAKING_SPACE,s.prototype.preserveSpaces=function(y){return(this||b).context.isLast&&(y=y.replace(/\ $/,E)),y=y.replace(/(\S)\ {3}(\S)/g,"$1 "+E+" $2").replace(/\ {2}/g,E+" ").replace(/\ {2}/g," "+E),((this||b).context.isFirst||(this||b).context.followsWhitespace)&&(y=y.replace(/^\ /,E)),y},s}(C.ObjectView)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.TextView=function(y){function i(){i.__super__.constructor.apply(this||b,arguments),(this||b).text=(this||b).object,(this||b).textConfig=(this||b).options.textConfig}var A;return t(i,y),i.prototype.createNodes=function(){var y,x,w,E,S,R,k,D,L,T;for(R=[],D=C.ObjectGroup.groupObjects(this.getPieces()),E=D.length-1,w=x=0,S=D.length;S>x;w=++x)k=D[w],y={},0===w&&(y.isFirst=!0),w===E&&(y.isLast=!0),A(L)&&(y.followsWhitespace=!0),T=this.findOrCreateCachedChildView(C.PieceView,k,{textConfig:(this||b).textConfig,context:y}),R.push.apply(R,T.getNodes()),L=k;return R},i.prototype.getPieces=function(){var y,A,C,x,w;for(x=(this||b).text.getPieces(),w=[],y=0,A=x.length;A>y;y++)C=x[y],C.hasAttribute("blockBreak")||w.push(C);return w},A=function(y){return/\s$/.test(null!=y?y.toString():void 0)},i}(C.ObjectView)}.call(this||b),function(){var y,A,x,o=function(y,A){function n(){(this||b).constructor=y}for(var C in A)w.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},w={}.hasOwnProperty;x=C.makeElement,A=C.getBlockConfig,y=C.config.css,C.BlockView=function(w){function s(){s.__super__.constructor.apply(this||b,arguments),(this||b).block=(this||b).object,(this||b).attributes=(this||b).block.getAttributes()}return o(s,w),s.prototype.createNodes=function(){var y,w,E,S,R,k,D,L,T,O,N;if(w=document.createComment("block"),D=[w],(this||b).block.isEmpty()?D.push(x("br")):(O=null!=(L=A((this||b).block.getLastAttribute()))?L.text:void 0,N=this.findOrCreateCachedChildView(C.TextView,(this||b).block.text,{textConfig:O}),D.push.apply(D,N.getNodes()),this.shouldAddExtraNewlineElement()&&D.push(x("br"))),(this||b).attributes.length)return D;for(T=C.config.blockAttributes.default.tagName,(this||b).block.isRTL()&&(y={dir:"rtl"}),E=x({tagName:T,attributes:y}),S=0,R=D.length;R>S;S++)k=D[S],E.appendChild(k);return[E]},s.prototype.createContainerElement=function(C){var w,E,S,R,k;return w=(this||b).attributes[C],k=A(w).tagName,0===C&&(this||b).block.isRTL()&&(E={dir:"rtl"}),"attachmentGallery"===w&&(R=(this||b).block.getBlockBreakPosition(),S=y.attachmentGallery+" "+y.attachmentGallery+"--"+R),x({tagName:k,className:S,attributes:E})},s.prototype.shouldAddExtraNewlineElement=function(){return/\n\n$/.test((this||b).block.toString())},s}(C.ObjectView)}.call(this||b),function(){var y,A,i=function(y,A){function n(){(this||b).constructor=y}for(var C in A)x.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},x={}.hasOwnProperty;y=C.defer,A=C.makeElement,C.DocumentView=function(x){function r(){r.__super__.constructor.apply(this||b,arguments),(this||b).element=(this||b).options.element,(this||b).elementStore=new C.ElementStore,this.setDocument((this||b).object)}var w,E,S;return i(r,x),r.render=function(y){var C,x;return C=A("div"),x=new(this||b)(y,{element:C}),x.render(),x.sync(),C},r.prototype.setDocument=function(y){return y.isEqualTo((this||b).document)?void 0:(this||b).document=(this||b).object=y},r.prototype.render=function(){var y,x,w,E,S,R,k;if((this||b).childViews=[],(this||b).shadowElement=A("div"),!(this||b).document.isEmpty()){for(S=C.ObjectGroup.groupObjects((this||b).document.getBlocks(),{asTree:!0}),R=[],y=0,x=S.length;x>y;y++)E=S[y],k=this.findOrCreateCachedChildView(C.BlockView,E),R.push(function(){var y,A,C,x;for(C=k.getNodes(),x=[],y=0,A=C.length;A>y;y++)w=C[y],x.push((this||b).shadowElement.appendChild(w));return x}.call(this||b));return R}},r.prototype.isSynced=function(){return w((this||b).shadowElement,(this||b).element)},r.prototype.sync=function(){var y;for(y=this.createDocumentFragmentForSync();(this||b).element.lastChild;)(this||b).element.removeChild((this||b).element.lastChild);return(this||b).element.appendChild(y),this.didSync()},r.prototype.didSync=function(){return(this||b).elementStore.reset(E((this||b).element)),y(function(y){return function(){return y.garbageCollectCachedViews()}}(this||b))},r.prototype.createDocumentFragmentForSync=function(){var y,A,C,x,w,S,R,k,D,L;for(A=document.createDocumentFragment(),k=(this||b).shadowElement.childNodes,C=0,w=k.length;w>C;C++)R=k[C],A.appendChild(R.cloneNode(!0));for(D=E(A),x=0,S=D.length;S>x;x++)y=D[x],(L=(this||b).elementStore.remove(y))&&y.parentNode.replaceChild(L,y);return A},E=function(y){return y.querySelectorAll("[data-trix-store-key]")},w=function(y,b){return S(y.innerHTML)===S(b.innerHTML)},S=function(y){return y.replace(/&nbsp;/g," ")},r}(C.ObjectView)}.call(this||b),function(){var y,A,x,w,E,s=function(y,b){return function(){return y.apply(b,arguments)}},a=function(y,A){function n(){(this||b).constructor=y}for(var C in A)S.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},S={}.hasOwnProperty;x=C.findClosestElementFromNode,w=C.handleEvent,E=C.innerElementIsActive,A=C.defer,y=C.AttachmentView.attachmentSelector,C.CompositionController=function(S){function c(A,x){(this||b).element=A,(this||b).composition=x,(this||b).didClickAttachment=s((this||b).didClickAttachment,this||b),(this||b).didBlur=s((this||b).didBlur,this||b),(this||b).didFocus=s((this||b).didFocus,this||b),(this||b).documentView=new C.DocumentView((this||b).composition.document,{element:(this||b).element}),w("focus",{onElement:(this||b).element,withCallback:(this||b).didFocus}),w("blur",{onElement:(this||b).element,withCallback:(this||b).didBlur}),w("click",{onElement:(this||b).element,matchingSelector:"a[contenteditable=false]",preventDefault:!0}),w("mousedown",{onElement:(this||b).element,matchingSelector:y,withCallback:(this||b).didClickAttachment}),w("click",{onElement:(this||b).element,matchingSelector:"a"+y,preventDefault:!0})}return a(c,S),c.prototype.didFocus=function(){var y,A,C;return y=function(y){return function(){var b;return y.focused?void 0:(y.focused=!0,null!=(b=y.delegate)&&"function"==typeof b.compositionControllerDidFocus?b.compositionControllerDidFocus():void 0)}}(this||b),null!=(A=null!=(C=(this||b).blurPromise)?C.then(y):void 0)?A:y()},c.prototype.didBlur=function(){return(this||b).blurPromise=new Promise(function(y){return function(b){return A((function(){var A;return E(y.element)||(y.focused=null,null!=(A=y.delegate)&&"function"==typeof A.compositionControllerDidBlur&&A.compositionControllerDidBlur()),y.blurPromise=null,b()}))}}(this||b))},c.prototype.didClickAttachment=function(y,A){var C,w,E;return C=this.findAttachmentForElement(A),w=null!=x(y.target,{matchingSelector:"figcaption"}),null!=(E=(this||b).delegate)&&"function"==typeof E.compositionControllerDidSelectAttachment?E.compositionControllerDidSelectAttachment(C,{editCaption:w}):void 0},c.prototype.getSerializableElement=function(){return this.isEditingAttachment()?(this||b).documentView.shadowElement:(this||b).element},c.prototype.render=function(){var y,A,C;return(this||b).revision!==(this||b).composition.revision&&((this||b).documentView.setDocument((this||b).composition.document),(this||b).documentView.render(),(this||b).revision=(this||b).composition.revision),this.canSyncDocumentView()&&!(this||b).documentView.isSynced()&&(null!=(y=(this||b).delegate)&&"function"==typeof y.compositionControllerWillSyncDocumentView&&y.compositionControllerWillSyncDocumentView(),(this||b).documentView.sync(),null!=(A=(this||b).delegate)&&"function"==typeof A.compositionControllerDidSyncDocumentView&&A.compositionControllerDidSyncDocumentView()),null!=(C=(this||b).delegate)&&"function"==typeof C.compositionControllerDidRender?C.compositionControllerDidRender():void 0},c.prototype.rerenderViewForObject=function(y){return this.invalidateViewForObject(y),this.render()},c.prototype.invalidateViewForObject=function(y){return(this||b).documentView.invalidateViewForObject(y)},c.prototype.isViewCachingEnabled=function(){return(this||b).documentView.isViewCachingEnabled()},c.prototype.enableViewCaching=function(){return(this||b).documentView.enableViewCaching()},c.prototype.disableViewCaching=function(){return(this||b).documentView.disableViewCaching()},c.prototype.refreshViewCache=function(){return(this||b).documentView.garbageCollectCachedViews()},c.prototype.isEditingAttachment=function(){return null!=(this||b).attachmentEditor},c.prototype.installAttachmentEditorForAttachment=function(y,A){var x,w,E;if((null!=(E=(this||b).attachmentEditor)?E.attachment:void 0)!==y&&(w=(this||b).documentView.findElementForObject(y)))return this.uninstallAttachmentEditor(),x=(this||b).composition.document.getAttachmentPieceForAttachment(y),(this||b).attachmentEditor=new C.AttachmentEditorController(x,w,(this||b).element,A),(this||b).attachmentEditor.delegate=this||b},c.prototype.uninstallAttachmentEditor=function(){var y;return null!=(y=(this||b).attachmentEditor)?y.uninstall():void 0},c.prototype.didUninstallAttachmentEditor=function(){return(this||b).attachmentEditor=null,this.render()},c.prototype.attachmentEditorDidRequestUpdatingAttributesForAttachment=function(y,A){var C;return null!=(C=(this||b).delegate)&&"function"==typeof C.compositionControllerWillUpdateAttachment&&C.compositionControllerWillUpdateAttachment(A),(this||b).composition.updateAttributesForAttachment(y,A)},c.prototype.attachmentEditorDidRequestRemovingAttributeForAttachment=function(y,A){var C;return null!=(C=(this||b).delegate)&&"function"==typeof C.compositionControllerWillUpdateAttachment&&C.compositionControllerWillUpdateAttachment(A),(this||b).composition.removeAttributeForAttachment(y,A)},c.prototype.attachmentEditorDidRequestRemovalOfAttachment=function(y){var A;return null!=(A=(this||b).delegate)&&"function"==typeof A.compositionControllerDidRequestRemovalOfAttachment?A.compositionControllerDidRequestRemovalOfAttachment(y):void 0},c.prototype.attachmentEditorDidRequestDeselectingAttachment=function(y){var A;return null!=(A=(this||b).delegate)&&"function"==typeof A.compositionControllerDidRequestDeselectingAttachment?A.compositionControllerDidRequestDeselectingAttachment(y):void 0},c.prototype.canSyncDocumentView=function(){return!this.isEditingAttachment()},c.prototype.findAttachmentForElement=function(y){return(this||b).composition.document.getAttachmentById(parseInt(y.dataset.trixId,10))},c}(C.BasicObject)}.call(this||b),function(){var y,A,x,o=function(y,b){return function(){return y.apply(b,arguments)}},r=function(y,A){function n(){(this||b).constructor=y}for(var C in A)w.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},w={}.hasOwnProperty;A=C.handleEvent,x=C.triggerEvent,y=C.findClosestElementFromNode,C.ToolbarController=function(C){function s(y){(this||b).element=y,(this||b).didKeyDownDialogInput=o((this||b).didKeyDownDialogInput,this||b),(this||b).didClickDialogButton=o((this||b).didClickDialogButton,this||b),(this||b).didClickAttributeButton=o((this||b).didClickAttributeButton,this||b),(this||b).didClickActionButton=o((this||b).didClickActionButton,this||b),(this||b).attributes={},(this||b).actions={},this.resetDialogInputs(),A("mousedown",{onElement:(this||b).element,matchingSelector:w,withCallback:(this||b).didClickActionButton}),A("mousedown",{onElement:(this||b).element,matchingSelector:S,withCallback:(this||b).didClickAttributeButton}),A("click",{onElement:(this||b).element,matchingSelector:P,preventDefault:!0}),A("click",{onElement:(this||b).element,matchingSelector:R,withCallback:(this||b).didClickDialogButton}),A("keydown",{onElement:(this||b).element,matchingSelector:k,withCallback:(this||b).didKeyDownDialogInput})}var w,E,S,R,k,D,L,T,O,N,P;return r(s,C),S="[data-trix-attribute]",w="[data-trix-action]",P=S+", "+w,D="[data-trix-dialog]",E=D+"[data-trix-active]",R=D+" [data-trix-method]",k=D+" [data-trix-input]",s.prototype.didClickActionButton=function(y,A){var C,x,w;return null!=(x=(this||b).delegate)&&x.toolbarDidClickButton(),y.preventDefault(),C=L(A),this.getDialog(C)?this.toggleDialog(C):null!=(w=(this||b).delegate)?w.toolbarDidInvokeAction(C):void 0},s.prototype.didClickAttributeButton=function(y,A){var C,x,w;return null!=(x=(this||b).delegate)&&x.toolbarDidClickButton(),y.preventDefault(),C=T(A),this.getDialog(C)?this.toggleDialog(C):null!=(w=(this||b).delegate)&&w.toolbarDidToggleAttribute(C),this.refreshAttributeButtons()},s.prototype.didClickDialogButton=function(A,C){var x,w;return x=y(C,{matchingSelector:D}),w=C.getAttribute("data-trix-method"),(this||b)[w].call(this||b,x)},s.prototype.didKeyDownDialogInput=function(y,b){var A,C;return 13===y.keyCode&&(y.preventDefault(),A=b.getAttribute("name"),C=this.getDialog(A),this.setAttribute(C)),27===y.keyCode?(y.preventDefault(),this.hideDialog()):void 0},s.prototype.updateActions=function(y){return(this||b).actions=y,this.refreshActionButtons()},s.prototype.refreshActionButtons=function(){return this.eachActionButton(function(y){return function(b,A){return b.disabled=!1===y.actions[A]}}(this||b))},s.prototype.eachActionButton=function(y){var A,C,x,E,S;for(E=(this||b).element.querySelectorAll(w),S=[],C=0,x=E.length;x>C;C++)A=E[C],S.push(y(A,L(A)));return S},s.prototype.updateAttributes=function(y){return(this||b).attributes=y,this.refreshAttributeButtons()},s.prototype.refreshAttributeButtons=function(){return this.eachAttributeButton(function(y){return function(b,A){return b.disabled=!1===y.attributes[A],y.attributes[A]||y.dialogIsVisible(A)?(b.setAttribute("data-trix-active",""),b.classList.add("trix-active")):(b.removeAttribute("data-trix-active"),b.classList.remove("trix-active"))}}(this||b))},s.prototype.eachAttributeButton=function(y){var A,C,x,w,E;for(w=(this||b).element.querySelectorAll(S),E=[],C=0,x=w.length;x>C;C++)A=w[C],E.push(y(A,T(A)));return E},s.prototype.applyKeyboardCommand=function(y){var A,C,w,E,S,R,k;for(S=JSON.stringify(y.sort()),k=(this||b).element.querySelectorAll("[data-trix-key]"),E=0,R=k.length;R>E;E++)if(A=k[E],w=A.getAttribute("data-trix-key").split("+"),C=JSON.stringify(w.sort()),C===S)return x("mousedown",{onElement:A}),!0;return!1},s.prototype.dialogIsVisible=function(y){var b;return(b=this.getDialog(y))?b.hasAttribute("data-trix-active"):void 0},s.prototype.toggleDialog=function(y){return this.dialogIsVisible(y)?this.hideDialog():this.showDialog(y)},s.prototype.showDialog=function(y){var A,C,x,w,E,S,R,k,D,L;for(this.hideDialog(),null!=(R=(this||b).delegate)&&R.toolbarWillShowDialog(),x=this.getDialog(y),x.setAttribute("data-trix-active",""),x.classList.add("trix-active"),k=x.querySelectorAll("input[disabled]"),w=0,S=k.length;S>w;w++)C=k[w],C.removeAttribute("disabled");return(A=T(x))&&(E=N(x,y))&&(E.value=null!=(D=(this||b).attributes[A])?D:"",E.select()),null!=(L=(this||b).delegate)?L.toolbarDidShowDialog(y):void 0},s.prototype.setAttribute=function(y){var A,C,x;return A=T(y),C=N(y,A),C.willValidate&&!C.checkValidity()?(C.setAttribute("data-trix-validate",""),C.classList.add("trix-validate"),C.focus()):(null!=(x=(this||b).delegate)&&x.toolbarDidUpdateAttribute(A,C.value),this.hideDialog())},s.prototype.removeAttribute=function(y){var A,C;return A=T(y),null!=(C=(this||b).delegate)&&C.toolbarDidRemoveAttribute(A),this.hideDialog()},s.prototype.hideDialog=function(){var y,A;return(y=(this||b).element.querySelector(E))?(y.removeAttribute("data-trix-active"),y.classList.remove("trix-active"),this.resetDialogInputs(),null!=(A=(this||b).delegate)?A.toolbarDidHideDialog(O(y)):void 0):void 0},s.prototype.resetDialogInputs=function(){var y,A,C,x,w;for(x=(this||b).element.querySelectorAll(k),w=[],y=0,C=x.length;C>y;y++)A=x[y],A.setAttribute("disabled","disabled"),A.removeAttribute("data-trix-validate"),w.push(A.classList.remove("trix-validate"));return w},s.prototype.getDialog=function(y){return(this||b).element.querySelector("[data-trix-dialog="+y+"]")},N=function(y,b){return null==b&&(b=T(y)),y.querySelector("[data-trix-input][name='"+b+"']")},L=function(y){return y.getAttribute("data-trix-action")},T=function(y){var b;return null!=(b=y.getAttribute("data-trix-attribute"))?b:y.getAttribute("data-trix-dialog-attribute")},O=function(y){return y.getAttribute("data-trix-dialog")},s}(C.BasicObject)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.ImagePreloadOperation=function(y){function n(y){(this||b).url=y}return t(n,y),n.prototype.perform=function(y){var A;return A=new Image,A.onload=function(b){return function(){return A.width=b.width=A.naturalWidth,A.height=b.height=A.naturalHeight,y(!0,A)}}(this||b),A.onerror=function(){return y(!1)},A.src=(this||b).url},n}(C.Operation)}.call(this||b),function(){var t=function(y,b){return function(){return y.apply(b,arguments)}},n=function(A,C){function n(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return n.prototype=C.prototype,A.prototype=new n,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.Attachment=function(y){function o(y){null==y&&(y={}),(this||b).releaseFile=t((this||b).releaseFile,this||b),o.__super__.constructor.apply(this||b,arguments),(this||b).attributes=C.Hash.box(y),this.didChangeAttributes()}return n(o,y),o.previewablePattern=/^image(\/(gif|png|jpe?g)|$)/,o.attachmentForFile=function(y){var A,C;return C=this.attributesForFile(y),A=new(this||b)(C),A.setFile(y),A},o.attributesForFile=function(y){return new C.Hash({filename:y.name,filesize:y.size,contentType:y.type})},o.fromJSON=function(y){return new(this||b)(y)},o.prototype.getAttribute=function(y){return(this||b).attributes.get(y)},o.prototype.hasAttribute=function(y){return(this||b).attributes.has(y)},o.prototype.getAttributes=function(){return(this||b).attributes.toObject()},o.prototype.setAttributes=function(y){var A,C,x;return null==y&&(y={}),A=(this||b).attributes.merge(y),(this||b).attributes.isEqualTo(A)?void 0:((this||b).attributes=A,this.didChangeAttributes(),null!=(C=(this||b).previewDelegate)&&"function"==typeof C.attachmentDidChangeAttributes&&C.attachmentDidChangeAttributes(this||b),null!=(x=(this||b).delegate)&&"function"==typeof x.attachmentDidChangeAttributes?x.attachmentDidChangeAttributes(this||b):void 0)},o.prototype.didChangeAttributes=function(){return this.isPreviewable()?this.preloadURL():void 0},o.prototype.isPending=function(){return null!=(this||b).file&&!(this.getURL()||this.getHref())},o.prototype.isPreviewable=function(){return(this||b).attributes.has("previewable")?(this||b).attributes.get("previewable"):(this||b).constructor.previewablePattern.test(this.getContentType())},o.prototype.getType=function(){return this.hasContent()?"content":this.isPreviewable()?"preview":"file"},o.prototype.getURL=function(){return(this||b).attributes.get("url")},o.prototype.getHref=function(){return(this||b).attributes.get("href")},o.prototype.getFilename=function(){var y;return null!=(y=(this||b).attributes.get("filename"))?y:""},o.prototype.getFilesize=function(){return(this||b).attributes.get("filesize")},o.prototype.getFormattedFilesize=function(){var y;return y=(this||b).attributes.get("filesize"),"number"==typeof y?C.config.fileSize.formatter(y):""},o.prototype.getExtension=function(){var y;return null!=(y=this.getFilename().match(/\.(\w+)$/))?y[1].toLowerCase():void 0},o.prototype.getContentType=function(){return(this||b).attributes.get("contentType")},o.prototype.hasContent=function(){return(this||b).attributes.has("content")},o.prototype.getContent=function(){return(this||b).attributes.get("content")},o.prototype.getWidth=function(){return(this||b).attributes.get("width")},o.prototype.getHeight=function(){return(this||b).attributes.get("height")},o.prototype.getFile=function(){return(this||b).file},o.prototype.setFile=function(y){return(this||b).file=y,this.isPreviewable()?this.preloadFile():void 0},o.prototype.releaseFile=function(){return this.releasePreloadedFile(),(this||b).file=null},o.prototype.getUploadProgress=function(){var y;return null!=(y=(this||b).uploadProgress)?y:0},o.prototype.setUploadProgress=function(y){var A;return(this||b).uploadProgress!==y?((this||b).uploadProgress=y,null!=(A=(this||b).uploadProgressDelegate)&&"function"==typeof A.attachmentDidChangeUploadProgress?A.attachmentDidChangeUploadProgress(this||b):void 0):void 0},o.prototype.toJSON=function(){return this.getAttributes()},o.prototype.getCacheKey=function(){return[o.__super__.getCacheKey.apply(this||b,arguments),(this||b).attributes.getCacheKey(),this.getPreviewURL()].join("/")},o.prototype.getPreviewURL=function(){return(this||b).previewURL||(this||b).preloadingURL},o.prototype.setPreviewURL=function(y){var A,C;return y!==this.getPreviewURL()?((this||b).previewURL=y,null!=(A=(this||b).previewDelegate)&&"function"==typeof A.attachmentDidChangeAttributes&&A.attachmentDidChangeAttributes(this||b),null!=(C=(this||b).delegate)&&"function"==typeof C.attachmentDidChangePreviewURL?C.attachmentDidChangePreviewURL(this||b):void 0):void 0},o.prototype.preloadURL=function(){return this.preload(this.getURL(),(this||b).releaseFile)},o.prototype.preloadFile=function(){return(this||b).file?((this||b).fileObjectURL=URL.createObjectURL((this||b).file),this.preload((this||b).fileObjectURL)):void 0},o.prototype.releasePreloadedFile=function(){return(this||b).fileObjectURL?(URL.revokeObjectURL((this||b).fileObjectURL),(this||b).fileObjectURL=null):void 0},o.prototype.preload=function(y,A){var x;return y&&y!==this.getPreviewURL()?((this||b).preloadingURL=y,x=new C.ImagePreloadOperation(y),x.then(function(b){return function(C){var x,w;return w=C.width,x=C.height,b.getWidth()&&b.getHeight()||b.setAttributes({width:w,height:x}),b.preloadingURL=null,b.setPreviewURL(y),"function"==typeof A?A():void 0}}(this||b)).catch(function(y){return function(){return y.preloadingURL=null,"function"==typeof A?A():void 0}}(this||b))):void 0},o}(C.Object)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.Piece=function(y){function i(y,A){null==A&&(A={}),i.__super__.constructor.apply(this||b,arguments),(this||b).attributes=C.Hash.box(A)}return t(i,y),i.types={},i.registerType=function(y,A){return A.type=y,(this||b).types[y]=A},i.fromJSON=function(y){var A;return(A=(this||b).types[y.type])?A.fromJSON(y):void 0},i.prototype.copyWithAttributes=function(y){return new(this||b).constructor(this.getValue(),y)},i.prototype.copyWithAdditionalAttributes=function(y){return this.copyWithAttributes((this||b).attributes.merge(y))},i.prototype.copyWithoutAttribute=function(y){return this.copyWithAttributes((this||b).attributes.remove(y))},i.prototype.copy=function(){return this.copyWithAttributes((this||b).attributes)},i.prototype.getAttribute=function(y){return(this||b).attributes.get(y)},i.prototype.getAttributesHash=function(){return(this||b).attributes},i.prototype.getAttributes=function(){return(this||b).attributes.toObject()},i.prototype.getCommonAttributes=function(){var y,b,A;return(A=pieceList.getPieceAtIndex(0))?(y=A.attributes,b=y.getKeys(),pieceList.eachPiece((function(A){return b=y.getKeysCommonToHash(A.attributes),y=y.slice(b)})),y.toObject()):{}},i.prototype.hasAttribute=function(y){return(this||b).attributes.has(y)},i.prototype.hasSameStringValueAsPiece=function(y){return null!=y&&this.toString()===y.toString()},i.prototype.hasSameAttributesAsPiece=function(y){return null!=y&&((this||b).attributes===y.attributes||(this||b).attributes.isEqualTo(y.attributes))},i.prototype.isBlockBreak=function(){return!1},i.prototype.isEqualTo=function(y){return i.__super__.isEqualTo.apply(this||b,arguments)||this.hasSameConstructorAs(y)&&this.hasSameStringValueAsPiece(y)&&this.hasSameAttributesAsPiece(y)},i.prototype.isEmpty=function(){return 0===(this||b).length},i.prototype.isSerializable=function(){return!0},i.prototype.toJSON=function(){return{type:(this||b).constructor.type,attributes:this.getAttributes()}},i.prototype.contentsForInspection=function(){return{type:(this||b).constructor.type,attributes:(this||b).attributes.inspect()}},i.prototype.canBeGrouped=function(){return this.hasAttribute("href")},i.prototype.canBeGroupedWith=function(y){return this.getAttribute("href")===y.getAttribute("href")},i.prototype.getLength=function(){return(this||b).length},i.prototype.canBeConsolidatedWith=function(){return!1},i}(C.Object)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.Piece.registerType("attachment",C.AttachmentPiece=function(y){function i(y){(this||b).attachment=y,i.__super__.constructor.apply(this||b,arguments),(this||b).length=1,this.ensureAttachmentExclusivelyHasAttribute("href"),(this||b).attachment.hasContent()||this.removeProhibitedAttributes()}return t(i,y),i.fromJSON=function(y){return new(this||b)(C.Attachment.fromJSON(y.attachment),y.attributes)},i.permittedAttributes=["caption","presentation"],i.prototype.ensureAttachmentExclusivelyHasAttribute=function(y){return this.hasAttribute(y)?((this||b).attachment.hasAttribute(y)||(this||b).attachment.setAttributes((this||b).attributes.slice(y)),(this||b).attributes=(this||b).attributes.remove(y)):void 0},i.prototype.removeProhibitedAttributes=function(){var y;return y=(this||b).attributes.slice((this||b).constructor.permittedAttributes),y.isEqualTo((this||b).attributes)?void 0:(this||b).attributes=y},i.prototype.getValue=function(){return(this||b).attachment},i.prototype.isSerializable=function(){return!(this||b).attachment.isPending()},i.prototype.getCaption=function(){var y;return null!=(y=(this||b).attributes.get("caption"))?y:""},i.prototype.isEqualTo=function(y){var A;return i.__super__.isEqualTo.apply(this||b,arguments)&&(this||b).attachment.id===(null!=y&&null!=(A=y.attachment)?A.id:void 0)},i.prototype.toString=function(){return C.OBJECT_REPLACEMENT_CHARACTER},i.prototype.toJSON=function(){var y;return y=i.__super__.toJSON.apply(this||b,arguments),y.attachment=(this||b).attachment,y},i.prototype.getCacheKey=function(){return[i.__super__.getCacheKey.apply(this||b,arguments),(this||b).attachment.getCacheKey()].join("/")},i.prototype.toConsole=function(){return JSON.stringify(this.toString())},i}(C.Piece))}.call(this||b),function(){var y,n=function(y,C){function n(){(this||b).constructor=y}for(var x in C)A.call(C,x)&&(y[x]=C[x]);return n.prototype=C.prototype,y.prototype=new n,y.__super__=C.prototype,y},A={}.hasOwnProperty;y=C.normalizeNewlines,C.Piece.registerType("string",C.StringPiece=function(A){function i(A){i.__super__.constructor.apply(this||b,arguments),(this||b).string=y(A),(this||b).length=(this||b).string.length}return n(i,A),i.fromJSON=function(y){return new(this||b)(y.string,y.attributes)},i.prototype.getValue=function(){return(this||b).string},i.prototype.toString=function(){return(this||b).string.toString()},i.prototype.isBlockBreak=function(){return"\n"===this.toString()&&!0===this.getAttribute("blockBreak")},i.prototype.toJSON=function(){var y;return y=i.__super__.toJSON.apply(this||b,arguments),y.string=(this||b).string,y},i.prototype.canBeConsolidatedWith=function(y){return null!=y&&this.hasSameConstructorAs(y)&&this.hasSameAttributesAsPiece(y)},i.prototype.consolidateWith=function(y){return new(this||b).constructor(this.toString()+y.toString(),(this||b).attributes)},i.prototype.splitAtOffset=function(y){var A,C;return 0===y?(A=null,C=this||b):y===(this||b).length?(A=this||b,C=null):(A=new(this||b).constructor((this||b).string.slice(0,y),(this||b).attributes),C=new(this||b).constructor((this||b).string.slice(y),(this||b).attributes)),[A,C]},i.prototype.toConsole=function(){var y;return y=(this||b).string,y.length>15&&(y=y.slice(0,14)+"…"),JSON.stringify(y.toString())},i}(C.Piece))}.call(this||b),function(){var y,n=function(y,C){function n(){(this||b).constructor=y}for(var x in C)A.call(C,x)&&(y[x]=C[x]);return n.prototype=C.prototype,y.prototype=new n,y.__super__=C.prototype,y},A={}.hasOwnProperty,x=[].slice;y=C.spliceArray,C.SplittableList=function(A){function i(y){null==y&&(y=[]),i.__super__.constructor.apply(this||b,arguments),(this||b).objects=y.slice(0),(this||b).length=(this||b).objects.length}var C,w,E;return n(i,A),i.box=function(y){return y instanceof(this||b)?y:new(this||b)(y)},i.prototype.indexOf=function(y){return(this||b).objects.indexOf(y)},i.prototype.splice=function(){var A;return A=1<=arguments.length?x.call(arguments,0):[],new(this||b).constructor(y.apply(null,[(this||b).objects].concat(x.call(A))))},i.prototype.eachObject=function(y){var A,C,x,w,E,S;for(E=(this||b).objects,S=[],C=A=0,x=E.length;x>A;C=++A)w=E[C],S.push(y(w,C));return S},i.prototype.insertObjectAtIndex=function(y,b){return this.splice(b,0,y)},i.prototype.insertSplittableListAtIndex=function(y,A){return(this||b).splice.apply(this||b,[A,0].concat(x.call(y.objects)))},i.prototype.insertSplittableListAtPosition=function(y,A){var C,x,w;return w=this.splitObjectAtPosition(A),x=w[0],C=w[1],new(this||b).constructor(x).insertSplittableListAtIndex(y,C)},i.prototype.editObjectAtIndex=function(y,A){return this.replaceObjectAtIndex(A((this||b).objects[y]),y)},i.prototype.replaceObjectAtIndex=function(y,b){return this.splice(b,1,y)},i.prototype.removeObjectAtIndex=function(y){return this.splice(y,1)},i.prototype.getObjectAtIndex=function(y){return(this||b).objects[y]},i.prototype.getSplittableListInRange=function(y){var A,C,x,w;return x=this.splitObjectsAtRange(y),C=x[0],A=x[1],w=x[2],new(this||b).constructor(C.slice(A,w+1))},i.prototype.selectSplittableList=function(y){var A,C;return C=function(){var C,x,w,E;for(w=(this||b).objects,E=[],C=0,x=w.length;x>C;C++)A=w[C],y(A)&&E.push(A);return E}.call(this||b),new(this||b).constructor(C)},i.prototype.removeObjectsInRange=function(y){var A,C,x,w;return x=this.splitObjectsAtRange(y),C=x[0],A=x[1],w=x[2],new(this||b).constructor(C).splice(A,w-A+1)},i.prototype.transformObjectsInRange=function(y,A){var C,x,w,E,S,R,k;return S=this.splitObjectsAtRange(y),E=S[0],x=S[1],R=S[2],k=function(){var y,b,S;for(S=[],C=y=0,b=E.length;b>y;C=++y)w=E[C],S.push(C>=x&&R>=C?A(w):w);return S}(),new(this||b).constructor(k)},i.prototype.splitObjectsAtRange=function(y){var A,x,w,S,R,k;return S=this.splitObjectAtPosition(E(y)),x=S[0],A=S[1],w=S[2],R=new(this||b).constructor(x).splitObjectAtPosition(C(y)+w),x=R[0],k=R[1],[x,A,k-1]},i.prototype.getObjectAtPosition=function(y){var A,C;return C=this.findIndexAndOffsetAtPosition(y),A=C.index,C.offset,(this||b).objects[A]},i.prototype.splitObjectAtPosition=function(y){var A,C,x,w,E,S,R,k,D,L;return S=this.findIndexAndOffsetAtPosition(y),A=S.index,E=S.offset,w=(this||b).objects.slice(0),null!=A?0===E?(D=A,L=0):(x=this.getObjectAtIndex(A),R=x.splitAtOffset(E),C=R[0],k=R[1],w.splice(A,1,C,k),D=A+1,L=C.getLength()-E):(D=w.length,L=0),[w,D,L]},i.prototype.consolidate=function(){var y,A,C,x,w,E;for(x=[],w=(this||b).objects[0],E=(this||b).objects.slice(1),y=0,A=E.length;A>y;y++)C=E[y],("function"==typeof w.canBeConsolidatedWith?w.canBeConsolidatedWith(C):void 0)?w=w.consolidateWith(C):(x.push(w),w=C);return null!=w&&x.push(w),new(this||b).constructor(x)},i.prototype.consolidateFromIndexToIndex=function(y,A){var C,w,E;return w=(this||b).objects.slice(0),E=w.slice(y,A+1),C=new(this||b).constructor(E).consolidate().toArray(),(this||b).splice.apply(this||b,[y,E.length].concat(x.call(C)))},i.prototype.findIndexAndOffsetAtPosition=function(y){var A,C,x,w,E,S,R;for(A=0,R=(this||b).objects,x=C=0,w=R.length;w>C;x=++C){if(S=R[x],E=A+S.getLength(),y>=A&&E>y)return{index:x,offset:y-A};A=E}return{index:null,offset:null}},i.prototype.findPositionAtIndexAndOffset=function(y,A){var C,x,w,E,S,R;for(S=0,R=(this||b).objects,C=x=0,w=R.length;w>x;C=++x)if(E=R[C],y>C)S+=E.getLength();else if(C===y){S+=A;break}return S},i.prototype.getEndPosition=function(){var y,A;return null!=(this||b).endPosition?(this||b).endPosition:(this||b).endPosition=function(){var C,x,w;for(A=0,w=(this||b).objects,C=0,x=w.length;x>C;C++)y=w[C],A+=y.getLength();return A}.call(this||b)},i.prototype.toString=function(){return(this||b).objects.join("")},i.prototype.toArray=function(){return(this||b).objects.slice(0)},i.prototype.toJSON=function(){return this.toArray()},i.prototype.isEqualTo=function(y){return i.__super__.isEqualTo.apply(this||b,arguments)||w((this||b).objects,null!=y?y.objects:void 0)},w=function(y,b){var A,C,x,w,E;if(null==b&&(b=[]),y.length!==b.length)return!1;for(E=!0,C=A=0,x=y.length;x>A;C=++A)w=y[C],E&&!w.isEqualTo(b[C])&&(E=!1);return E},i.prototype.contentsForInspection=function(){var y;return{objects:"["+function(){var A,C,x,w;for(x=(this||b).objects,w=[],A=0,C=x.length;C>A;A++)y=x[A],w.push(y.inspect());return w}.call(this||b).join(", ")+"]"}},E=function(y){return y[0]},C=function(y){return y[1]},i}(C.Object)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.Text=function(y){function i(y){var A;null==y&&(y=[]),i.__super__.constructor.apply(this||b,arguments),(this||b).pieceList=new C.SplittableList(function(){var b,C,x;for(x=[],b=0,C=y.length;C>b;b++)A=y[b],A.isEmpty()||x.push(A);return x}())}return t(i,y),i.textForAttachmentWithAttributes=function(y,A){var x;return x=new C.AttachmentPiece(y,A),new(this||b)([x])},i.textForStringWithAttributes=function(y,A){var x;return x=new C.StringPiece(y,A),new(this||b)([x])},i.fromJSON=function(y){var A,x;return x=function(){var b,x,w;for(w=[],b=0,x=y.length;x>b;b++)A=y[b],w.push(C.Piece.fromJSON(A));return w}(),new(this||b)(x)},i.prototype.copy=function(){return this.copyWithPieceList((this||b).pieceList)},i.prototype.copyWithPieceList=function(y){return new(this||b).constructor(y.consolidate().toArray())},i.prototype.copyUsingObjectMap=function(y){var A,C;return C=function(){var b,C,x,w,E;for(x=this.getPieces(),E=[],b=0,C=x.length;C>b;b++)A=x[b],E.push(null!=(w=y.find(A))?w:A);return E}.call(this||b),new(this||b).constructor(C)},i.prototype.appendText=function(y){return this.insertTextAtPosition(y,this.getLength())},i.prototype.insertTextAtPosition=function(y,A){return this.copyWithPieceList((this||b).pieceList.insertSplittableListAtPosition(y.pieceList,A))},i.prototype.removeTextAtRange=function(y){return this.copyWithPieceList((this||b).pieceList.removeObjectsInRange(y))},i.prototype.replaceTextAtRange=function(y,b){return this.removeTextAtRange(b).insertTextAtPosition(y,b[0])},i.prototype.moveTextFromRangeToPosition=function(y,b){var A,C;if(!(y[0]<=b&&b<=y[1]))return C=this.getTextAtRange(y),A=C.getLength(),y[0]<b&&(b-=A),this.removeTextAtRange(y).insertTextAtPosition(C,b)},i.prototype.addAttributeAtRange=function(y,b,A){var C;return C={},C[y]=b,this.addAttributesAtRange(C,A)},i.prototype.addAttributesAtRange=function(y,A){return this.copyWithPieceList((this||b).pieceList.transformObjectsInRange(A,(function(b){return b.copyWithAdditionalAttributes(y)})))},i.prototype.removeAttributeAtRange=function(y,A){return this.copyWithPieceList((this||b).pieceList.transformObjectsInRange(A,(function(b){return b.copyWithoutAttribute(y)})))},i.prototype.setAttributesAtRange=function(y,A){return this.copyWithPieceList((this||b).pieceList.transformObjectsInRange(A,(function(b){return b.copyWithAttributes(y)})))},i.prototype.getAttributesAtPosition=function(y){var A,C;return null!=(A=null!=(C=(this||b).pieceList.getObjectAtPosition(y))?C.getAttributes():void 0)?A:{}},i.prototype.getCommonAttributes=function(){var y,A;return y=function(){var y,C,x,w;for(x=(this||b).pieceList.toArray(),w=[],y=0,C=x.length;C>y;y++)A=x[y],w.push(A.getAttributes());return w}.call(this||b),C.Hash.fromCommonAttributesOfObjects(y).toObject()},i.prototype.getCommonAttributesAtRange=function(y){var b;return null!=(b=this.getTextAtRange(y).getCommonAttributes())?b:{}},i.prototype.getExpandedRangeForAttributeAtOffset=function(y,b){var A,C,x;for(A=x=b,C=this.getLength();A>0&&this.getCommonAttributesAtRange([A-1,x])[y];)A--;for(;C>x&&this.getCommonAttributesAtRange([b,x+1])[y];)x++;return[A,x]},i.prototype.getTextAtRange=function(y){return this.copyWithPieceList((this||b).pieceList.getSplittableListInRange(y))},i.prototype.getStringAtRange=function(y){return(this||b).pieceList.getSplittableListInRange(y).toString()},i.prototype.getStringAtPosition=function(y){return this.getStringAtRange([y,y+1])},i.prototype.startsWithString=function(y){return this.getStringAtRange([0,y.length])===y},i.prototype.endsWithString=function(y){var b;return b=this.getLength(),this.getStringAtRange([b-y.length,b])===y},i.prototype.getAttachmentPieces=function(){var y,A,C,x,w;for(x=(this||b).pieceList.toArray(),w=[],y=0,A=x.length;A>y;y++)C=x[y],null!=C.attachment&&w.push(C);return w},i.prototype.getAttachments=function(){var y,b,A,C,x;for(C=this.getAttachmentPieces(),x=[],y=0,b=C.length;b>y;y++)A=C[y],x.push(A.attachment);return x},i.prototype.getAttachmentAndPositionById=function(y){var A,C,x,w,E,S;for(w=0,E=(this||b).pieceList.toArray(),A=0,C=E.length;C>A;A++){if(x=E[A],(null!=(S=x.attachment)?S.id:void 0)===y)return{attachment:x.attachment,position:w};w+=x.length}return{attachment:null,position:null}},i.prototype.getAttachmentById=function(y){var b,A;return A=this.getAttachmentAndPositionById(y),b=A.attachment,A.position,b},i.prototype.getRangeOfAttachment=function(y){var b,A;return A=this.getAttachmentAndPositionById(y.id),y=A.attachment,b=A.position,null!=y?[b,b+1]:void 0},i.prototype.updateAttributesForAttachment=function(y,A){var C;return(C=this.getRangeOfAttachment(A))?this.addAttributesAtRange(y,C):this||b},i.prototype.getLength=function(){return(this||b).pieceList.getEndPosition()},i.prototype.isEmpty=function(){return 0===this.getLength()},i.prototype.isEqualTo=function(y){var A;return i.__super__.isEqualTo.apply(this||b,arguments)||(null!=y&&null!=(A=y.pieceList)?A.isEqualTo((this||b).pieceList):void 0)},i.prototype.isBlockBreak=function(){return 1===this.getLength()&&(this||b).pieceList.getObjectAtIndex(0).isBlockBreak()},i.prototype.eachPiece=function(y){return(this||b).pieceList.eachObject(y)},i.prototype.getPieces=function(){return(this||b).pieceList.toArray()},i.prototype.getPieceAtPosition=function(y){return(this||b).pieceList.getObjectAtPosition(y)},i.prototype.contentsForInspection=function(){return{pieceList:(this||b).pieceList.inspect()}},i.prototype.toSerializableText=function(){var y;return y=(this||b).pieceList.selectSplittableList((function(y){return y.isSerializable()})),this.copyWithPieceList(y)},i.prototype.toString=function(){return(this||b).pieceList.toString()},i.prototype.toJSON=function(){return(this||b).pieceList.toJSON()},i.prototype.toConsole=function(){var y;return JSON.stringify(function(){var A,C,x,w;for(x=(this||b).pieceList.toArray(),w=[],A=0,C=x.length;C>A;A++)y=x[A],w.push(JSON.parse(y.toConsole()));return w}.call(this||b))},i.prototype.getDirection=function(){return C.getDirection(this.toString())},i.prototype.isRTL=function(){return"rtl"===this.getDirection()},i}(C.Object)}.call(this||b),function(){var y,A,x,w,s=function(y,A){function n(){(this||b).constructor=y}for(var C in A)E.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},E={}.hasOwnProperty,S=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1},R=[].slice;y=C.arraysAreEqual,w=C.spliceArray,A=C.getBlockConfig,C.getBlockAttributeNames,x=C.getListAttributeNames,C.Block=function(E){function a(y,A){null==y&&(y=new C.Text),null==A&&(A=[]),a.__super__.constructor.apply(this||b,arguments),(this||b).text=D(y),(this||b).attributes=A}var k,D,L,T,O,N,P,I,_;return s(a,E),a.fromJSON=function(y){var A;return A=C.Text.fromJSON(y.text),new(this||b)(A,y.attributes)},a.prototype.isEmpty=function(){return(this||b).text.isBlockBreak()},a.prototype.isEqualTo=function(A){return a.__super__.isEqualTo.apply(this||b,arguments)||(this||b).text.isEqualTo(null!=A?A.text:void 0)&&y((this||b).attributes,null!=A?A.attributes:void 0)},a.prototype.copyWithText=function(y){return new(this||b).constructor(y,(this||b).attributes)},a.prototype.copyWithoutText=function(){return this.copyWithText(null)},a.prototype.copyWithAttributes=function(y){return new(this||b).constructor((this||b).text,y)},a.prototype.copyWithoutAttributes=function(){return this.copyWithAttributes(null)},a.prototype.copyUsingObjectMap=function(y){var A;return this.copyWithText((A=y.find((this||b).text))?A:(this||b).text.copyUsingObjectMap(y))},a.prototype.addAttribute=function(y){var A;return A=(this||b).attributes.concat(T(y)),this.copyWithAttributes(A)},a.prototype.removeAttribute=function(y){var C,x;return x=A(y).listAttribute,C=N(N((this||b).attributes,y),x),this.copyWithAttributes(C)},a.prototype.removeLastAttribute=function(){return this.removeAttribute(this.getLastAttribute())},a.prototype.getLastAttribute=function(){return O((this||b).attributes)},a.prototype.getAttributes=function(){return(this||b).attributes.slice(0)},a.prototype.getAttributeLevel=function(){return(this||b).attributes.length},a.prototype.getAttributeAtLevel=function(y){return(this||b).attributes[y-1]},a.prototype.hasAttribute=function(y){return S.call((this||b).attributes,y)>=0},a.prototype.hasAttributes=function(){return this.getAttributeLevel()>0},a.prototype.getLastNestableAttribute=function(){return O(this.getNestableAttributes())},a.prototype.getNestableAttributes=function(){var y,C,x,w,E;for(w=(this||b).attributes,E=[],C=0,x=w.length;x>C;C++)y=w[C],A(y).nestable&&E.push(y);return E},a.prototype.getNestingLevel=function(){return this.getNestableAttributes().length},a.prototype.decreaseNestingLevel=function(){var y;return(y=this.getLastNestableAttribute())?this.removeAttribute(y):this||b},a.prototype.increaseNestingLevel=function(){var y,A,C;return(y=this.getLastNestableAttribute())?(C=(this||b).attributes.lastIndexOf(y),A=w.apply(null,[(this||b).attributes,C+1,0].concat(R.call(T(y)))),this.copyWithAttributes(A)):this||b},a.prototype.getListItemAttributes=function(){var y,C,x,w,E;for(w=(this||b).attributes,E=[],C=0,x=w.length;x>C;C++)y=w[C],A(y).listAttribute&&E.push(y);return E},a.prototype.isListItem=function(){var y;return null!=(y=A(this.getLastAttribute()))?y.listAttribute:void 0},a.prototype.isTerminalBlock=function(){var y;return null!=(y=A(this.getLastAttribute()))?y.terminal:void 0},a.prototype.breaksOnReturn=function(){var y;return null!=(y=A(this.getLastAttribute()))?y.breakOnReturn:void 0},a.prototype.findLineBreakInDirectionFromPosition=function(y,b){var A,C;return C=this.toString(),A=function(){switch(y){case"forward":return C.indexOf("\n",b);case"backward":return C.slice(0,b).lastIndexOf("\n")}}(),-1!==A?A:void 0},a.prototype.contentsForInspection=function(){return{text:(this||b).text.inspect(),attributes:(this||b).attributes}},a.prototype.toString=function(){return(this||b).text.toString()},a.prototype.toJSON=function(){return{text:(this||b).text,attributes:(this||b).attributes}},a.prototype.getDirection=function(){return(this||b).text.getDirection()},a.prototype.isRTL=function(){return(this||b).text.isRTL()},a.prototype.getLength=function(){return(this||b).text.getLength()},a.prototype.canBeConsolidatedWith=function(y){return!this.hasAttributes()&&!y.hasAttributes()&&this.getDirection()===y.getDirection()},a.prototype.consolidateWith=function(y){var b,A;return b=C.Text.textForStringWithAttributes("\n"),A=this.getTextWithoutBlockBreak().appendText(b),this.copyWithText(A.appendText(y.text))},a.prototype.splitAtOffset=function(y){var A,C;return 0===y?(A=null,C=this||b):y===this.getLength()?(A=this||b,C=null):(A=this.copyWithText((this||b).text.getTextAtRange([0,y])),C=this.copyWithText((this||b).text.getTextAtRange([y,this.getLength()]))),[A,C]},a.prototype.getBlockBreakPosition=function(){return(this||b).text.getLength()-1},a.prototype.getTextWithoutBlockBreak=function(){return P((this||b).text)?(this||b).text.getTextAtRange([0,this.getBlockBreakPosition()]):(this||b).text.copy()},a.prototype.canBeGrouped=function(y){return(this||b).attributes[y]},a.prototype.canBeGroupedWith=function(y,C){var w,E,R,k;return R=y.getAttributes(),E=R[C],w=(this||b).attributes[C],!(w!==E||!1===A(w).group&&(k=R[C+1],S.call(x(),k)<0)||this.getDirection()!==y.getDirection()&&!y.isEmpty())},D=function(y){return y=_(y),k(y)},_=function(y){var b,A,x,w,E,S;return w=!1,S=y.getPieces(),A=2<=S.length?R.call(S,0,b=S.length-1):(b=0,[]),x=S[b++],null==x?y:(A=function(){var y,b,C;for(C=[],y=0,b=A.length;b>y;y++)E=A[y],E.isBlockBreak()?(w=!0,C.push(I(E))):C.push(E);return C}(),w?new C.Text(R.call(A).concat([x])):y)},L=C.Text.textForStringWithAttributes("\n",{blockBreak:!0}),k=function(y){return P(y)?y:y.appendText(L)},P=function(y){var b,A;return A=y.getLength(),0!==A&&(b=y.getTextAtRange([A-1,A]),b.isBlockBreak())},I=function(y){return y.copyWithoutAttribute("blockBreak")},T=function(y){var b;return b=A(y).listAttribute,null!=b?[b,y]:[y]},O=function(y){return y.slice(-1)[0]},N=function(y,b){var A;return A=y.lastIndexOf(b),-1===A?y:w(y,A,1)},a}(C.Object)}.call(this||b),function(){var y,A,x,o=function(y,A){function n(){(this||b).constructor=y}for(var C in A)w.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},w={}.hasOwnProperty,E=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1},S=[].slice;A=C.tagName,x=C.walkTree,y=C.nodeIsAttachmentElement,C.HTMLSanitizer=function(w){function u(y,A){var C;C=null!=A?A:{},(this||b).allowedAttributes=C.allowedAttributes,(this||b).forbiddenProtocols=C.forbiddenProtocols,(this||b).forbiddenElements=C.forbiddenElements,null==(this||b).allowedAttributes&&((this||b).allowedAttributes=R),null==(this||b).forbiddenProtocols&&((this||b).forbiddenProtocols=D),null==(this||b).forbiddenElements&&((this||b).forbiddenElements=k),(this||b).body=L(y)}var R,k,D,L;return o(u,w),R="style href src width height class".split(" "),D="javascript:".split(" "),k="script iframe".split(" "),u.sanitize=function(y,A){var C;return C=new(this||b)(y,A),C.sanitize(),C},u.prototype.sanitize=function(){return this.sanitizeElements(),this.normalizeListElementNesting()},u.prototype.getHTML=function(){return(this||b).body.innerHTML},u.prototype.getBody=function(){return(this||b).body},u.prototype.sanitizeElements=function(){var y,A,w,E,S;for(S=x((this||b).body),E=[];S.nextNode();)switch(w=S.currentNode,w.nodeType){case Node.ELEMENT_NODE:this.elementIsRemovable(w)?E.push(w):this.sanitizeElement(w);break;case Node.COMMENT_NODE:E.push(w)}for(y=0,A=E.length;A>y;y++)w=E[y],C.removeNode(w);return(this||b).body},u.prototype.sanitizeElement=function(y){var A,C,x,w,R;for(y.hasAttribute("href")&&(w=y.protocol,E.call((this||b).forbiddenProtocols,w)>=0&&y.removeAttribute("href")),R=S.call(y.attributes),A=0,C=R.length;C>A;A++)x=R[A].name,E.call((this||b).allowedAttributes,x)>=0||0===x.indexOf("data-trix")||y.removeAttribute(x);return y},u.prototype.normalizeListElementNesting=function(){var y,C,x,w,E;for(E=S.call((this||b).body.querySelectorAll("ul,ol")),y=0,C=E.length;C>y;y++)x=E[y],(w=x.previousElementSibling)&&"li"===A(w)&&w.appendChild(x);return(this||b).body},u.prototype.elementIsRemovable=function(y){return(null!=y?y.nodeType:void 0)===Node.ELEMENT_NODE?this.elementIsForbidden(y)||this.elementIsntSerializable(y):void 0},u.prototype.elementIsForbidden=function(y){var C;return C=A(y),E.call((this||b).forbiddenElements,C)>=0},u.prototype.elementIsntSerializable=function(b){return"false"===b.getAttribute("data-trix-serialize")&&!y(b)},L=function(y){var b,A,C,x,w;for(null==y&&(y=""),y=y.replace(/<\/html[^>]*>[^]*$/i,"</html>"),b=document.implementation.createHTMLDocument(""),b.documentElement.innerHTML=y,w=b.head.querySelectorAll("style"),C=0,x=w.length;x>C;C++)A=w[C],b.body.appendChild(A);return b.body},u}(C.BasicObject)}.call(this||b),function(){var y,A,x,w,E,S,R,k,D,L,T,p=function(y,A){function n(){(this||b).constructor=y}for(var C in A)O.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},O={}.hasOwnProperty,N=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};y=C.arraysAreEqual,S=C.makeElement,L=C.tagName,E=C.getBlockTagNames,T=C.walkTree,w=C.findClosestElementFromNode,x=C.elementContainsNode,R=C.nodeIsAttachmentElement,k=C.normalizeSpaces,A=C.breakableWhitespacePattern,D=C.squishBreakableWhitespace,C.HTMLParser=function(O){function g(y,A){(this||b).html=y,(this||b).referenceElement=(null!=A?A:{}).referenceElement,(this||b).blocks=[],(this||b).blockElements=[],(this||b).processedElements=[]}var P,I,_,B,F,M,j,W,q,V,U,H;return p(g,O),g.parse=function(y,A){var C;return C=new(this||b)(y,A),C.parse(),C},g.prototype.getDocument=function(){return C.Document.fromJSON((this||b).blocks)},g.prototype.parse=function(){var y,A;try{for(this.createHiddenContainer(),y=C.HTMLSanitizer.sanitize((this||b).html).getHTML(),(this||b).containerElement.innerHTML=y,A=T((this||b).containerElement,{usingFilter:j});A.nextNode();)this.processNode(A.currentNode);return this.translateBlockElementMarginsToNewlines()}finally{this.removeHiddenContainer()}},g.prototype.createHiddenContainer=function(){return(this||b).referenceElement?((this||b).containerElement=(this||b).referenceElement.cloneNode(!1),(this||b).containerElement.removeAttribute("id"),(this||b).containerElement.setAttribute("data-trix-internal",""),(this||b).containerElement.style.display="none",(this||b).referenceElement.parentNode.insertBefore((this||b).containerElement,(this||b).referenceElement.nextSibling)):((this||b).containerElement=S({tagName:"div",style:{display:"none"}}),document.body.appendChild((this||b).containerElement))},g.prototype.removeHiddenContainer=function(){return C.removeNode((this||b).containerElement)},j=function(y){return"style"===L(y)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},g.prototype.processNode=function(y){switch(y.nodeType){case Node.TEXT_NODE:if(!this.isInsignificantTextNode(y))return this.appendBlockForTextNode(y),this.processTextNode(y);break;case Node.ELEMENT_NODE:return this.appendBlockForElement(y),this.processElement(y)}},g.prototype.appendBlockForTextNode=function(A){var C,x,w;return x=A.parentNode,x===(this||b).currentBlockElement&&this.isBlockElement(A.previousSibling)?this.appendStringWithAttributes("\n"):x!==(this||b).containerElement&&!this.isBlockElement(x)||(C=this.getBlockAttributes(x),y(C,null!=(w=(this||b).currentBlock)?w.attributes:void 0))?void 0:((this||b).currentBlock=this.appendBlockForAttributesWithElement(C,x),(this||b).currentBlockElement=x)},g.prototype.appendBlockForElement=function(A){var C,w,E,S;if(E=this.isBlockElement(A),w=x((this||b).currentBlockElement,A),E&&!this.isBlockElement(A.firstChild)){if((!this.isInsignificantTextNode(A.firstChild)||!this.isBlockElement(A.firstElementChild))&&(C=this.getBlockAttributes(A),A.firstChild))return w&&y(C,(this||b).currentBlock.attributes)?this.appendStringWithAttributes("\n"):((this||b).currentBlock=this.appendBlockForAttributesWithElement(C,A),(this||b).currentBlockElement=A)}else if((this||b).currentBlockElement&&!w&&!E)return(S=this.findParentBlockElement(A))?this.appendBlockForElement(S):((this||b).currentBlock=this.appendEmptyBlock(),(this||b).currentBlockElement=null)},g.prototype.findParentBlockElement=function(y){var A;for(A=y.parentElement;A&&A!==(this||b).containerElement;){if(this.isBlockElement(A)&&N.call((this||b).blockElements,A)>=0)return A;A=A.parentElement}return null},g.prototype.processTextNode=function(y){var b,A;return A=y.data,I(y.parentNode)||(A=D(A),U(null!=(b=y.previousSibling)?b.textContent:void 0)&&(A=F(A))),this.appendStringWithAttributes(A,this.getTextAttributes(y.parentNode))},g.prototype.processElement=function(y){var A,C,x,w,E;if(R(y))return A=W(y,"attachment"),Object.keys(A).length&&(w=this.getTextAttributes(y),this.appendAttachmentWithAttributes(A,w),y.innerHTML=""),(this||b).processedElements.push(y);switch(L(y)){case"br":return this.isExtraBR(y)||this.isBlockElement(y.nextSibling)||this.appendStringWithAttributes("\n",this.getTextAttributes(y)),(this||b).processedElements.push(y);case"img":A={url:y.getAttribute("src"),contentType:"image"},x=B(y);for(C in x)E=x[C],A[C]=E;return this.appendAttachmentWithAttributes(A,this.getTextAttributes(y)),(this||b).processedElements.push(y);case"tr":if(y.parentNode.firstChild!==y)return this.appendStringWithAttributes("\n");break;case"td":if(y.parentNode.firstChild!==y)return this.appendStringWithAttributes(" | ")}},g.prototype.appendBlockForAttributesWithElement=function(y,A){var C;return(this||b).blockElements.push(A),C=P(y),(this||b).blocks.push(C),C},g.prototype.appendEmptyBlock=function(){return this.appendBlockForAttributesWithElement([],null)},g.prototype.appendStringWithAttributes=function(y,b){return this.appendPiece(V(y,b))},g.prototype.appendAttachmentWithAttributes=function(y,b){return this.appendPiece(q(y,b))},g.prototype.appendPiece=function(y){return 0===(this||b).blocks.length&&this.appendEmptyBlock(),(this||b).blocks[(this||b).blocks.length-1].text.push(y)},g.prototype.appendStringToTextAtIndex=function(y,A){var C,x;return x=(this||b).blocks[A].text,C=x[x.length-1],"string"===(null!=C?C.type:void 0)?C.string+=y:x.push(V(y))},g.prototype.prependStringToTextAtIndex=function(y,A){var C,x;return x=(this||b).blocks[A].text,C=x[0],"string"===(null!=C?C.type:void 0)?C.string=y+C.string:x.unshift(V(y))},V=function(y,b){var A;return null==b&&(b={}),A="string",y=k(y),{string:y,attributes:b,type:A}},q=function(y,b){var A;return null==b&&(b={}),A="attachment",{attachment:y,attributes:b,type:A}},P=function(y){var b;return null==y&&(y={}),b=[],{text:b,attributes:y}},g.prototype.getTextAttributes=function(y){var A,x,E,S,k,D,L,T,O,N,P,I;E={},O=C.config.textAttributes;for(A in O)if(k=O[A],k.tagName&&w(y,{matchingSelector:k.tagName,untilNode:(this||b).containerElement}))E[A]=!0;else if(k.parser){if(I=k.parser(y)){for(x=!1,N=this.findBlockElementAncestors(y),D=0,T=N.length;T>D;D++)if(S=N[D],k.parser(S)===I){x=!0;break}x||(E[A]=I)}}else k.styleProperty&&(I=y.style[k.styleProperty])&&(E[A]=I);if(R(y)){P=W(y,"attributes");for(L in P)I=P[L],E[L]=I}return E},g.prototype.getBlockAttributes=function(y){var A,x,w,E;for(x=[];y&&y!==(this||b).containerElement;){E=C.config.blockAttributes;for(A in E)w=E[A],!1!==w.parse&&L(y)===w.tagName&&(("function"==typeof w.test?w.test(y):void 0)||!w.test)&&(x.push(A),w.listAttribute&&x.push(w.listAttribute));y=y.parentNode}return x.reverse()},g.prototype.findBlockElementAncestors=function(y){var A,C;for(A=[];y&&y!==(this||b).containerElement;)C=L(y),N.call(E(),C)>=0&&A.push(y),y=y.parentNode;return A},W=function(y,b){try{return JSON.parse(y.getAttribute("data-trix-"+b))}catch(y){return{}}},B=function(y){var b,A,C;return C=y.getAttribute("width"),A=y.getAttribute("height"),b={},C&&(b.width=parseInt(C,10)),A&&(b.height=parseInt(A,10)),b},g.prototype.isBlockElement=function(y){var A;if((null!=y?y.nodeType:void 0)===Node.ELEMENT_NODE&&!R(y)&&!w(y,{matchingSelector:"td",untilNode:(this||b).containerElement}))return A=L(y),N.call(E(),A)>=0||"block"===window.getComputedStyle(y).display},g.prototype.isInsignificantTextNode=function(y){var b,A,C;if((null!=y?y.nodeType:void 0)===Node.TEXT_NODE&&H(y.data)&&(A=y.parentNode,C=y.previousSibling,b=y.nextSibling,(!M(A.previousSibling)||this.isBlockElement(A.previousSibling))&&!I(A)))return!C||this.isBlockElement(C)||!b||this.isBlockElement(b)},g.prototype.isExtraBR=function(y){return"br"===L(y)&&this.isBlockElement(y.parentNode)&&y.parentNode.lastChild===y},I=function(y){var b;return b=window.getComputedStyle(y).whiteSpace,"pre"===b||"pre-wrap"===b||"pre-line"===b},M=function(y){return y&&!U(y.textContent)},g.prototype.translateBlockElementMarginsToNewlines=function(){var y,A,C,x,w,E,S;for(y=this.getMarginOfDefaultBlockElement(),E=(this||b).blocks,S=[],C=A=0,x=E.length;x>A;C=++A)E[C],(w=this.getMarginOfBlockElementAtIndex(C))&&(w.top>2*y.top&&this.prependStringToTextAtIndex("\n",C),S.push(w.bottom>2*y.bottom?this.appendStringToTextAtIndex("\n",C):void 0));return S},g.prototype.getMarginOfBlockElementAtIndex=function(y){var A,C;return!(A=(this||b).blockElements[y])||!A.textContent||(C=L(A),N.call(E(),C)>=0||N.call((this||b).processedElements,A)>=0)?void 0:_(A)},g.prototype.getMarginOfDefaultBlockElement=function(){var y;return y=S(C.config.blockAttributes.default.tagName),(this||b).containerElement.appendChild(y),_(y)},_=function(y){var b;return b=window.getComputedStyle(y),"block"===b.display?{top:parseInt(b.marginTop),bottom:parseInt(b.marginBottom)}:void 0},F=function(y){return y.replace(RegExp("^"+A.source+"+"),"")},H=function(y){return RegExp("^"+A.source+"*$").test(y)},U=function(y){return/\s$/.test(y)},g}(C.BasicObject)}.call(this||b),function(){var y,A,x,w,r=function(y,A){function n(){(this||b).constructor=y}for(var C in A)E.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},E={}.hasOwnProperty,S=[].slice,R=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};y=C.arraysAreEqual,x=C.normalizeRange,w=C.rangeIsCollapsed,A=C.getBlockConfig,C.Document=function(E){function c(y){null==y&&(y=[]),c.__super__.constructor.apply(this||b,arguments),0===y.length&&(y=[new C.Block]),(this||b).blockList=C.SplittableList.box(y)}var k;return r(c,E),c.fromJSON=function(y){var A,x;return x=function(){var b,x,w;for(w=[],b=0,x=y.length;x>b;b++)A=y[b],w.push(C.Block.fromJSON(A));return w}(),new(this||b)(x)},c.fromHTML=function(y,b){return C.HTMLParser.parse(y,b).getDocument()},c.fromString=function(y,A){var x;return x=C.Text.textForStringWithAttributes(y,A),new(this||b)([new C.Block(x)])},c.prototype.isEmpty=function(){var y;return 1===(this||b).blockList.length&&(y=this.getBlockAtIndex(0),y.isEmpty()&&!y.hasAttributes())},c.prototype.copy=function(y){var A;return null==y&&(y={}),A=y.consolidateBlocks?(this||b).blockList.consolidate().toArray():(this||b).blockList.toArray(),new(this||b).constructor(A)},c.prototype.copyUsingObjectsFromDocument=function(y){var b;return b=new C.ObjectMap(y.getObjects()),this.copyUsingObjectMap(b)},c.prototype.copyUsingObjectMap=function(y){var A,C,x;return C=function(){var b,C,w,E;for(w=this.getBlocks(),E=[],b=0,C=w.length;C>b;b++)A=w[b],E.push((x=y.find(A))?x:A.copyUsingObjectMap(y));return E}.call(this||b),new(this||b).constructor(C)},c.prototype.copyWithBaseBlockAttributes=function(y){var A,C,x;return null==y&&(y=[]),x=function(){var b,x,w,E;for(w=this.getBlocks(),E=[],b=0,x=w.length;x>b;b++)C=w[b],A=y.concat(C.getAttributes()),E.push(C.copyWithAttributes(A));return E}.call(this||b),new(this||b).constructor(x)},c.prototype.replaceBlock=function(y,A){var C;return C=(this||b).blockList.indexOf(y),-1===C?this||b:new(this||b).constructor((this||b).blockList.replaceObjectAtIndex(A,C))},c.prototype.insertDocumentAtRange=function(y,A){var C,E,S,R,k,D,L;return E=y.blockList,k=(A=x(A))[0],D=this.locationFromPosition(k),S=D.index,R=D.offset,L=this||b,C=this.getBlockAtPosition(k),w(A)&&C.isEmpty()&&!C.hasAttributes()?L=new(this||b).constructor(L.blockList.removeObjectAtIndex(S)):C.getBlockBreakPosition()===R&&k++,L=L.removeTextAtRange(A),new(this||b).constructor(L.blockList.insertSplittableListAtPosition(E,k))},c.prototype.mergeDocumentAtRange=function(A,C){var w,E,S,R,k,D,L,T,O,N,P,I;return P=(C=x(C))[0],N=this.locationFromPosition(P),E=this.getBlockAtIndex(N.index).getAttributes(),w=A.getBaseBlockAttributes(),I=E.slice(-w.length),y(w,I)?(L=E.slice(0,-w.length),D=A.copyWithBaseBlockAttributes(L)):D=A.copy({consolidateBlocks:!0}).copyWithBaseBlockAttributes(E),S=D.getBlockCount(),R=D.getBlockAtIndex(0),y(E,R.getAttributes())?(k=R.getTextWithoutBlockBreak(),O=this.insertTextAtRange(k,C),S>1&&(D=new(this||b).constructor(D.getBlocks().slice(1)),T=P+k.getLength(),O=O.insertDocumentAtRange(D,T))):O=this.insertDocumentAtRange(D,C),O},c.prototype.insertTextAtRange=function(y,A){var C,w,E,S,R;return R=(A=x(A))[0],S=this.locationFromPosition(R),w=S.index,E=S.offset,C=this.removeTextAtRange(A),new(this||b).constructor(C.blockList.editObjectAtIndex(w,(function(b){return b.copyWithText(b.text.insertTextAtPosition(y,E))})))},c.prototype.removeTextAtRange=function(y){var A,C,E,S,R,k,D,L,T,O,N,P,I,_,B,F,M,j,W,q,V;return O=y=x(y),L=O[0],j=O[1],w(y)?this||b:(N=this.locationRangeFromRange(y),k=N[0],F=N[1],R=k.index,D=k.offset,S=this.getBlockAtIndex(R),B=F.index,M=F.offset,_=this.getBlockAtIndex(B),P=j-L===1&&S.getBlockBreakPosition()===D&&_.getBlockBreakPosition()!==M&&"\n"===_.text.getStringAtPosition(M),P?E=(this||b).blockList.editObjectAtIndex(B,(function(y){return y.copyWithText(y.text.removeTextAtRange([M,M+1]))})):(T=S.text.getTextAtRange([0,D]),W=_.text.getTextAtRange([M,_.getLength()]),q=T.appendText(W),I=R!==B&&0===D,V=I&&S.getAttributeLevel()>=_.getAttributeLevel(),C=V?_.copyWithText(q):S.copyWithText(q),A=B+1-R,E=(this||b).blockList.splice(R,A,C)),new(this||b).constructor(E))},c.prototype.moveTextFromRangeToPosition=function(y,A){var C,w,E,R,k,D,L,T,O,N;return D=y=x(y),O=D[0],E=D[1],A>=O&&E>=A?this||b:(w=this.getDocumentAtRange(y),T=this.removeTextAtRange(y),k=A>O,k&&(A-=w.getLength()),L=w.getBlocks(),R=L[0],C=2<=L.length?S.call(L,1):[],0===C.length?(N=R.getTextWithoutBlockBreak(),k&&(A+=1)):N=R.text,T=T.insertTextAtRange(N,A),0===C.length?T:(w=new(this||b).constructor(C),A+=N.getLength(),T.insertDocumentAtRange(w,A)))},c.prototype.addAttributeAtRange=function(y,C,x){var w;return w=(this||b).blockList,this.eachBlockAtRange(x,(function(b,x,E){return w=w.editObjectAtIndex(E,(function(){return A(y)?b.addAttribute(y,C):x[0]===x[1]?b:b.copyWithText(b.text.addAttributeAtRange(y,C,x))}))})),new(this||b).constructor(w)},c.prototype.addAttribute=function(y,A){var C;return C=(this||b).blockList,this.eachBlock((function(b,x){return C=C.editObjectAtIndex(x,(function(){return b.addAttribute(y,A)}))})),new(this||b).constructor(C)},c.prototype.removeAttributeAtRange=function(y,C){var x;return x=(this||b).blockList,this.eachBlockAtRange(C,(function(b,C,w){return A(y)?x=x.editObjectAtIndex(w,(function(){return b.removeAttribute(y)})):C[0]!==C[1]?x=x.editObjectAtIndex(w,(function(){return b.copyWithText(b.text.removeAttributeAtRange(y,C))})):void 0})),new(this||b).constructor(x)},c.prototype.updateAttributesForAttachment=function(y,A){var C,x,w;return x=this.getRangeOfAttachment(A)[0],C=this.locationFromPosition(x).index,w=this.getTextAtIndex(C),new(this||b).constructor((this||b).blockList.editObjectAtIndex(C,(function(b){return b.copyWithText(w.updateAttributesForAttachment(y,A))})))},c.prototype.removeAttributeForAttachment=function(y,b){var A;return A=this.getRangeOfAttachment(b),this.removeAttributeAtRange(y,A)},c.prototype.insertBlockBreakAtRange=function(y){var A,w,E,S;return S=(y=x(y))[0],E=this.locationFromPosition(S).offset,w=this.removeTextAtRange(y),0===E&&(A=[new C.Block]),new(this||b).constructor(w.blockList.insertSplittableListAtPosition(new C.SplittableList(A),S))},c.prototype.applyBlockAttributeAtRange=function(y,b,C){var x,w,E,S;return E=this.expandRangeToLineBreaksAndSplitBlocks(C),w=E.document,C=E.range,x=A(y),x.listAttribute?(w=w.removeLastListAttributeAtRange(C,{exceptAttributeName:y}),S=w.convertLineBreaksToBlockBreaksInRange(C),w=S.document,C=S.range):w=x.exclusive?w.removeBlockAttributesAtRange(C):x.terminal?w.removeLastTerminalAttributeAtRange(C):w.consolidateBlocksAtRange(C),w.addAttributeAtRange(y,b,C)},c.prototype.removeLastListAttributeAtRange=function(y,C){var x;return null==C&&(C={}),x=(this||b).blockList,this.eachBlockAtRange(y,(function(y,b,w){var E;if((E=y.getLastAttribute())&&A(E).listAttribute&&E!==C.exceptAttributeName)return x=x.editObjectAtIndex(w,(function(){return y.removeAttribute(E)}))})),new(this||b).constructor(x)},c.prototype.removeLastTerminalAttributeAtRange=function(y){var C;return C=(this||b).blockList,this.eachBlockAtRange(y,(function(y,b,x){var w;if((w=y.getLastAttribute())&&A(w).terminal)return C=C.editObjectAtIndex(x,(function(){return y.removeAttribute(w)}))})),new(this||b).constructor(C)},c.prototype.removeBlockAttributesAtRange=function(y){var A;return A=(this||b).blockList,this.eachBlockAtRange(y,(function(y,b,C){return y.hasAttributes()?A=A.editObjectAtIndex(C,(function(){return y.copyWithoutAttributes()})):void 0})),new(this||b).constructor(A)},c.prototype.expandRangeToLineBreaksAndSplitBlocks=function(y){var A,C,w,E,S,R,k,D,L;return R=y=x(y),L=R[0],E=R[1],D=this.locationFromPosition(L),w=this.locationFromPosition(E),A=this||b,k=A.getBlockAtIndex(D.index),null!=(D.offset=k.findLineBreakInDirectionFromPosition("backward",D.offset))&&(S=A.positionFromLocation(D),A=A.insertBlockBreakAtRange([S,S+1]),w.index+=1,w.offset-=A.getBlockAtIndex(D.index).getLength(),D.index+=1),D.offset=0,0===w.offset&&w.index>D.index?(w.index-=1,w.offset=A.getBlockAtIndex(w.index).getBlockBreakPosition()):(C=A.getBlockAtIndex(w.index),"\n"===C.text.getStringAtRange([w.offset-1,w.offset])?w.offset-=1:w.offset=C.findLineBreakInDirectionFromPosition("forward",w.offset),w.offset!==C.getBlockBreakPosition()&&(S=A.positionFromLocation(w),A=A.insertBlockBreakAtRange([S,S+1]))),L=A.positionFromLocation(D),E=A.positionFromLocation(w),y=x([L,E]),{document:A,range:y}},c.prototype.convertLineBreaksToBlockBreaksInRange=function(y){var A,C,w;return C=(y=x(y))[0],w=this.getStringAtRange(y).slice(0,-1),A=this||b,w.replace(/.*?\n/g,(function(y){return C+=y.length,A=A.insertBlockBreakAtRange([C-1,C])})),{document:A,range:y}},c.prototype.consolidateBlocksAtRange=function(y){var A,C,w,E,S;return w=y=x(y),S=w[0],C=w[1],E=this.locationFromPosition(S).index,A=this.locationFromPosition(C).index,new(this||b).constructor((this||b).blockList.consolidateFromIndexToIndex(E,A))},c.prototype.getDocumentAtRange=function(y){var A;return y=x(y),A=(this||b).blockList.getSplittableListInRange(y).toArray(),new(this||b).constructor(A)},c.prototype.getStringAtRange=function(y){var b,A,C;return C=y=x(y),A=C[C.length-1],A!==this.getLength()&&(b=-1),this.getDocumentAtRange(y).toString().slice(0,b)},c.prototype.getBlockAtIndex=function(y){return(this||b).blockList.getObjectAtIndex(y)},c.prototype.getBlockAtPosition=function(y){var b;return b=this.locationFromPosition(y).index,this.getBlockAtIndex(b)},c.prototype.getTextAtIndex=function(y){var b;return null!=(b=this.getBlockAtIndex(y))?b.text:void 0},c.prototype.getTextAtPosition=function(y){var b;return b=this.locationFromPosition(y).index,this.getTextAtIndex(b)},c.prototype.getPieceAtPosition=function(y){var b,A,C;return C=this.locationFromPosition(y),b=C.index,A=C.offset,this.getTextAtIndex(b).getPieceAtPosition(A)},c.prototype.getCharacterAtPosition=function(y){var b,A,C;return C=this.locationFromPosition(y),b=C.index,A=C.offset,this.getTextAtIndex(b).getStringAtRange([A,A+1])},c.prototype.getLength=function(){return(this||b).blockList.getEndPosition()},c.prototype.getBlocks=function(){return(this||b).blockList.toArray()},c.prototype.getBlockCount=function(){return(this||b).blockList.length},c.prototype.getEditCount=function(){return(this||b).editCount},c.prototype.eachBlock=function(y){return(this||b).blockList.eachObject(y)},c.prototype.eachBlockAtRange=function(y,b){var A,C,w,E,S,R,k,D,L,T,O,N;if(R=y=x(y),O=R[0],w=R[1],T=this.locationFromPosition(O),C=this.locationFromPosition(w),T.index===C.index)return A=this.getBlockAtIndex(T.index),N=[T.offset,C.offset],b(A,N,T.index);for(L=[],S=E=k=T.index,D=C.index;D>=k?D>=E:E>=D;S=D>=k?++E:--E)(A=this.getBlockAtIndex(S))?(N=function(){switch(S){case T.index:return[T.offset,A.text.getLength()];case C.index:return[0,C.offset];default:return[0,A.text.getLength()]}}(),L.push(b(A,N,S))):L.push(void 0);return L},c.prototype.getCommonAttributesAtRange=function(y){var b,A,E;return A=(y=x(y))[0],w(y)?this.getCommonAttributesAtPosition(A):(E=[],b=[],this.eachBlockAtRange(y,(function(y,A){return A[0]!==A[1]?(E.push(y.text.getCommonAttributesAtRange(A)),b.push(k(y))):void 0})),C.Hash.fromCommonAttributesOfObjects(E).merge(C.Hash.fromCommonAttributesOfObjects(b)).toObject())},c.prototype.getCommonAttributesAtPosition=function(y){var b,A,x,w,E,S,D,L,T,O;if(T=this.locationFromPosition(y),E=T.index,L=T.offset,x=this.getBlockAtIndex(E),!x)return{};w=k(x),b=x.text.getAttributesAtPosition(L),A=x.text.getAttributesAtPosition(L-1),S=function(){var y,b;y=C.config.textAttributes,b=[];for(D in y)O=y[D],O.inheritable&&b.push(D);return b}();for(D in A)O=A[D],(O===b[D]||R.call(S,D)>=0)&&(w[D]=O);return w},c.prototype.getRangeOfCommonAttributeAtPosition=function(y,b){var A,C,w,E,S,R,k,D,L;return S=this.locationFromPosition(b),w=S.index,E=S.offset,L=this.getTextAtIndex(w),R=L.getExpandedRangeForAttributeAtOffset(y,E),D=R[0],C=R[1],k=this.positionFromLocation({index:w,offset:D}),A=this.positionFromLocation({index:w,offset:C}),x([k,A])},c.prototype.getBaseBlockAttributes=function(){var y,b,A,C,x,w,E;for(y=this.getBlockAtIndex(0).getAttributes(),A=C=1,E=this.getBlockCount();E>=1?E>C:C>E;A=E>=1?++C:--C)b=this.getBlockAtIndex(A).getAttributes(),w=Math.min(y.length,b.length),y=function(){var A,C,E;for(E=[],x=A=0,C=w;(C>=0?C>A:A>C)&&b[x]===y[x];x=C>=0?++A:--A)E.push(b[x]);return E}();return y},k=function(y){var b,A;return A={},(b=y.getLastAttribute())&&(A[b]=!0),A},c.prototype.getAttachmentById=function(y){var b,A,C,x;for(x=this.getAttachments(),A=0,C=x.length;C>A;A++)if(b=x[A],b.id===y)return b},c.prototype.getAttachmentPieces=function(){var y;return y=[],(this||b).blockList.eachObject((function(b){var A;return A=b.text,y=y.concat(A.getAttachmentPieces())})),y},c.prototype.getAttachments=function(){var y,b,A,C,x;for(C=this.getAttachmentPieces(),x=[],y=0,b=C.length;b>y;y++)A=C[y],x.push(A.attachment);return x},c.prototype.getRangeOfAttachment=function(y){var A,C,w,E,S,R,k;for(E=0,S=(this||b).blockList.toArray(),C=A=0,w=S.length;w>A;C=++A){if(R=S[C].text,k=R.getRangeOfAttachment(y))return x([E+k[0],E+k[1]]);E+=R.getLength()}},c.prototype.getLocationRangeOfAttachment=function(y){var b;return b=this.getRangeOfAttachment(y),this.locationRangeFromRange(b)},c.prototype.getAttachmentPieceForAttachment=function(y){var b,A,C,x;for(x=this.getAttachmentPieces(),b=0,A=x.length;A>b;b++)if(C=x[b],C.attachment===y)return C},c.prototype.findRangesForBlockAttribute=function(y){var b,A,C,x,w,E,S;for(w=0,E=[],S=this.getBlocks(),A=0,C=S.length;C>A;A++)b=S[A],x=b.getLength(),b.hasAttribute(y)&&E.push([w,w+x]),w+=x;return E},c.prototype.findRangesForTextAttribute=function(y,b){var A,C,x,w,E,S,R,k,D,L;for(L=(null!=b?b:{}).withValue,S=0,R=[],k=[],w=function(b){return null!=L?b.getAttribute(y)===L:b.hasAttribute(y)},D=this.getPieces(),A=0,C=D.length;C>A;A++)E=D[A],x=E.getLength(),w(E)&&(R[1]===S?R[1]=S+x:k.push(R=[S,S+x])),S+=x;return k},c.prototype.locationFromPosition=function(y){var A,C;return C=(this||b).blockList.findIndexAndOffsetAtPosition(Math.max(0,y)),null!=C.index?C:(A=this.getBlocks(),{index:A.length-1,offset:A[A.length-1].getLength()})},c.prototype.positionFromLocation=function(y){return(this||b).blockList.findPositionAtIndexAndOffset(y.index,y.offset)},c.prototype.locationRangeFromPosition=function(y){return x(this.locationFromPosition(y))},c.prototype.locationRangeFromRange=function(y){var b,A,C,w;if(y=x(y))return w=y[0],A=y[1],C=this.locationFromPosition(w),b=this.locationFromPosition(A),x([C,b])},c.prototype.rangeFromLocationRange=function(y){var b,A;return y=x(y),b=this.positionFromLocation(y[0]),w(y)||(A=this.positionFromLocation(y[1])),x([b,A])},c.prototype.isEqualTo=function(y){return(this||b).blockList.isEqualTo(null!=y?y.blockList:void 0)},c.prototype.getTexts=function(){var y,b,A,C,x;for(C=this.getBlocks(),x=[],b=0,A=C.length;A>b;b++)y=C[b],x.push(y.text);return x},c.prototype.getPieces=function(){var y,b,A,C,x;for(A=[],C=this.getTexts(),y=0,b=C.length;b>y;y++)x=C[y],A.push.apply(A,x.getPieces());return A},c.prototype.getObjects=function(){return this.getBlocks().concat(this.getTexts()).concat(this.getPieces())},c.prototype.toSerializableDocument=function(){var y;return y=[],(this||b).blockList.eachObject((function(b){return y.push(b.copyWithText(b.text.toSerializableText()))})),new(this||b).constructor(y)},c.prototype.toString=function(){return(this||b).blockList.toString()},c.prototype.toJSON=function(){return(this||b).blockList.toJSON()},c.prototype.toConsole=function(){var y;return JSON.stringify(function(){var A,C,x,w;for(x=(this||b).blockList.toArray(),w=[],A=0,C=x.length;C>A;A++)y=x[A],w.push(JSON.parse(y.text.toConsole()));return w}.call(this||b))},c}(C.Object)}.call(this||b),function(){C.LineBreakInsertion=function(){function t(y){var A;(this||b).composition=y,(this||b).document=(this||b).composition.document,A=(this||b).composition.getSelectedRange(),(this||b).startPosition=A[0],(this||b).endPosition=A[1],(this||b).startLocation=(this||b).document.locationFromPosition((this||b).startPosition),(this||b).endLocation=(this||b).document.locationFromPosition((this||b).endPosition),(this||b).block=(this||b).document.getBlockAtIndex((this||b).endLocation.index),(this||b).breaksOnReturn=(this||b).block.breaksOnReturn(),(this||b).previousCharacter=(this||b).block.text.getStringAtPosition((this||b).endLocation.offset-1),(this||b).nextCharacter=(this||b).block.text.getStringAtPosition((this||b).endLocation.offset)}return t.prototype.shouldInsertBlockBreak=function(){return(this||b).block.hasAttributes()&&(this||b).block.isListItem()&&!(this||b).block.isEmpty()?0!==(this||b).startLocation.offset:(this||b).breaksOnReturn&&"\n"!==(this||b).nextCharacter},t.prototype.shouldBreakFormattedBlock=function(){return(this||b).block.hasAttributes()&&!(this||b).block.isListItem()&&((this||b).breaksOnReturn&&"\n"===(this||b).nextCharacter||"\n"===(this||b).previousCharacter)},t.prototype.shouldDecreaseListLevel=function(){return(this||b).block.hasAttributes()&&(this||b).block.isListItem()&&(this||b).block.isEmpty()},t.prototype.shouldPrependListItem=function(){return(this||b).block.isListItem()&&0===(this||b).startLocation.offset&&!(this||b).block.isEmpty()},t.prototype.shouldRemoveLastBlockAttribute=function(){return(this||b).block.hasAttributes()&&!(this||b).block.isListItem()&&(this||b).block.isEmpty()},t}()}.call(this||b),function(){var y,A,x,w,E,S,R,k,D,L,h=function(y,A){function n(){(this||b).constructor=y}for(var C in A)T.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},T={}.hasOwnProperty;S=C.normalizeRange,D=C.rangesAreEqual,k=C.rangeIsCollapsed,R=C.objectsAreEqual,y=C.arrayStartsWith,L=C.summarizeArrayChange,x=C.getAllAttributeNames,w=C.getBlockConfig,E=C.getTextConfig,A=C.extend,C.Composition=function(T){function d(){(this||b).document=new C.Document,(this||b).attachments=[],(this||b).currentAttributes={},(this||b).revision=0}var O;return h(d,T),d.prototype.setDocument=function(y){var A;return y.isEqualTo((this||b).document)?void 0:((this||b).document=y,this.refreshAttachments(),(this||b).revision++,null!=(A=(this||b).delegate)&&"function"==typeof A.compositionDidChangeDocument?A.compositionDidChangeDocument(y):void 0)},d.prototype.getSnapshot=function(){return{document:(this||b).document,selectedRange:this.getSelectedRange()}},d.prototype.loadSnapshot=function(y){var A,x,w,E;return A=y.document,E=y.selectedRange,null!=(x=(this||b).delegate)&&"function"==typeof x.compositionWillLoadSnapshot&&x.compositionWillLoadSnapshot(),this.setDocument(null!=A?A:new C.Document),this.setSelection(null!=E?E:[0,0]),null!=(w=(this||b).delegate)&&"function"==typeof w.compositionDidLoadSnapshot?w.compositionDidLoadSnapshot():void 0},d.prototype.insertText=function(y,A){var C,x,w,E;return E=(null!=A?A:{updatePosition:!0}).updatePosition,x=this.getSelectedRange(),this.setDocument((this||b).document.insertTextAtRange(y,x)),w=x[0],C=w+y.getLength(),E&&this.setSelection(C),this.notifyDelegateOfInsertionAtRange([w,C])},d.prototype.insertBlock=function(y){var b;return null==y&&(y=new C.Block),b=new C.Document([y]),this.insertDocument(b)},d.prototype.insertDocument=function(y){var A,x,w;return null==y&&(y=new C.Document),x=this.getSelectedRange(),this.setDocument((this||b).document.insertDocumentAtRange(y,x)),w=x[0],A=w+y.getLength(),this.setSelection(A),this.notifyDelegateOfInsertionAtRange([w,A])},d.prototype.insertString=function(y,b){var A,x;return A=this.getCurrentTextAttributes(),x=C.Text.textForStringWithAttributes(y,A),this.insertText(x,b)},d.prototype.insertBlockBreak=function(){var y,A,C;return A=this.getSelectedRange(),this.setDocument((this||b).document.insertBlockBreakAtRange(A)),C=A[0],y=C+1,this.setSelection(y),this.notifyDelegateOfInsertionAtRange([C,y])},d.prototype.insertLineBreak=function(){var y,A;return A=new C.LineBreakInsertion(this||b),A.shouldDecreaseListLevel()?(this.decreaseListLevel(),this.setSelection(A.startPosition)):A.shouldPrependListItem()?(y=new C.Document([A.block.copyWithoutText()]),this.insertDocument(y)):A.shouldInsertBlockBreak()?this.insertBlockBreak():A.shouldRemoveLastBlockAttribute()?this.removeLastBlockAttribute():A.shouldBreakFormattedBlock()?this.breakFormattedBlock(A):this.insertString("\n")},d.prototype.insertHTML=function(y){var A,x,w,E;return A=C.Document.fromHTML(y),w=this.getSelectedRange(),this.setDocument((this||b).document.mergeDocumentAtRange(A,w)),E=w[0],x=E+A.getLength()-1,this.setSelection(x),this.notifyDelegateOfInsertionAtRange([E,x])},d.prototype.replaceHTML=function(y){var A,x,w;return A=C.Document.fromHTML(y).copyUsingObjectsFromDocument((this||b).document),x=this.getLocationRange({strict:!1}),w=(this||b).document.rangeFromLocationRange(x),this.setDocument(A),this.setSelection(w)},d.prototype.insertFile=function(y){return this.insertFiles([y])},d.prototype.insertFiles=function(y){var A,x,w,E,S,R;for(x=[],E=0,S=y.length;S>E;E++)w=y[E],(null!=(R=(this||b).delegate)?R.compositionShouldAcceptFile(w):void 0)&&(A=C.Attachment.attachmentForFile(w),x.push(A));return this.insertAttachments(x)},d.prototype.insertAttachment=function(y){return this.insertAttachments([y])},d.prototype.insertAttachments=function(y){var b,A,x,w,E,S,R,k,D;for(k=new C.Text,w=0,E=y.length;E>w;w++)b=y[w],D=b.getType(),S=null!=(R=C.config.attachments[D])?R.presentation:void 0,x=this.getCurrentTextAttributes(),S&&(x.presentation=S),A=C.Text.textForAttachmentWithAttributes(b,x),k=k.appendText(A);return this.insertText(k)},d.prototype.shouldManageDeletingInDirection=function(y){var b;if(b=this.getLocationRange(),k(b)){if("backward"===y&&0===b[0].offset)return!0;if(this.shouldManageMovingCursorInDirection(y))return!0}else if(b[0].index!==b[1].index)return!0;return!1},d.prototype.deleteInDirection=function(y,A){var C,x,w,E,S,R,D,L;return E=(null!=A?A:{}).length,S=this.getLocationRange(),R=this.getSelectedRange(),D=k(R),D?w="backward"===y&&0===S[0].offset:L=S[0].index!==S[1].index,!(w&&this.canDecreaseBlockAttributeLevel()&&(x=this.getBlock(),x.isListItem()?this.decreaseListLevel():this.decreaseBlockAttributeLevel(),this.setSelection(R[0]),x.isEmpty()))&&(D&&(R=this.getExpandedRangeInDirection(y,{length:E}),"backward"===y&&(C=this.getAttachmentAtRange(R))),C?(this.editAttachment(C),!1):(this.setDocument((this||b).document.removeTextAtRange(R)),this.setSelection(R[0]),!w&&!L&&void 0))},d.prototype.moveTextFromRange=function(y){var A;return A=this.getSelectedRange()[0],this.setDocument((this||b).document.moveTextFromRangeToPosition(y,A)),this.setSelection(A)},d.prototype.removeAttachment=function(y){var A;return(A=(this||b).document.getRangeOfAttachment(y))?(this.stopEditingAttachment(),this.setDocument((this||b).document.removeTextAtRange(A)),this.setSelection(A[0])):void 0},d.prototype.removeLastBlockAttribute=function(){var y,A,C,x;return C=this.getSelectedRange(),x=C[0],A=C[1],y=(this||b).document.getBlockAtPosition(A),this.removeCurrentAttribute(y.getLastAttribute()),this.setSelection(x)},O=" ",d.prototype.insertPlaceholder=function(){return(this||b).placeholderPosition=this.getPosition(),this.insertString(O)},d.prototype.selectPlaceholder=function(){return null!=(this||b).placeholderPosition?(this.setSelectedRange([(this||b).placeholderPosition,(this||b).placeholderPosition+O.length]),this.getSelectedRange()):void 0},d.prototype.forgetPlaceholder=function(){return(this||b).placeholderPosition=null},d.prototype.hasCurrentAttribute=function(y){var A;return A=(this||b).currentAttributes[y],null!=A&&!1!==A},d.prototype.toggleCurrentAttribute=function(y){var A;return(A=!(this||b).currentAttributes[y])?this.setCurrentAttribute(y,A):this.removeCurrentAttribute(y)},d.prototype.canSetCurrentAttribute=function(y){return w(y)?this.canSetCurrentBlockAttribute(y):this.canSetCurrentTextAttribute(y)},d.prototype.canSetCurrentTextAttribute=function(){var y,b,A,C,x;if(b=this.getSelectedDocument()){for(x=b.getAttachments(),A=0,C=x.length;C>A;A++)if(y=x[A],!y.hasContent())return!1;return!0}},d.prototype.canSetCurrentBlockAttribute=function(){var y;if(y=this.getBlock())return!y.isTerminalBlock()},d.prototype.setCurrentAttribute=function(y,A){return w(y)?this.setBlockAttribute(y,A):(this.setTextAttribute(y,A),(this||b).currentAttributes[y]=A,this.notifyDelegateOfCurrentAttributesChange())},d.prototype.setTextAttribute=function(y,A){var x,w,E,S;if(w=this.getSelectedRange())return E=w[0],x=w[1],E!==x?this.setDocument((this||b).document.addAttributeAtRange(y,A,w)):"href"===y?(S=C.Text.textForStringWithAttributes(A,{href:A}),this.insertText(S)):void 0},d.prototype.setBlockAttribute=function(y,A){var C;if(C=this.getSelectedRange())return this.canSetCurrentAttribute(y)?(this.getBlock(),this.setDocument((this||b).document.applyBlockAttributeAtRange(y,A,C)),this.setSelection(C)):void 0},d.prototype.removeCurrentAttribute=function(y){return w(y)?(this.removeBlockAttribute(y),this.updateCurrentAttributes()):(this.removeTextAttribute(y),delete(this||b).currentAttributes[y],this.notifyDelegateOfCurrentAttributesChange())},d.prototype.removeTextAttribute=function(y){var A;if(A=this.getSelectedRange())return this.setDocument((this||b).document.removeAttributeAtRange(y,A))},d.prototype.removeBlockAttribute=function(y){var A;if(A=this.getSelectedRange())return this.setDocument((this||b).document.removeAttributeAtRange(y,A))},d.prototype.canDecreaseNestingLevel=function(){var y;return(null!=(y=this.getBlock())?y.getNestingLevel():void 0)>0},d.prototype.canIncreaseNestingLevel=function(){var b,A,C;if(b=this.getBlock())return(null!=(C=w(b.getLastNestableAttribute()))?C.listAttribute:0)?(A=this.getPreviousBlock())?y(A.getListItemAttributes(),b.getListItemAttributes()):void 0:b.getNestingLevel()>0},d.prototype.decreaseNestingLevel=function(){var y;if(y=this.getBlock())return this.setDocument((this||b).document.replaceBlock(y,y.decreaseNestingLevel()))},d.prototype.increaseNestingLevel=function(){var y;if(y=this.getBlock())return this.setDocument((this||b).document.replaceBlock(y,y.increaseNestingLevel()))},d.prototype.canDecreaseBlockAttributeLevel=function(){var y;return(null!=(y=this.getBlock())?y.getAttributeLevel():void 0)>0},d.prototype.decreaseBlockAttributeLevel=function(){var y,b;return(y=null!=(b=this.getBlock())?b.getLastAttribute():void 0)?this.removeCurrentAttribute(y):void 0},d.prototype.decreaseListLevel=function(){var y,A,C,x,w,E;for(E=this.getSelectedRange()[0],w=(this||b).document.locationFromPosition(E).index,C=w,y=this.getBlock().getAttributeLevel();(A=(this||b).document.getBlockAtIndex(C+1))&&A.isListItem()&&A.getAttributeLevel()>y;)C++;return E=(this||b).document.positionFromLocation({index:w,offset:0}),x=(this||b).document.positionFromLocation({index:C,offset:0}),this.setDocument((this||b).document.removeLastListAttributeAtRange([E,x]))},d.prototype.updateCurrentAttributes=function(){var y,A,C,w,E,S;if(S=this.getSelectedRange({ignoreLock:!0})){for(A=(this||b).document.getCommonAttributesAtRange(S),E=x(),C=0,w=E.length;w>C;C++)y=E[C],A[y]||this.canSetCurrentAttribute(y)||(A[y]=!1);if(!R(A,(this||b).currentAttributes))return(this||b).currentAttributes=A,this.notifyDelegateOfCurrentAttributesChange()}},d.prototype.getCurrentAttributes=function(){return A.call({},(this||b).currentAttributes)},d.prototype.getCurrentTextAttributes=function(){var y,A,C,x;y={},C=(this||b).currentAttributes;for(A in C)x=C[A],!1!==x&&E(A)&&(y[A]=x);return y},d.prototype.freezeSelection=function(){return this.setCurrentAttribute("frozen",!0)},d.prototype.thawSelection=function(){return this.removeCurrentAttribute("frozen")},d.prototype.hasFrozenSelection=function(){return this.hasCurrentAttribute("frozen")},d.proxyMethod("getSelectionManager().getPointRange"),d.proxyMethod("getSelectionManager().setLocationRangeFromPointRange"),d.proxyMethod("getSelectionManager().createLocationRangeFromDOMRange"),d.proxyMethod("getSelectionManager().locationIsCursorTarget"),d.proxyMethod("getSelectionManager().selectionIsExpanded"),d.proxyMethod("delegate?.getSelectionManager"),d.prototype.setSelection=function(y){var A,C;return A=(this||b).document.locationRangeFromRange(y),null!=(C=(this||b).delegate)?C.compositionDidRequestChangingSelectionToLocationRange(A):void 0},d.prototype.getSelectedRange=function(){var y;return(y=this.getLocationRange())?(this||b).document.rangeFromLocationRange(y):void 0},d.prototype.setSelectedRange=function(y){var A;return A=(this||b).document.locationRangeFromRange(y),this.getSelectionManager().setLocationRange(A)},d.prototype.getPosition=function(){var y;return(y=this.getLocationRange())?(this||b).document.positionFromLocation(y[0]):void 0},d.prototype.getLocationRange=function(y){var A,C;return null!=(A=null!=(C=(this||b).targetLocationRange)?C:this.getSelectionManager().getLocationRange(y))?A:S({index:0,offset:0})},d.prototype.withTargetLocationRange=function(y,A){var C;(this||b).targetLocationRange=y;try{C=A()}finally{(this||b).targetLocationRange=null}return C},d.prototype.withTargetRange=function(y,A){var C;return C=(this||b).document.locationRangeFromRange(y),this.withTargetLocationRange(C,A)},d.prototype.withTargetDOMRange=function(y,b){var A;return A=this.createLocationRangeFromDOMRange(y,{strict:!1}),this.withTargetLocationRange(A,b)},d.prototype.getExpandedRangeInDirection=function(y,b){var A,C,x,w;return C=(null!=b?b:{}).length,x=this.getSelectedRange(),w=x[0],A=x[1],"backward"===y?C?w-=C:w=this.translateUTF16PositionFromOffset(w,-1):C?A+=C:A=this.translateUTF16PositionFromOffset(A,1),S([w,A])},d.prototype.shouldManageMovingCursorInDirection=function(y){var A;return!!(this||b).editingAttachment||(A=this.getExpandedRangeInDirection(y),null!=this.getAttachmentAtRange(A))},d.prototype.moveCursorInDirection=function(y){var A,C,x,w;return(this||b).editingAttachment?x=(this||b).document.getRangeOfAttachment((this||b).editingAttachment):(w=this.getSelectedRange(),x=this.getExpandedRangeInDirection(y),C=!D(w,x)),this.setSelectedRange("backward"===y?x[0]:x[1]),C&&(A=this.getAttachmentAtRange(x))?this.editAttachment(A):void 0},d.prototype.expandSelectionInDirection=function(y,b){var A,C;return A=(null!=b?b:{}).length,C=this.getExpandedRangeInDirection(y,{length:A}),this.setSelectedRange(C)},d.prototype.expandSelectionForEditing=function(){return this.hasCurrentAttribute("href")?this.expandSelectionAroundCommonAttribute("href"):void 0},d.prototype.expandSelectionAroundCommonAttribute=function(y){var A,C;return A=this.getPosition(),C=(this||b).document.getRangeOfCommonAttributeAtPosition(y,A),this.setSelectedRange(C)},d.prototype.selectionContainsAttachments=function(){var y;return(null!=(y=this.getSelectedAttachments())?y.length:void 0)>0},d.prototype.selectionIsInCursorTarget=function(){return(this||b).editingAttachment||this.positionIsCursorTarget(this.getPosition())},d.prototype.positionIsCursorTarget=function(y){var A;return(A=(this||b).document.locationFromPosition(y))?this.locationIsCursorTarget(A):void 0},d.prototype.positionIsBlockBreak=function(y){var A;return null!=(A=(this||b).document.getPieceAtPosition(y))?A.isBlockBreak():void 0},d.prototype.getSelectedDocument=function(){var y;return(y=this.getSelectedRange())?(this||b).document.getDocumentAtRange(y):void 0},d.prototype.getSelectedAttachments=function(){var y;return null!=(y=this.getSelectedDocument())?y.getAttachments():void 0},d.prototype.getAttachments=function(){return(this||b).attachments.slice(0)},d.prototype.refreshAttachments=function(){var y,A,C,x,w,E,S,R,k,D,T,O;for(C=(this||b).document.getAttachments(),R=L((this||b).attachments,C),y=R.added,T=R.removed,(this||b).attachments=C,x=0,E=T.length;E>x;x++)A=T[x],A.delegate=null,null!=(k=(this||b).delegate)&&"function"==typeof k.compositionDidRemoveAttachment&&k.compositionDidRemoveAttachment(A);for(O=[],w=0,S=y.length;S>w;w++)A=y[w],A.delegate=this||b,O.push(null!=(D=(this||b).delegate)&&"function"==typeof D.compositionDidAddAttachment?D.compositionDidAddAttachment(A):void 0);return O},d.prototype.attachmentDidChangeAttributes=function(y){var A;return(this||b).revision++,null!=(A=(this||b).delegate)&&"function"==typeof A.compositionDidEditAttachment?A.compositionDidEditAttachment(y):void 0},d.prototype.attachmentDidChangePreviewURL=function(y){var A;return(this||b).revision++,null!=(A=(this||b).delegate)&&"function"==typeof A.compositionDidChangeAttachmentPreviewURL?A.compositionDidChangeAttachmentPreviewURL(y):void 0},d.prototype.editAttachment=function(y,A){var C;if(y!==(this||b).editingAttachment)return this.stopEditingAttachment(),(this||b).editingAttachment=y,null!=(C=(this||b).delegate)&&"function"==typeof C.compositionDidStartEditingAttachment?C.compositionDidStartEditingAttachment((this||b).editingAttachment,A):void 0},d.prototype.stopEditingAttachment=function(){var y;if((this||b).editingAttachment)return null!=(y=(this||b).delegate)&&"function"==typeof y.compositionDidStopEditingAttachment&&y.compositionDidStopEditingAttachment((this||b).editingAttachment),(this||b).editingAttachment=null},d.prototype.updateAttributesForAttachment=function(y,A){return this.setDocument((this||b).document.updateAttributesForAttachment(y,A))},d.prototype.removeAttributeForAttachment=function(y,A){return this.setDocument((this||b).document.removeAttributeForAttachment(y,A))},d.prototype.breakFormattedBlock=function(y){var b,A,x,w,E;return A=y.document,b=y.block,w=y.startPosition,E=[w-1,w],b.getBlockBreakPosition()===y.startLocation.offset?(b.breaksOnReturn()&&"\n"===y.nextCharacter?w+=1:A=A.removeTextAtRange(E),E=[w,w]):"\n"===y.nextCharacter?"\n"===y.previousCharacter?E=[w-1,w+1]:(E=[w,w+1],w+=1):y.startLocation.offset-1!==0&&(w+=1),x=new C.Document([b.removeLastAttribute().copyWithoutText()]),this.setDocument(A.insertDocumentAtRange(x,E)),this.setSelection(w)},d.prototype.getPreviousBlock=function(){var y,A;return(A=this.getLocationRange())&&(y=A[0].index,y>0)?(this||b).document.getBlockAtIndex(y-1):void 0},d.prototype.getBlock=function(){var y;return(y=this.getLocationRange())?(this||b).document.getBlockAtIndex(y[0].index):void 0},d.prototype.getAttachmentAtRange=function(y){var A;return A=(this||b).document.getDocumentAtRange(y),A.toString()===C.OBJECT_REPLACEMENT_CHARACTER+"\n"?A.getAttachments()[0]:void 0},d.prototype.notifyDelegateOfCurrentAttributesChange=function(){var y;return null!=(y=(this||b).delegate)&&"function"==typeof y.compositionDidChangeCurrentAttributes?y.compositionDidChangeCurrentAttributes((this||b).currentAttributes):void 0},d.prototype.notifyDelegateOfInsertionAtRange=function(y){var A;return null!=(A=(this||b).delegate)&&"function"==typeof A.compositionDidPerformInsertionAtRange?A.compositionDidPerformInsertionAtRange(y):void 0},d.prototype.translateUTF16PositionFromOffset=function(y,A){var C,x;return x=(this||b).document.toUTF16String(),C=x.offsetFromUCS2Offset(y),x.offsetToUCS2Offset(C+A)},d}(C.BasicObject)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.UndoManager=function(y){function n(y){(this||b).composition=y,(this||b).undoEntries=[],(this||b).redoEntries=[]}var A;return t(n,y),n.prototype.recordUndoEntry=function(y,C){var x,w,E,S,R;return S=null!=C?C:{},w=S.context,x=S.consolidatable,E=(this||b).undoEntries.slice(-1)[0],x&&A(E,y,w)?void 0:(R=this.createEntry({description:y,context:w}),(this||b).undoEntries.push(R),(this||b).redoEntries=[])},n.prototype.undo=function(){var y,A;return(A=(this||b).undoEntries.pop())?(y=this.createEntry(A),(this||b).redoEntries.push(y),(this||b).composition.loadSnapshot(A.snapshot)):void 0},n.prototype.redo=function(){var y,A;return(y=(this||b).redoEntries.pop())?(A=this.createEntry(y),(this||b).undoEntries.push(A),(this||b).composition.loadSnapshot(y.snapshot)):void 0},n.prototype.canUndo=function(){return(this||b).undoEntries.length>0},n.prototype.canRedo=function(){return(this||b).redoEntries.length>0},n.prototype.createEntry=function(y){var A,C,x;return x=null!=y?y:{},C=x.description,A=x.context,{description:null!=C?C.toString():void 0,context:JSON.stringify(A),snapshot:(this||b).composition.getSnapshot()}},A=function(y,b,A){return(null!=y?y.description:void 0)===(null!=b?b.toString():void 0)&&(null!=y?y.context:void 0)===JSON.stringify(A)},n}(C.BasicObject)}.call(this||b),function(){var y;C.attachmentGalleryFilter=function(b){var A;return A=new y(b),A.perform(),A.getSnapshot()},y=function(){function t(y){(this||b).document=y.document,(this||b).selectedRange=y.selectedRange}var y,A,C;return y="attachmentGallery",A="presentation",C="gallery",t.prototype.perform=function(){return this.removeBlockAttribute(),this.applyBlockAttribute()},t.prototype.getSnapshot=function(){return{document:(this||b).document,selectedRange:(this||b).selectedRange}},t.prototype.removeBlockAttribute=function(){var A,C,x,w,E;for(w=this.findRangesOfBlocks(),E=[],A=0,C=w.length;C>A;A++)x=w[A],E.push((this||b).document=(this||b).document.removeAttributeAtRange(y,x));return E},t.prototype.applyBlockAttribute=function(){var A,C,x,w,E,S;for(x=0,E=this.findRangesOfPieces(),S=[],A=0,C=E.length;C>A;A++)w=E[A],w[1]-w[0]>1&&(w[0]+=x,w[1]+=x,"\n"!==(this||b).document.getCharacterAtPosition(w[1])&&((this||b).document=(this||b).document.insertBlockBreakAtRange(w[1]),w[1]<(this||b).selectedRange[1]&&this.moveSelectedRangeForward(),w[1]++,x++),0!==w[0]&&"\n"!==(this||b).document.getCharacterAtPosition(w[0]-1)&&((this||b).document=(this||b).document.insertBlockBreakAtRange(w[0]),w[0]<(this||b).selectedRange[0]&&this.moveSelectedRangeForward(),w[0]++,x++),S.push((this||b).document=(this||b).document.applyBlockAttributeAtRange(y,!0,w)));return S},t.prototype.findRangesOfBlocks=function(){return(this||b).document.findRangesForBlockAttribute(y)},t.prototype.findRangesOfPieces=function(){return(this||b).document.findRangesForTextAttribute(A,{withValue:C})},t.prototype.moveSelectedRangeForward=function(){return(this||b).selectedRange[0]+=1,(this||b).selectedRange[1]+=1},t}()}.call(this||b),function(){var t=function(y,b){return function(){return y.apply(b,arguments)}};C.Editor=function(){function n(A,x,w){(this||b).composition=A,(this||b).selectionManager=x,(this||b).element=w,(this||b).insertFiles=t((this||b).insertFiles,this||b),(this||b).undoManager=new C.UndoManager((this||b).composition),(this||b).filters=y.slice(0)}var y;return y=[C.attachmentGalleryFilter],n.prototype.loadDocument=function(y){return this.loadSnapshot({document:y,selectedRange:[0,0]})},n.prototype.loadHTML=function(y){return null==y&&(y=""),this.loadDocument(C.Document.fromHTML(y,{referenceElement:(this||b).element}))},n.prototype.loadJSON=function(y){var b,A;return b=y.document,A=y.selectedRange,b=C.Document.fromJSON(b),this.loadSnapshot({document:b,selectedRange:A})},n.prototype.loadSnapshot=function(y){return(this||b).undoManager=new C.UndoManager((this||b).composition),(this||b).composition.loadSnapshot(y)},n.prototype.getDocument=function(){return(this||b).composition.document},n.prototype.getSelectedDocument=function(){return(this||b).composition.getSelectedDocument()},n.prototype.getSnapshot=function(){return(this||b).composition.getSnapshot()},n.prototype.toJSON=function(){return this.getSnapshot()},n.prototype.deleteInDirection=function(y){return(this||b).composition.deleteInDirection(y)},n.prototype.insertAttachment=function(y){return(this||b).composition.insertAttachment(y)},n.prototype.insertAttachments=function(y){return(this||b).composition.insertAttachments(y)},n.prototype.insertDocument=function(y){return(this||b).composition.insertDocument(y)},n.prototype.insertFile=function(y){return(this||b).composition.insertFile(y)},n.prototype.insertFiles=function(y){return(this||b).composition.insertFiles(y)},n.prototype.insertHTML=function(y){return(this||b).composition.insertHTML(y)},n.prototype.insertString=function(y){return(this||b).composition.insertString(y)},n.prototype.insertText=function(y){return(this||b).composition.insertText(y)},n.prototype.insertLineBreak=function(){return(this||b).composition.insertLineBreak()},n.prototype.getSelectedRange=function(){return(this||b).composition.getSelectedRange()},n.prototype.getPosition=function(){return(this||b).composition.getPosition()},n.prototype.getClientRectAtPosition=function(y){var A;return A=this.getDocument().locationRangeFromRange([y,y+1]),(this||b).selectionManager.getClientRectAtLocationRange(A)},n.prototype.expandSelectionInDirection=function(y){return(this||b).composition.expandSelectionInDirection(y)},n.prototype.moveCursorInDirection=function(y){return(this||b).composition.moveCursorInDirection(y)},n.prototype.setSelectedRange=function(y){return(this||b).composition.setSelectedRange(y)},n.prototype.activateAttribute=function(y,A){return null==A&&(A=!0),(this||b).composition.setCurrentAttribute(y,A)},n.prototype.attributeIsActive=function(y){return(this||b).composition.hasCurrentAttribute(y)},n.prototype.canActivateAttribute=function(y){return(this||b).composition.canSetCurrentAttribute(y)},n.prototype.deactivateAttribute=function(y){return(this||b).composition.removeCurrentAttribute(y)},n.prototype.canDecreaseNestingLevel=function(){return(this||b).composition.canDecreaseNestingLevel()},n.prototype.canIncreaseNestingLevel=function(){return(this||b).composition.canIncreaseNestingLevel()},n.prototype.decreaseNestingLevel=function(){return this.canDecreaseNestingLevel()?(this||b).composition.decreaseNestingLevel():void 0},n.prototype.increaseNestingLevel=function(){return this.canIncreaseNestingLevel()?(this||b).composition.increaseNestingLevel():void 0},n.prototype.canRedo=function(){return(this||b).undoManager.canRedo()},n.prototype.canUndo=function(){return(this||b).undoManager.canUndo()},n.prototype.recordUndoEntry=function(y,A){var C,x,w;return w=null!=A?A:{},x=w.context,C=w.consolidatable,(this||b).undoManager.recordUndoEntry(y,{context:x,consolidatable:C})},n.prototype.redo=function(){return this.canRedo()?(this||b).undoManager.redo():void 0},n.prototype.undo=function(){return this.canUndo()?(this||b).undoManager.undo():void 0},n}()}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.ManagedAttachment=function(y){function n(y,A){var C;(this||b).attachmentManager=y,(this||b).attachment=A,C=(this||b).attachment,(this||b).id=C.id,(this||b).file=C.file}return t(n,y),n.prototype.remove=function(){return(this||b).attachmentManager.requestRemovalOfAttachment((this||b).attachment)},n.proxyMethod("attachment.getAttribute"),n.proxyMethod("attachment.hasAttribute"),n.proxyMethod("attachment.setAttribute"),n.proxyMethod("attachment.getAttributes"),n.proxyMethod("attachment.setAttributes"),n.proxyMethod("attachment.isPending"),n.proxyMethod("attachment.isPreviewable"),n.proxyMethod("attachment.getURL"),n.proxyMethod("attachment.getHref"),n.proxyMethod("attachment.getFilename"),n.proxyMethod("attachment.getFilesize"),n.proxyMethod("attachment.getFormattedFilesize"),n.proxyMethod("attachment.getExtension"),n.proxyMethod("attachment.getContentType"),n.proxyMethod("attachment.getFile"),n.proxyMethod("attachment.setFile"),n.proxyMethod("attachment.releaseFile"),n.proxyMethod("attachment.getUploadProgress"),n.proxyMethod("attachment.setUploadProgress"),n}(C.BasicObject)}.call(this||b),function(){var t=function(A,C){function i(){(this||b).constructor=A}for(var x in C)y.call(C,x)&&(A[x]=C[x]);return i.prototype=C.prototype,A.prototype=new i,A.__super__=C.prototype,A},y={}.hasOwnProperty;C.AttachmentManager=function(y){function i(y){var A,C,x;for(null==y&&(y=[]),(this||b).managedAttachments={},C=0,x=y.length;x>C;C++)A=y[C],this.manageAttachment(A)}return t(i,y),i.prototype.getAttachments=function(){var y,A,C,x;C=(this||b).managedAttachments,x=[];for(A in C)y=C[A],x.push(y);return x},i.prototype.manageAttachment=function(y){var A,x;return null!=(A=(this||b).managedAttachments)[x=y.id]?A[x]:A[x]=new C.ManagedAttachment(this||b,y)},i.prototype.attachmentIsManaged=function(y){return y.id in(this||b).managedAttachments},i.prototype.requestRemovalOfAttachment=function(y){var A;return this.attachmentIsManaged(y)&&null!=(A=(this||b).delegate)&&"function"==typeof A.attachmentManagerDidRequestRemovalOfAttachment?A.attachmentManagerDidRequestRemovalOfAttachment(y):void 0},i.prototype.unmanageAttachment=function(y){var A;return A=(this||b).managedAttachments[y.id],delete(this||b).managedAttachments[y.id],A},i}(C.BasicObject)}.call(this||b),function(){var y,A,x,w,E,S,R,k,D,L,T;y=C.elementContainsNode,A=C.findChildIndexOfNode,E=C.nodeIsBlockStart,S=C.nodeIsBlockStartComment,w=C.nodeIsBlockContainer,R=C.nodeIsCursorTarget,k=C.nodeIsEmptyTextNode,D=C.nodeIsTextNode,x=C.nodeIsAttachmentElement,L=C.tagName,T=C.walkTree,C.LocationMapper=function(){function e(y){(this||b).element=y}var C,O,N,P;return e.prototype.findLocationFromContainerAndOffset=function(C,x,w){var S,k,L,P,I,_,B;for(_=(null!=w?w:{strict:!0}).strict,k=0,L=!1,P={index:0,offset:0},(S=this.findAttachmentElementParentForNode(C))&&(C=S.parentNode,x=A(S)),B=T((this||b).element,{usingFilter:N});B.nextNode();){if(I=B.currentNode,I===C&&D(C)){R(I)||(P.offset+=x);break}if(I.parentNode===C){if(k++===x)break}else if(!y(C,I)&&k>0)break;E(I,{strict:_})?(L&&P.index++,P.offset=0,L=!0):P.offset+=O(I)}return P},e.prototype.findContainerAndOffsetFromLocation=function(y){var C,x,S,k,L;if(0===y.index&&0===y.offset){for(C=(this||b).element,k=0;C.firstChild;)if(C=C.firstChild,w(C)){k=1;break}return[C,k]}if(L=this.findNodeAndOffsetFromLocation(y),x=L[0],S=L[1],x){if(D(x))0===O(x)?(C=x.parentNode.parentNode,k=A(x.parentNode),R(x,{name:"right"})&&k++):(C=x,k=y.offset-S);else{if(C=x.parentNode,!E(x.previousSibling)&&!w(C))for(;x===C.lastChild&&(x=C,C=C.parentNode,!w(C)););k=A(x),0!==y.offset&&k++}return[C,k]}},e.prototype.findNodeAndOffsetFromLocation=function(y){var b,A,C,x,w,E,S,k;for(S=0,k=this.getSignificantNodesForIndex(y.index),A=0,C=k.length;C>A;A++){if(b=k[A],x=O(b),y.offset<=S+x)if(D(b)){if(w=b,E=S,y.offset===E&&R(w))break}else w||(w=b,E=S);if(S+=x,S>y.offset)break}return[w,E]},e.prototype.findAttachmentElementParentForNode=function(y){for(;y&&y!==(this||b).element;){if(x(y))return y;y=y.parentNode}},e.prototype.getSignificantNodesForIndex=function(y){var A,x,w,E,R;for(w=[],R=T((this||b).element,{usingFilter:C}),E=!1;R.nextNode();)if(x=R.currentNode,S(x)){if("undefined"!=typeof A&&null!==A?A++:A=0,A===y)E=!0;else if(E)break}else E&&w.push(x);return w},O=function(y){var b;return y.nodeType===Node.TEXT_NODE?R(y)?0:(b=y.textContent,b.length):"br"===L(y)||x(y)?1:0},C=function(y){return P(y)===NodeFilter.FILTER_ACCEPT?N(y):NodeFilter.FILTER_REJECT},P=function(y){return k(y)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},N=function(y){return x(y.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},e}()}.call(this||b),function(){var y,b,A=[].slice;y=C.getDOMRange,b=C.setDOMRange,C.PointMapper=function(){function e(){}return e.prototype.createDOMRangeFromPoint=function(A){var C,x,w,E,S,R,k,D;if(k=A.x,D=A.y,document.caretPositionFromPoint)return S=document.caretPositionFromPoint(k,D),w=S.offsetNode,x=S.offset,C=document.createRange(),C.setStart(w,x),C;if(document.caretRangeFromPoint)return document.caretRangeFromPoint(k,D);if(document.body.createTextRange){E=y();try{R=document.body.createTextRange(),R.moveToPoint(k,D),R.select()}catch(y){}return C=y(),b(E),C}},e.prototype.getClientRectsForDOMRange=function(y){var b,C,x;return C=A.call(y.getClientRects()),x=C[0],b=C[C.length-1],[x,b]},e}()}.call(this||b),function(){var y,n=function(y,b){return function(){return y.apply(b,arguments)}},i=function(y,C){function n(){(this||b).constructor=y}for(var x in C)A.call(C,x)&&(y[x]=C[x]);return n.prototype=C.prototype,y.prototype=new n,y.__super__=C.prototype,y},A={}.hasOwnProperty,x=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};y=C.getDOMRange,C.SelectionChangeObserver=function(A){function o(){(this||b).run=n((this||b).run,this||b),(this||b).update=n((this||b).update,this||b),(this||b).selectionManagers=[]}var C;return i(o,A),o.prototype.start=function(){return(this||b).started?void 0:((this||b).started=!0,"onselectionchange"in document?document.addEventListener("selectionchange",(this||b).update,!0):this.run())},o.prototype.stop=function(){return(this||b).started?((this||b).started=!1,document.removeEventListener("selectionchange",(this||b).update,!0)):void 0},o.prototype.registerSelectionManager=function(y){return x.call((this||b).selectionManagers,y)<0?((this||b).selectionManagers.push(y),this.start()):void 0},o.prototype.unregisterSelectionManager=function(y){var A;return(this||b).selectionManagers=function(){var C,x,w,E;for(w=(this||b).selectionManagers,E=[],C=0,x=w.length;x>C;C++)A=w[C],A!==y&&E.push(A);return E}.call(this||b),0===(this||b).selectionManagers.length?this.stop():void 0},o.prototype.notifySelectionManagersOfSelectionChange=function(){var y,A,C,x,w;for(C=(this||b).selectionManagers,x=[],y=0,A=C.length;A>y;y++)w=C[y],x.push(w.selectionDidChange());return x},o.prototype.update=function(){var A;return A=y(),C(A,(this||b).domRange)?void 0:((this||b).domRange=A,this.notifySelectionManagersOfSelectionChange())},o.prototype.reset=function(){return(this||b).domRange=null,this.update()},o.prototype.run=function(){return(this||b).started?(this.update(),requestAnimationFrame((this||b).run)):void 0},C=function(y,b){return(null!=y?y.startContainer:void 0)===(null!=b?b.startContainer:void 0)&&(null!=y?y.startOffset:void 0)===(null!=b?b.startOffset:void 0)&&(null!=y?y.endContainer:void 0)===(null!=b?b.endContainer:void 0)&&(null!=y?y.endOffset:void 0)===(null!=b?b.endOffset:void 0)},o}(C.BasicObject),null==C.selectionChangeObserver&&(C.selectionChangeObserver=new C.SelectionChangeObserver)}.call(this||b),function(){var y,A,x,w,E,S,R,k,D,L,h=function(y,b){return function(){return y.apply(b,arguments)}},p=function(y,A){function n(){(this||b).constructor=y}for(var C in A)T.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},T={}.hasOwnProperty;x=C.getDOMSelection,A=C.getDOMRange,L=C.setDOMRange,y=C.elementContainsNode,S=C.nodeIsCursorTarget,E=C.innerElementIsActive,w=C.handleEvent,R=C.normalizeRange,k=C.rangeIsCollapsed,D=C.rangesAreEqual,C.SelectionManager=function(T){function f(y){(this||b).element=y,(this||b).selectionDidChange=h((this||b).selectionDidChange,this||b),(this||b).didMouseDown=h((this||b).didMouseDown,this||b),(this||b).locationMapper=new C.LocationMapper((this||b).element),(this||b).pointMapper=new C.PointMapper,(this||b).lockCount=0,w("mousedown",{onElement:(this||b).element,withCallback:(this||b).didMouseDown})}return p(f,T),f.prototype.getLocationRange=function(y){var C;return null==y&&(y={}),!1===y.strict?this.createLocationRangeFromDOMRange(A(),{strict:!1}):y.ignoreLock?(this||b).currentLocationRange:null!=(C=(this||b).lockedLocationRange)?C:(this||b).currentLocationRange},f.prototype.setLocationRange=function(y){var A;if(!(this||b).lockedLocationRange)return y=R(y),(A=this.createDOMRangeFromLocationRange(y))?(L(A),this.updateCurrentLocationRange(y)):void 0},f.prototype.setLocationRangeFromPointRange=function(y){var b,A;return y=R(y),A=this.getLocationAtPoint(y[0]),b=this.getLocationAtPoint(y[1]),this.setLocationRange([A,b])},f.prototype.getClientRectAtLocationRange=function(y){var b;return(b=this.createDOMRangeFromLocationRange(y))?this.getClientRectsForDOMRange(b)[1]:void 0},f.prototype.locationIsCursorTarget=function(y){var b,A;return A=this.findNodeAndOffsetFromLocation(y),b=A[0],A[1],S(b)},f.prototype.lock=function(){return 0===(this||b).lockCount++?(this.updateCurrentLocationRange(),(this||b).lockedLocationRange=this.getLocationRange()):void 0},f.prototype.unlock=function(){var y;return 0===--(this||b).lockCount&&(y=(this||b).lockedLocationRange,(this||b).lockedLocationRange=null,null!=y)?this.setLocationRange(y):void 0},f.prototype.clearSelection=function(){var y;return null!=(y=x())?y.removeAllRanges():void 0},f.prototype.selectionIsCollapsed=function(){var y;return!0===(null!=(y=A())?y.collapsed:void 0)},f.prototype.selectionIsExpanded=function(){return!this.selectionIsCollapsed()},f.prototype.createLocationRangeFromDOMRange=function(y,b){var A,C;if(null!=y&&this.domRangeWithinElement(y)&&(C=this.findLocationFromContainerAndOffset(y.startContainer,y.startOffset,b)))return y.collapsed||(A=this.findLocationFromContainerAndOffset(y.endContainer,y.endOffset,b)),R([C,A])},f.proxyMethod("locationMapper.findLocationFromContainerAndOffset"),f.proxyMethod("locationMapper.findContainerAndOffsetFromLocation"),f.proxyMethod("locationMapper.findNodeAndOffsetFromLocation"),f.proxyMethod("pointMapper.createDOMRangeFromPoint"),f.proxyMethod("pointMapper.getClientRectsForDOMRange"),f.prototype.didMouseDown=function(){return this.pauseTemporarily()},f.prototype.pauseTemporarily=function(){var A,C,x,E;return(this||b).paused=!0,C=function(b){return function(){var A,C,w;for(b.paused=!1,clearTimeout(E),C=0,w=x.length;w>C;C++)A=x[C],A.destroy();return y(document,b.element)?b.selectionDidChange():void 0}}(this||b),E=setTimeout(C,200),x=function(){var y,b,x,E;for(x=["mousemove","keydown"],E=[],y=0,b=x.length;b>y;y++)A=x[y],E.push(w(A,{onElement:document,withCallback:C}));return E}()},f.prototype.selectionDidChange=function(){return(this||b).paused||E((this||b).element)?void 0:this.updateCurrentLocationRange()},f.prototype.updateCurrentLocationRange=function(y){var C;return(null!=y?y:y=this.createLocationRangeFromDOMRange(A()))&&!D(y,(this||b).currentLocationRange)?((this||b).currentLocationRange=y,null!=(C=(this||b).delegate)&&"function"==typeof C.locationRangeDidChange?C.locationRangeDidChange((this||b).currentLocationRange.slice(0)):void 0):void 0},f.prototype.createDOMRangeFromLocationRange=function(y){var b,A,C,x;return C=this.findContainerAndOffsetFromLocation(y[0]),A=k(y)?C:null!=(x=this.findContainerAndOffsetFromLocation(y[1]))?x:C,null!=C&&null!=A?(b=document.createRange(),b.setStart.apply(b,C),b.setEnd.apply(b,A),b):void 0},f.prototype.getLocationAtPoint=function(y){var b,A;return(b=this.createDOMRangeFromPoint(y))&&null!=(A=this.createLocationRangeFromDOMRange(b))?A[0]:void 0},f.prototype.domRangeWithinElement=function(A){return A.collapsed?y((this||b).element,A.startContainer):y((this||b).element,A.startContainer)&&y((this||b).element,A.endContainer)},f}(C.BasicObject)}.call(this||b),function(){var y,A,x,w,r=function(y,A){function n(){(this||b).constructor=y}for(var C in A)E.call(A,C)&&(y[C]=A[C]);return n.prototype=A.prototype,y.prototype=new n,y.__super__=A.prototype,y},E={}.hasOwnProperty,S=[].slice;x=C.rangeIsCollapsed,w=C.rangesAreEqual,A=C.objectsAreEqual,y=C.getBlockConfig,C.EditorController=function(E){function u(y){var A,x;(this||b).editorElement=y.editorElement,A=y.document,x=y.html,(this||b).selectionManager=new C.SelectionManager((this||b).editorElement),(this||b).selectionManager.delegate=this||b,(this||b).composition=new C.Composition,(this||b).composition.delegate=this||b,(this||b).attachmentManager=new C.AttachmentManager((this||b).composition.getAttachments()),(this||b).attachmentManager.delegate=this||b,(this||b).inputController=new(C["Level"+C.config.input.getLevel()+"InputController"])((this||b).editorElement),(this||b).inputController.delegate=this||b,(this||b).inputController.responder=(this||b).composition,(this||b).compositionController=new C.CompositionController((this||b).editorElement,(this||b).composition),(this||b).compositionController.delegate=this||b,(this||b).toolbarController=new C.ToolbarController((this||b).editorElement.toolbarElement),(this||b).toolbarController.delegate=this||b,(this||b).editor=new C.Editor((this||b).composition,(this||b).selectionManager,(this||b).editorElement),null!=A?(this||b).editor.loadDocument(A):(this||b).editor.loadHTML(x)}var R;return r(u,E),u.prototype.registerSelectionManager=function(){return C.selectionChangeObserver.registerSelectionManager((this||b).selectionManager)},u.prototype.unregisterSelectionManager=function(){return C.selectionChangeObserver.unregisterSelectionManager((this||b).selectionManager)},u.prototype.render=function(){return(this||b).compositionController.render()},u.prototype.reparse=function(){return(this||b).composition.replaceHTML((this||b).editorElement.innerHTML)},u.prototype.compositionDidChangeDocument=function(){return this.notifyEditorElement("document-change"),(this||b).handlingInput?void 0:this.render()},u.prototype.compositionDidChangeCurrentAttributes=function(y){return(this||b).currentAttributes=y,(this||b).toolbarController.updateAttributes((this||b).currentAttributes),this.updateCurrentActions(),this.notifyEditorElement("attributes-change",{attributes:(this||b).currentAttributes})},u.prototype.compositionDidPerformInsertionAtRange=function(y){return(this||b).pasting?(this||b).pastedRange=y:void 0},u.prototype.compositionShouldAcceptFile=function(y){return this.notifyEditorElement("file-accept",{file:y})},u.prototype.compositionDidAddAttachment=function(y){var A;return A=(this||b).attachmentManager.manageAttachment(y),this.notifyEditorElement("attachment-add",{attachment:A})},u.prototype.compositionDidEditAttachment=function(y){var A;return(this||b).compositionController.rerenderViewForObject(y),A=(this||b).attachmentManager.manageAttachment(y),this.notifyEditorElement("attachment-edit",{attachment:A}),this.notifyEditorElement("change")},u.prototype.compositionDidChangeAttachmentPreviewURL=function(y){return(this||b).compositionController.invalidateViewForObject(y),this.notifyEditorElement("change")},u.prototype.compositionDidRemoveAttachment=function(y){var A;return A=(this||b).attachmentManager.unmanageAttachment(y),this.notifyEditorElement("attachment-remove",{attachment:A})},u.prototype.compositionDidStartEditingAttachment=function(y,A){return(this||b).attachmentLocationRange=(this||b).composition.document.getLocationRangeOfAttachment(y),(this||b).compositionController.installAttachmentEditorForAttachment(y,A),(this||b).selectionManager.setLocationRange((this||b).attachmentLocationRange)},u.prototype.compositionDidStopEditingAttachment=function(){return(this||b).compositionController.uninstallAttachmentEditor(),(this||b).attachmentLocationRange=null},u.prototype.compositionDidRequestChangingSelectionToLocationRange=function(y){return!(this||b).loadingSnapshot||this.isFocused()?((this||b).requestedLocationRange=y,(this||b).compositionRevisionWhenLocationRangeRequested=(this||b).composition.revision,(this||b).handlingInput?void 0:this.render()):void 0},u.prototype.compositionWillLoadSnapshot=function(){return(this||b).loadingSnapshot=!0},u.prototype.compositionDidLoadSnapshot=function(){return(this||b).compositionController.refreshViewCache(),this.render(),(this||b).loadingSnapshot=!1},u.prototype.getSelectionManager=function(){return(this||b).selectionManager},u.proxyMethod("getSelectionManager().setLocationRange"),u.proxyMethod("getSelectionManager().getLocationRange"),u.prototype.attachmentManagerDidRequestRemovalOfAttachment=function(y){return this.removeAttachment(y)},u.prototype.compositionControllerWillSyncDocumentView=function(){return(this||b).inputController.editorWillSyncDocumentView(),(this||b).selectionManager.lock(),(this||b).selectionManager.clearSelection()},u.prototype.compositionControllerDidSyncDocumentView=function(){return(this||b).inputController.editorDidSyncDocumentView(),(this||b).selectionManager.unlock(),this.updateCurrentActions(),this.notifyEditorElement("sync")},u.prototype.compositionControllerDidRender=function(){return null!=(this||b).requestedLocationRange&&((this||b).compositionRevisionWhenLocationRangeRequested===(this||b).composition.revision&&(this||b).selectionManager.setLocationRange((this||b).requestedLocationRange),(this||b).requestedLocationRange=null,(this||b).compositionRevisionWhenLocationRangeRequested=null),(this||b).renderedCompositionRevision!==(this||b).composition.revision&&(this.runEditorFilters(),(this||b).composition.updateCurrentAttributes(),this.notifyEditorElement("render")),(this||b).renderedCompositionRevision=(this||b).composition.revision},u.prototype.compositionControllerDidFocus=function(){return this.isFocusedInvisibly()&&this.setLocationRange({index:0,offset:0}),(this||b).toolbarController.hideDialog(),this.notifyEditorElement("focus")},u.prototype.compositionControllerDidBlur=function(){return this.notifyEditorElement("blur")},u.prototype.compositionControllerDidSelectAttachment=function(y,A){return(this||b).toolbarController.hideDialog(),(this||b).composition.editAttachment(y,A)},u.prototype.compositionControllerDidRequestDeselectingAttachment=function(y){var A,C;return A=null!=(C=(this||b).attachmentLocationRange)?C:(this||b).composition.document.getLocationRangeOfAttachment(y),(this||b).selectionManager.setLocationRange(A[1])},u.prototype.compositionControllerWillUpdateAttachment=function(y){return(this||b).editor.recordUndoEntry("Edit Attachment",{context:y.id,consolidatable:!0})},u.prototype.compositionControllerDidRequestRemovalOfAttachment=function(y){return this.removeAttachment(y)},u.prototype.inputControllerWillHandleInput=function(){return(this||b).handlingInput=!0,(this||b).requestedRender=!1},u.prototype.inputControllerDidRequestRender=function(){return(this||b).requestedRender=!0},u.prototype.inputControllerDidHandleInput=function(){return(this||b).handlingInput=!1,(this||b).requestedRender?((this||b).requestedRender=!1,this.render()):void 0},u.prototype.inputControllerDidAllowUnhandledInput=function(){return this.notifyEditorElement("change")},u.prototype.inputControllerDidRequestReparse=function(){return this.reparse()},u.prototype.inputControllerWillPerformTyping=function(){return this.recordTypingUndoEntry()},u.prototype.inputControllerWillPerformFormatting=function(y){return this.recordFormattingUndoEntry(y)},u.prototype.inputControllerWillCutText=function(){return(this||b).editor.recordUndoEntry("Cut")},u.prototype.inputControllerWillPaste=function(y){return(this||b).editor.recordUndoEntry("Paste"),(this||b).pasting=!0,this.notifyEditorElement("before-paste",{paste:y})},u.prototype.inputControllerDidPaste=function(y){return y.range=(this||b).pastedRange,(this||b).pastedRange=null,(this||b).pasting=null,this.notifyEditorElement("paste",{paste:y})},u.prototype.inputControllerWillMoveText=function(){return(this||b).editor.recordUndoEntry("Move")},u.prototype.inputControllerWillAttachFiles=function(){return(this||b).editor.recordUndoEntry("Drop Files")},u.prototype.inputControllerWillPerformUndo=function(){return(this||b).editor.undo()},u.prototype.inputControllerWillPerformRedo=function(){return(this||b).editor.redo()},u.prototype.inputControllerDidReceiveKeyboardCommand=function(y){return(this||b).toolbarController.applyKeyboardCommand(y)},u.prototype.inputControllerDidStartDrag=function(){return(this||b).locationRangeBeforeDrag=(this||b).selectionManager.getLocationRange()},u.prototype.inputControllerDidReceiveDragOverPoint=function(y){return(this||b).selectionManager.setLocationRangeFromPointRange(y)},u.prototype.inputControllerDidCancelDrag=function(){return(this||b).selectionManager.setLocationRange((this||b).locationRangeBeforeDrag),(this||b).locationRangeBeforeDrag=null},u.prototype.locationRangeDidChange=function(y){return(this||b).composition.updateCurrentAttributes(),this.updateCurrentActions(),(this||b).attachmentLocationRange&&!w((this||b).attachmentLocationRange,y)&&(this||b).composition.stopEditingAttachment(),this.notifyEditorElement("selection-change")},u.prototype.toolbarDidClickButton=function(){return this.getLocationRange()?void 0:this.setLocationRange({index:0,offset:0})},u.prototype.toolbarDidInvokeAction=function(y){return this.invokeAction(y)},u.prototype.toolbarDidToggleAttribute=function(y){return this.recordFormattingUndoEntry(y),(this||b).composition.toggleCurrentAttribute(y),this.render(),(this||b).selectionFrozen?void 0:(this||b).editorElement.focus()},u.prototype.toolbarDidUpdateAttribute=function(y,A){return this.recordFormattingUndoEntry(y),(this||b).composition.setCurrentAttribute(y,A),this.render(),(this||b).selectionFrozen?void 0:(this||b).editorElement.focus()},u.prototype.toolbarDidRemoveAttribute=function(y){return this.recordFormattingUndoEntry(y),(this||b).composition.removeCurrentAttribute(y),this.render(),(this||b).selectionFrozen?void 0:(this||b).editorElement.focus()},u.prototype.toolbarWillShowDialog=function(){return(this||b).composition.expandSelectionForEditing(),this.freezeSelection()},u.prototype.toolbarDidShowDialog=function(y){return this.notifyEditorElement("toolbar-dialog-show",{dialogName:y})},u.prototype.toolbarDidHideDialog=function(y){return this.thawSelection(),(this||b).editorElement.focus(),this.notifyEditorElement("toolbar-dialog-hide",{dialogName:y})},u.prototype.freezeSelection=function(){return(this||b).selectionFrozen?void 0:((this||b).selectionManager.lock(),(this||b).composition.freezeSelection(),(this||b).selectionFrozen=!0,this.render())},u.prototype.thawSelection=function(){return(this||b).selectionFrozen?((this||b).composition.thawSelection(),(this||b).selectionManager.unlock(),(this||b).selectionFrozen=!1,this.render()):void 0},u.prototype.actions={undo:{test:function(){return(this||b).editor.canUndo()},perform:function(){return(this||b).editor.undo()}},redo:{test:function(){return(this||b).editor.canRedo()},perform:function(){return(this||b).editor.redo()}},link:{test:function(){return(this||b).editor.canActivateAttribute("href")}},increaseNestingLevel:{test:function(){return(this||b).editor.canIncreaseNestingLevel()},perform:function(){return(this||b).editor.increaseNestingLevel()&&this.render()}},decreaseNestingLevel:{test:function(){return(this||b).editor.canDecreaseNestingLevel()},perform:function(){return(this||b).editor.decreaseNestingLevel()&&this.render()}},attachFiles:{test:function(){return!0},perform:function(){return C.config.input.pickFiles((this||b).editor.insertFiles)}}},u.prototype.canInvokeAction=function(y){var A,C;return!!this.actionIsExternal(y)||!!(null!=(A=(this||b).actions[y])&&null!=(C=A.test)?C.call(this||b):void 0)},u.prototype.invokeAction=function(y){var A,C;return this.actionIsExternal(y)?this.notifyEditorElement("action-invoke",{actionName:y}):null!=(A=(this||b).actions[y])&&null!=(C=A.perform)?C.call(this||b):void 0},u.prototype.actionIsExternal=function(y){return/^x-./.test(y)},u.prototype.getCurrentActions=function(){var y,A;A={};for(y in(this||b).actions)A[y]=this.canInvokeAction(y);return A},u.prototype.updateCurrentActions=function(){var y;return y=this.getCurrentActions(),A(y,(this||b).currentActions)?void 0:((this||b).currentActions=y,(this||b).toolbarController.updateActions((this||b).currentActions),this.notifyEditorElement("actions-change",{actions:(this||b).currentActions}))},u.prototype.runEditorFilters=function(){var y,A,C,x,w,E,S,k;for(k=(this||b).composition.getSnapshot(),w=(this||b).editor.filters,C=0,x=w.length;x>C;C++)A=w[C],y=k.document,S=k.selectedRange,k=null!=(E=A.call((this||b).editor,k))?E:{},null==k.document&&(k.document=y),null==k.selectedRange&&(k.selectedRange=S);return R(k,(this||b).composition.getSnapshot())?void 0:(this||b).composition.loadSnapshot(k)},R=function(y,b){return w(y.selectedRange,b.selectedRange)&&y.document.isEqualTo(b.document)},u.prototype.updateInputElement=function(){var y,A;return y=(this||b).compositionController.getSerializableElement(),A=C.serializeToContentType(y,"text/html"),(this||b).editorElement.setInputElementValue(A)},u.prototype.notifyEditorElement=function(y,A){switch(y){case"document-change":(this||b).documentChangedSinceLastRender=!0;break;case"render":(this||b).documentChangedSinceLastRender&&((this||b).documentChangedSinceLastRender=!1,this.notifyEditorElement("change"));break;case"change":case"attachment-add":case"attachment-edit":case"attachment-remove":this.updateInputElement()}return(this||b).editorElement.notify(y,A)},u.prototype.removeAttachment=function(y){return(this||b).editor.recordUndoEntry("Delete Attachment"),(this||b).composition.removeAttachment(y),this.render()},u.prototype.recordFormattingUndoEntry=function(A){var C,w;return C=y(A),w=(this||b).selectionManager.getLocationRange(),C||!x(w)?(this||b).editor.recordUndoEntry("Formatting",{context:this.getUndoContext(),consolidatable:!0}):void 0},u.prototype.recordTypingUndoEntry=function(){return(this||b).editor.recordUndoEntry("Typing",{context:this.getUndoContext((this||b).currentAttributes),consolidatable:!0})},u.prototype.getUndoContext=function(){var y;return y=1<=arguments.length?S.call(arguments,0):[],[this.getLocationContext(),this.getTimeContext()].concat(S.call(y))},u.prototype.getLocationContext=function(){var y;return y=(this||b).selectionManager.getLocationRange(),x(y)?y[0].index:y},u.prototype.getTimeContext=function(){return C.config.undoInterval>0?Math.floor((new Date).getTime()/C.config.undoInterval):0},u.prototype.isFocused=function(){var y;return(this||b).editorElement===(null!=(y=(this||b).editorElement.ownerDocument)?y.activeElement:void 0)},u.prototype.isFocusedInvisibly=function(){return this.isFocused()&&!this.getLocationRange()},u}(C.Controller)}.call(this||b),function(){var y,A,x,w,E,S,R,k=[].indexOf||function(y){for(var A=0,C=(this||b).length;C>A;A++)if(A in(this||b)&&(this||b)[A]===y)return A;return-1};A=C.browser,S=C.makeElement,R=C.triggerEvent,w=C.handleEvent,E=C.handleEventOnce,x=C.findClosestElementFromNode,y=C.AttachmentView.attachmentSelector,C.registerElement("trix-editor",function(){var D,L,T,O,N,P,I,_,B;return I=0,L=function(y){return!document.querySelector(":focus")&&y.hasAttribute("autofocus")&&document.querySelector("[autofocus]")===y?y.focus():void 0},_=function(y){return y.hasAttribute("contenteditable")?void 0:(y.setAttribute("contenteditable",""),E("focus",{onElement:y,withCallback:function(){return T(y)}}))},T=function(y){return N(y),B(y)},N=function(y){return("function"==typeof document.queryCommandSupported?document.queryCommandSupported("enableObjectResizing"):void 0)?(document.execCommand("enableObjectResizing",!1,!1),w("mscontrolselect",{onElement:y,preventDefault:!0})):void 0},B=function(){var y;return("function"==typeof document.queryCommandSupported?document.queryCommandSupported("DefaultParagraphSeparator"):void 0)&&(y=C.config.blockAttributes.default.tagName,"div"===y||"p"===y)?document.execCommand("DefaultParagraphSeparator",!1,y):void 0},D=function(y){return y.hasAttribute("role")?void 0:y.setAttribute("role","textbox")},P=function(y){var b;if(!y.hasAttribute("aria-label")&&!y.hasAttribute("aria-labelledby"))return(b=function(){var b,A,C;return C=function(){var A,C,x,w;for(x=y.labels,w=[],A=0,C=x.length;C>A;A++)b=x[A],b.contains(y)||w.push(b.textContent);return w}(),(A=C.join(" "))?y.setAttribute("aria-label",A):y.removeAttribute("aria-label")})(),w("focus",{onElement:y,withCallback:b})},O=function(){return A.forcesObjectResizing?{display:"inline",width:"auto"}:{display:"inline-block",width:"1px"}}(),{defaultCSS:"%t {\n  display: block;\n}\n\n%t:empty:not(:focus)::before {\n  content: attr(placeholder);\n  color: graytext;\n  cursor: text;\n  pointer-events: none;\n}\n\n%t a[contenteditable=false] {\n  cursor: text;\n}\n\n%t img {\n  max-width: 100%;\n  height: auto;\n}\n\n%t "+y+" figcaption textarea {\n  resize: none;\n}\n\n%t "+y+" figcaption textarea.trix-autoresize-clone {\n  position: absolute;\n  left: -9999px;\n  max-height: 0px;\n}\n\n%t "+y+" figcaption[data-trix-placeholder]:empty::before {\n  content: attr(data-trix-placeholder);\n  color: graytext;\n}\n\n%t [data-trix-cursor-target] {\n  display: "+O.display+" !important;\n  width: "+O.width+" !important;\n  padding: 0 !important;\n  margin: 0 !important;\n  border: none !important;\n}\n\n%t [data-trix-cursor-target=left] {\n  vertical-align: top !important;\n  margin-left: -1px !important;\n}\n\n%t [data-trix-cursor-target=right] {\n  vertical-align: bottom !important;\n  margin-right: -1px !important;\n}",trixId:{get:function(){return this.hasAttribute("trix-id")?this.getAttribute("trix-id"):(this.setAttribute("trix-id",++I),(this||b).trixId)}},labels:{get:function(){var y,A,C;return A=[],(this||b).id&&(this||b).ownerDocument&&A.push.apply(A,(this||b).ownerDocument.querySelectorAll("label[for='"+(this||b).id+"']")),(y=x(this||b,{matchingSelector:"label"}))&&((C=y.control)===(this||b)||null===C)&&A.push(y),A}},toolbarElement:{get:function(){var y,A,C;return this.hasAttribute("toolbar")?null!=(A=(this||b).ownerDocument)?A.getElementById(this.getAttribute("toolbar")):void 0:(this||b).parentNode?(C="trix-toolbar-"+(this||b).trixId,this.setAttribute("toolbar",C),y=S("trix-toolbar",{id:C}),(this||b).parentNode.insertBefore(y,this||b),y):void 0}},inputElement:{get:function(){var y,A,C;return this.hasAttribute("input")?null!=(C=(this||b).ownerDocument)?C.getElementById(this.getAttribute("input")):void 0:(this||b).parentNode?(A="trix-input-"+(this||b).trixId,this.setAttribute("input",A),y=S("input",{type:"hidden",id:A}),(this||b).parentNode.insertBefore(y,(this||b).nextElementSibling),y):void 0}},editor:{get:function(){var y;return null!=(y=(this||b).editorController)?y.editor:void 0}},name:{get:function(){var y;return null!=(y=(this||b).inputElement)?y.name:void 0}},value:{get:function(){var y;return null!=(y=(this||b).inputElement)?y.value:void 0},set:function(y){var A;return(this||b).defaultValue=y,null!=(A=(this||b).editor)?A.loadHTML((this||b).defaultValue):void 0}},notify:function(y,A){return(this||b).editorController?R("trix-"+y,{onElement:this||b,attributes:A}):void 0},setInputElementValue:function(y){var A;return null!=(A=(this||b).inputElement)?A.value=y:void 0},initialize:function(){return this.hasAttribute("data-trix-internal")?void 0:(_(this||b),D(this||b),P(this||b))},connect:function(){return this.hasAttribute("data-trix-internal")?void 0:((this||b).editorController||(R("trix-before-initialize",{onElement:this||b}),(this||b).editorController=new C.EditorController({editorElement:this||b,html:(this||b).defaultValue=(this||b).value}),requestAnimationFrame(function(y){return function(){return R("trix-initialize",{onElement:y})}}(this||b))),(this||b).editorController.registerSelectionManager(),this.registerResetListener(),this.registerClickListener(),L(this||b))},disconnect:function(){var y;return null!=(y=(this||b).editorController)&&y.unregisterSelectionManager(),this.unregisterResetListener(),this.unregisterClickListener()},registerResetListener:function(){return(this||b).resetListener=(this||b).resetBubbled.bind(this||b),window.addEventListener("reset",(this||b).resetListener,!1)},unregisterResetListener:function(){return window.removeEventListener("reset",(this||b).resetListener,!1)},registerClickListener:function(){return(this||b).clickListener=(this||b).clickBubbled.bind(this||b),window.addEventListener("click",(this||b).clickListener,!1)},unregisterClickListener:function(){return window.removeEventListener("click",(this||b).clickListener,!1)},resetBubbled:function(y){var A;if(!y.defaultPrevented&&y.target===(null!=(A=(this||b).inputElement)?A.form:void 0))return this.reset()},clickBubbled:function(y){var A;if(!(y.defaultPrevented||this.contains(y.target)||!(A=x(y.target,{matchingSelector:"label"}))||k.call((this||b).labels,A)<0))return this.focus()},reset:function(){return(this||b).value=(this||b).defaultValue}}}())}.call(this||b),function(){}.call(this||b)}).call(this||b),!!A&&(A=C)}.call(A);var x=A;export default x;

